//@ui5-bundle sap/ui/fl/library-preload.js
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Cache",["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/base/Log"],function(e,n,t){"use strict";var r=function(){};function a(n,t){var r=e.getFlexObjectsFromStorageResponse(n);if(t.fileType==="variant"){return r.comp.variants}if(t.selector&&t.selector.persistencyKey){return r.comp.changes}return r.changes}function i(e,n){if(!n){return e}return e===r.NOTAG?e.replace(/>$/,"".concat("-",n,">")):e.concat("-",n)}function c(e){return e.replace(/(^W\/|")/g,"")}r.NOTAG="<NoTag>";r.clearEntries=function(){e.clearState()};r.getChangesFillingCache=function(n,t,r){var a=Promise.resolve();if(r){a=e.clearAndInitialize(t)}return a.then(function(){return e.getStorageResponse(n.name)}).catch(function(){return{}})};r.getCacheKey=function(e,a){if(!e||!e.name||!a){t.warning("Not all parameters were passed to determine a flexibility cache key.");return Promise.resolve(r.NOTAG)}return this.getChangesFillingCache(e).then(function(e){if(e&&e.cacheKey){return c(e.cacheKey)}return r.NOTAG}).then(function(e){var t=a.getModel(n.getVariantModelName());var r=t?t.getCurrentControlVariantIds():[];return i(e,r.join("-"))})};r.addChange=function(e,n){var t=a(e.name,n);if(!t){return}t.push(n)};r.updateChange=function(e,n){var t=a(e.name,n);if(!t){return}for(var r=0;r<t.length;r++){if(t[r].fileName===n.fileName){t.splice(r,1,n);break}}};r.deleteChange=function(e,n){var t=a(e.name,n);if(!t){return}for(var r=0;r<t.length;r++){if(t[r].fileName===n.fileName){t.splice(r,1);break}}};r.removeChanges=function(n,t){var r=e.getFlexObjectsFromStorageResponse(n.name);if(!r){return}r.changes=r.changes.filter(function(e){return t.indexOf(e.fileName)===-1});var a=e.getVariantsState(n.name);Object.keys(a).forEach(function(e){a[e].variants.forEach(function(e){e.controlChanges=e.controlChanges.filter(function(e){return t.indexOf(e.getId())===-1})})})};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/ChangePersistence",["sap/base/util/restricted/_union","sap/base/util/includes","sap/base/util/merge","sap/base/util/UriParameters","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Component","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/registry/Settings","sap/ui/fl/write/_internal/condenser/Condenser","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/api/Version","sap/ui/fl/Cache","sap/ui/fl/LayerUtils","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/model/json/JSONModel","sap/ui/performance/Measurement"],function(e,t,n,a,r,i,s,o,h,c,l,g,p,f,u,d,C,m,y,_,v,S,D,b,I,L){"use strict";var E=function(e){this._mComponent=e;this._mChanges=p.createEmptyDependencyMap();this._bChangesMapCreated=false;this._mChangesInitial=n({},this._mChanges);if(!this._mComponent||!this._mComponent.name){r.error("The Control does not belong to an SAPUI5 component. Personalization and changes for this control might not work as expected.");throw new Error("Missing component name.")}this._aDirtyChanges=[];this._oMessagebundle=undefined;this._mChangesEntries={};this._bHasChangesOverMaxLayer=false;this.HIGHER_LAYER_CHANGES_EXIST="higher_layer_changes_exist"};function M(e,t){var n;if(t instanceof c){n=t;this._mChangesEntries[n.getId()]=n}else{if(!this._mChangesEntries[t.fileName]){this._mChangesEntries[t.fileName]=l.createFromFileContent(t)}n=this._mChangesEntries[t.fileName];n.setState(g.LifecycleState.PERSISTED)}return n}E.prototype.getComponentName=function(){return this._mComponent.name};E.prototype.getCacheKey=function(e){return v.getCacheKey(this._mComponent,e)};function F(e){var t;var n;var a;var r;if(e instanceof c){var i=e;t=i.getFileType();a=i.getVariantReference();r=i.getSelector()&&i.getSelector().id}else{var s=e;t=s.fileType;n=s.variantManagementReference;a=s.variantReference;r=s.selector&&s.selector.id}var o=false;if(t==="ctrl_variant"||t==="ctrl_variant_change"||t==="ctrl_variant_management_change"){o=n||a||r}return t==="change"||o}E.prototype.getChangesForComponent=function(e,t){return b.getUShellService("URLParsing").then(function(n){this._oUShellURLParsingService=n;return v.getChangesFillingCache(this._mComponent,e,t)}.bind(this)).then(function(e,t){var a=n({},t);var r=e&&e.component&&b.getAppComponentForControl(e.component);var i=d.isStorageResponseFilled(a.changes);if(!i){return[]}var s=a.changes.changes;if(!this._oMessagebundle&&a.messagebundle&&r){if(!r.getModel("i18nFlexVendor")){if(s.some(function(e){return e.layer===D.VENDOR})){this._oMessagebundle=a.messagebundle;var o=new I(this._oMessagebundle);r.setModel(o,"i18nFlexVendor")}}}var h=e&&e.currentLayer;var c=!(e&&e.ignoreMaxLayerParameter);var l=function(){return true};if(h){s=S.filterChangeOrChangeDefinitionsByCurrentLayer(s,h)}else if(S.isLayerFilteringRequired(this._oUShellURLParsingService)&&c){l=O.bind(this);s=s.filter(l)}else if(this._bHasChangesOverMaxLayer&&!c){this._bHasChangesOverMaxLayer=false;return this.HIGHER_LAYER_CHANGES_EXIST}var g=a.changes&&e&&e.includeCtrlVariants;var p=this._getAllCtrlVariantChanges(a,g,l);s=s.concat(p);return this._checkAndGetChangeInstances(s,a)}.bind(this,e))};E.prototype._checkAndGetChangeInstances=function(e,t){return e.filter(F).map(M.bind(this,t))};function O(e){if(S.isOverMaxLayer(x(e),this._oUShellURLParsingService)){if(!this._bHasChangesOverMaxLayer){this._bHasChangesOverMaxLayer=true}return false}return true}function x(e){var t;if(typeof e.isA==="function"&&(e.isA("sap.ui.fl.apply._internal.flexObjects.FlVariant")||e.isA("sap.ui.fl.apply._internal.flexObjects.UIChange"))){t=e.getLayer()}else{t=e.layer}return t}E.prototype._getAllCtrlVariantChanges=function(e,t,n){if(!t){return f.getInitialChanges({reference:this._mComponent.name})}return["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"].reduce(function(t,n){if(e.changes[n]){return t.concat(e.changes[n])}return t},[]).filter(n)};E.prototype.loadChangesMapForComponent=function(e){return this.getChangesForComponent({component:e}).then(t.bind(this));function t(t){L.start("fl.createDependencyMap","Measurement of creating initial dependency map");this._mChanges=p.createEmptyDependencyMap();t.forEach(this.addChangeAndUpdateDependencies.bind(this,e));this._mChangesInitial=n({},this._mChanges);L.end("fl.createDependencyMap","Measurement of creating initial dependency map");this._bChangesMapCreated=true;return this.getChangesMapForComponent.bind(this)}};E.prototype.getOpenDependentChangesForControl=function(e,t){return p.getOpenDependentChangesForControl(this._mChanges,i.getControlIdBySelector(e,t),t)};function A(e){var t=n({},this._mChangesInitial.mDependencies);return t[e.getId()]}function U(e,n,a,r){var s;var o=[];e.controlsDependencies.forEach(function(e){if(!i.bySelector(e,a)){s=i.getControlIdBySelector(e,a);o.push(e);this._mChanges.mControlsWithDependencies[s]=this._mChanges.mControlsWithDependencies[s]||[];if(!t(this._mChanges.mControlsWithDependencies[s],r.getId())){this._mChanges.mControlsWithDependencies[s].push(r.getId())}}}.bind(this));e.dependencies=n;e.controlsDependencies=o;if(n.length||o.length){this._mChanges.mDependencies[r.getId()]=e}}E.prototype.copyDependenciesFromInitialChangesMapSync=function(e,t,n){var a=A.call(this,e);if(a){var r=[];a.dependencies.forEach(function(n){if(t(n)){this._mChanges.mDependentChangesOnMe[n]=this._mChanges.mDependentChangesOnMe[n]||[];this._mChanges.mDependentChangesOnMe[n].push(e.getId());r.push(n)}}.bind(this));U.call(this,a,r,n,e)}return this._mChanges};E.prototype.copyDependenciesFromInitialChangesMap=function(e,t,n){var a=A.call(this,e);if(a){var r=[];return a.dependencies.reduce(function(n,a){return n.then(function(){return t(a)}).then(function(t){if(t){this._mChanges.mDependentChangesOnMe[a]=this._mChanges.mDependentChangesOnMe[a]||[];this._mChanges.mDependentChangesOnMe[a].push(e.getId());r.push(a)}}.bind(this))}.bind(this),Promise.resolve()).then(function(){U.call(this,a,r,n,e);return this._mChanges}.bind(this))}return Promise.resolve(this._mChanges)};E.prototype.addChangeAndUpdateDependencies=function(e,t,n){t.setInitialApplyState();if(n){p.insertChange(t,this._mChanges,n)}p.addChangeAndUpdateDependencies(t,e,this._mChanges)};E.prototype._addRunTimeCreatedChangeAndUpdateDependencies=function(e,t){p.addRuntimeChangeAndUpdateDependencies(t,e,this._mChanges,this._mChangesInitial)};E.prototype.getChangesMapForComponent=function(){return this._mChanges};E.prototype.getAllUIChanges=function(t){var n=e(this.getChangesMapForComponent().aChanges,t.includeDirtyChanges&&this.getDirtyChanges()).filter(function(e){return Boolean(e)&&e.getFileType()==="change"&&S.compareAgainstCurrentLayer(e.getLayer(),t.layer)===0});return n};E.prototype.isChangeMapCreated=function(){return this._bChangesMapCreated};E.prototype.getChangesForView=function(e){return this.getChangesForComponent(e).then(function(t){return t.filter(h.filterChangeByView.bind(undefined,e))})};E.prototype.addChange=function(e,t){var n=this.addDirtyChange(e);this._addRunTimeCreatedChangeAndUpdateDependencies(t,n);this._mChangesEntries[n.getId()]=n;this._addPropagationListener(t);return n};E.prototype.addDirtyChange=function(e){var t;if(typeof e.isA==="function"&&e.isA("sap.ui.fl.apply._internal.flexObjects.FlexObject")){t=e}else{t=l.createFromFileContent(e)}if(this._aDirtyChanges.indexOf(t)===-1){this._aDirtyChanges.push(t)}return t};E.prototype._addPropagationListener=function(e){var t=b.getAppComponentForControl(e);if(t instanceof s){var n=function(e){return!e._bIsSapUiFlFlexControllerApplyChangesOnControl};var a=t.getPropagationListeners().every(n);if(a){var r=sap.ui.require("sap/ui/fl/FlexControllerFactory");var i=r.create(this.getComponentName());var h=o.applyAllChangesForControl.bind(o,this.getChangesMapForComponent.bind(this),t,i);h._bIsSapUiFlFlexControllerApplyChangesOnControl=true;t.addPropagationListener(h)}}};E.prototype._deleteNotSavedChanges=function(e,t,n){e.filter(function(e){return!t.some(function(t){return e.getId()===t.getId()})}).forEach(function(e){if(n){this.removeChange(e);v.deleteChange(this._mComponent,e.convertToFileContent())}else{this.deleteChange(e)}}.bind(this))};function R(e,t){var n=e.map(function(e){return e[t]()});var a=n.filter(function(e,t,n){return n.indexOf(e)===t});return a.length===1}function T(e,t,n){var r=false;if(!e||t.length<2||!R(t,"getLayer")){return false}if(n){r=true}else{var i=t[0].getLayer();if([D.CUSTOMER,D.USER].includes(i)){r=true}}var s=a.fromURL(window.location.href);if(s.has("sap-ui-xx-condense-changes")){r=s.get("sap-ui-xx-condense-changes")==="true"}return r}function P(e){var t=C.getInstanceOrUndef()&&C.getInstanceOrUndef().isCondensingEnabled();if(t&&!R(e,"getNamespace")){t=false}return t}function V(e,t,n,a){this._massUpdateCacheAndDirtyState(t,n);this._deleteNotSavedChanges(e,t,a)}function N(e,t,n,a){if(!e.length&&!n){return[]}var r=this._mChanges.aChanges.filter(function(e){if(a===D.CUSTOMER&&t){return e.getState()===g.LifecycleState.PERSISTED&&t.includes(e.getId())}return e.getState()===g.LifecycleState.PERSISTED&&S.compareAgainstCurrentLayer(e.getLayer(),a)===0});return r.concat(e)}function w(e){if(e.length){var t=H(e);var n=q(e);return n.length===1&&t.length===1&&n[0]===g.LifecycleState.NEW}return true}E.prototype.saveDirtyChanges=function(e,t,n,a,r,i,s){var o=n||this._aDirtyChanges;var h=o.length&&o[0].getLayer()||s;var c=N.call(this,o,r,i,h);var l=P(c)&&T(e,c,i);var g=l?c:o;var p=g.slice(0);var f=H(o);if(w(o)){var u=Promise.resolve(p);if(T(e,p,i)){u=m.condense(e,p)}return u.then(function(e){var n=f[0];if(l){return y.condense({allChanges:g,condensedChanges:e,layer:h,transport:n,isLegacyVariant:false,parentVersion:a}).then(function(n){V.call(this,g,e,t,true);return n}.bind(this))}if(e.length){return y.write({layer:h,flexObjects:B(e),transport:n,isLegacyVariant:false,parentVersion:a}).then(function(n){V.call(this,g,e,t);return n}.bind(this))}this._deleteNotSavedChanges(g,e)}.bind(this))}return this.saveSequenceOfDirtyChanges(o,t,a)};E.prototype.saveSequenceOfDirtyChanges=function(e,t,n){var a;if(n){var r=e.filter(function(e){return e.getState()===g.LifecycleState.NEW});a=[].concat(r).shift()}return e.reduce(function(e,r){return e.then(j.bind(undefined,r,a,n)).then(this._updateCacheAndDirtyState.bind(this,r,t))}.bind(this),Promise.resolve())};function j(e,t,n){switch(e.getState()){case g.LifecycleState.NEW:if(n!==undefined){n=e===t?n:_.Number.Draft}return y.write({layer:e.getLayer(),flexObjects:[e.convertToFileContent()],transport:e.getRequest(),parentVersion:n});case g.LifecycleState.DELETED:return y.remove({flexObject:e.convertToFileContent(),layer:e.getLayer(),transport:e.getRequest(),parentVersion:n});default:}}E.prototype._updateCacheAndDirtyState=function(e,t){this._aDirtyChanges=this._aDirtyChanges.filter(function(t){return e.getId()!==t.getId()});if(!t){if(b.isChangeRelatedToVariants(e)){f.updateVariantsState({reference:this._mComponent.name,changeToBeAddedOrDeleted:e})}else{switch(e.getState()){case g.LifecycleState.NEW:e.setState(g.LifecycleState.PERSISTED);v.addChange(this._mComponent,e.convertToFileContent());break;case g.LifecycleState.DELETED:v.deleteChange(this._mComponent,e.convertToFileContent());break;case g.LifecycleState.DIRTY:e.setState(g.LifecycleState.PERSISTED);v.updateChange(this._mComponent,e.convertToFileContent());break}}}};E.prototype._massUpdateCacheAndDirtyState=function(e,t){e.forEach(function(e){this._updateCacheAndDirtyState(e,t)},this)};function H(e){var t=[];e.forEach(function(e){var n=e.getRequest();if(t.indexOf(n)===-1){t.push(n)}});return t}function q(e){var t=[];e.forEach(function(e){var n=e.getState();if(t.indexOf(n)===-1){t.push(n)}});return t}function B(e){var t=[];e.forEach(function(e){t.push(e.convertToFileContent())});return t}E.prototype.getDirtyChanges=function(){return this._aDirtyChanges};E.prototype.deleteChange=function(e,t){var n=this._aDirtyChanges.indexOf(e);if(n>-1){if(e.getState()===g.LifecycleState.DELETED){return}this._aDirtyChanges.splice(n,1);this._deleteChangeInMap(e,t);return}e.markForDeletion();this.addDirtyChange(e);this._deleteChangeInMap(e,t)};E.prototype.removeChange=function(e){var t=this._aDirtyChanges.indexOf(e);if(t>-1){this._aDirtyChanges.splice(t,1)}this._deleteChangeInMap(e)};E.prototype._deleteChangeInMap=function(e,t){var n=e.getId();p.removeChangeFromMap(this._mChanges,n);p.removeChangeFromDependencies(t?this._mChangesInitial:this._mChanges,n)};function W(e,t){return(t.getRequest()==="$TMP"||t.getRequest()==="")&&t.getLayer()===e}function k(e,t){return t.getState()===g.LifecycleState.PERSISTED&&t.getLayer()===e}function G(){var e=[];var t=u.getCompVariantsMap(this.getComponentName());for(var n in t){for(var a in t[n].byId){e.push(t[n].byId[a])}}return e}E.prototype.transportAllUIChanges=function(e,t,n,a){return this.getChangesForComponent({currentLayer:n,includeCtrlVariants:true}).then(function(r){var i=G.call(this);r=r.concat(i.filter(W.bind(this,n)));return y.publish({transportDialogSettings:{rootControl:e,styleClass:t},layer:n,reference:this.getComponentName(),localChanges:r,appVariantDescriptors:a})}.bind(this))};E.prototype._getChangesFromMapByNames=function(e){return this._mChanges.aChanges.filter(function(t){return e.indexOf(t.getId())!==-1})};E.prototype.removeDirtyChanges=function(e,t,n,a,r){var s=[].concat(e||[]);var o=this._aDirtyChanges;var h=o.filter(function(e){var o=true;if(s.length&&!s.includes(e.getLayer())){return false}if(a&&e.getSupportInformation().generator!==a){return false}if(n){var h=e.getSelector();o=n.getId()===i.getControlIdBySelector(h,t)}if(r){o=o&&r.indexOf(e.getChangeType())!==-1}return o});h.forEach(function(e){var t=o.indexOf(e);o.splice(t,1)});return Promise.resolve(h)};E.prototype.resetChanges=function(e,t,n,a){var r=n&&n.length>0;var i=a&&a.length>0;var s=C.getInstanceOrUndef()&&C.getInstanceOrUndef().isPublicLayerAvailable();var o=t===undefined&&n===undefined&&a===undefined;var h=[];if(s&&o){h=G.call(this).filter(k.bind(this,e))}return this.getChangesForComponent({currentLayer:e,includeCtrlVariants:true}).then(function(s){s=s.concat(h);var o={reference:this.getComponentName(),layer:e,changes:s};if(t){o.generator=t}if(r){o.selectorIds=n}if(i){o.changeTypes=a}return y.reset(o)}.bind(this)).then(function(e){var t=[];if(n||a){var r=[];if(e&&e.response&&e.response.length>0){e.response.forEach(function(e){r.push(e.fileName)})}v.removeChanges(this._mComponent,r);t=this._getChangesFromMapByNames(r)}return t}.bind(this))};return E});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/ChangePersistenceFactory",["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/ChangePersistence","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/changes/descriptor/Applier"],function(e,n,t,a,i,o,r){"use strict";var s={};s._instanceCache={};s.getChangePersistenceForComponent=function(e){var n=s._instanceCache[e];if(!n){var t={name:e};n=new a(t);s._instanceCache[e]=n}return n};s.getChangePersistenceForControl=function(e){var n;n=t.getFlexReferenceForControl(e);return s.getChangePersistenceForComponent(n)};s.registerLoadComponentEventHandler=function(){e._fnLoadComponentCallback=this._onLoadComponent.bind(this)};s._onLoadComponent=function(e,t){if(!i.isApplication(t)||!e.id){return Promise.resolve()}n.initialize({componentData:e.componentData||e.settings&&e.settings.componentData,asyncHints:e.asyncHints,manifest:t,componentId:e.id});return r.applyChangesIncludedInManifest(t,o.getRuntimeStrategy())};return s},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FlexController",["sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Versions","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/util/reflection/XmlTreeModifier","sap/ui/core/Component","sap/base/Log"],function(e,n,t,r,o,i,a,s,p,h,c,l,u,g,f){"use strict";function C(e,n,t){return Promise.resolve().then(function(){if(t.length!==0){t.reverse();return a.revertMultipleChanges(t,{appComponent:e,modifier:l,flexController:this})}}.bind(this)).then(function(){if(e){var r=e.getModel(c.getVariantModelName());if(r){t.forEach(function(e){var n=e.getVariantReference();if(n){r.removeChange(e)}});if(!n){s.update({parameters:[],updateURL:true,updateHashEntry:true,model:r})}}}return t})}var d=function(e){this._oChangePersistence=undefined;this._sComponentName=e||"";if(this._sComponentName){this._oChangePersistence=r.getChangePersistenceForComponent(this.getComponentName())}};d.prototype.getComponentName=function(){return this._sComponentName};d.prototype.setVariantSwitchPromise=function(e){this._oVariantSwitchPromise=e};d.prototype.waitForVariantSwitch=function(){if(!this._oVariantSwitchPromise){this._oVariantSwitchPromise=Promise.resolve()}return this._oVariantSwitchPromise};d.prototype.createBaseChange=function(e,n){if(!n){throw new Error("No application component found. To offer flexibility a valid relation to its owning component must be present.")}e.reference=this.getComponentName();e.packageName="$TMP";var t=p.createUIChange(e);if(e.variantReference){t.setVariantReference(e.variantReference)}return t};d.prototype._createChange=function(t,r,o){var i=o&&(o.controlType||n.getControlType(o));var a=this.createBaseChange(t,r);return e.getChangeHandler(a.getChangeType(),i,o,l,a.getLayer()).then(function(e){if(e){return e.completeChangeContent(a,t,{modifier:l,appComponent:r,view:n.getViewForControl(o)})}throw new Error("Change handler could not be retrieved for change "+JSON.stringify(t)+".")}).then(function(){a.setState(h.LifecycleState.NEW);return a}).catch(function(e){return Promise.reject(e)})};d.prototype.createChangeWithExtensionPointSelector=function(e,t){return Promise.resolve().then(function(){if(!t){throw new Error("A flexibility change on extension point cannot be created without a valid extension point reference.")}var r=t.view;var o=n.getAppComponentForControl(r);e.selector={name:t.name,viewSelector:l.getSelector(r.getId(),o)};return o}).then(function(n){return this._createChange(e,n)}.bind(this))};d.prototype.createChangeWithControlSelector=function(e,t){var r;return(new n.FakePromise).then(function(){if(!t){throw new Error("A flexibility change cannot be created without a targeted control.")}var o=t.id||t.getId();if(!e.selector){e.selector={}}r=t.appComponent||n.getAppComponentForControl(t);if(!r){throw new Error("No application component found. To offer flexibility, the control with the ID '"+o+"' has to have a valid relation to its owning application component.")}Object.assign(e.selector,l.getSelector(o,r));return r}).then(function(n){return this._createChange(e,n,t)}.bind(this))};d.prototype.addChange=function(e,t){return this.createChangeWithControlSelector(e,t).then(function(e){var r=n.getAppComponentForControl(t);e._ignoreOnce=true;this.addPreparedChange(e,r);e.setQueuedForApply();return e}.bind(this))};d.prototype.addPreparedChange=function(e,n){if(e.getVariantReference()){var t=n.getModel(c.getVariantModelName());t.addChange(e)}this._oChangePersistence.addChange(e,n);return e};d.prototype.deleteChange=function(e,n){this._oChangePersistence.deleteChange(e);if(e.getVariantReference()){n.getModel(c.getVariantModelName()).removeChange(e)}};d.prototype.applyChange=function(e,t){var r={modifier:l,appComponent:n.getAppComponentForControl(t),view:n.getViewForControl(t)};return i.applyChangeOnControl(e,t,r).then(function(n){if(!n.success){var t=n.error||new Error("The change could not be applied.");this._oChangePersistence.deleteChange(e,true);throw t}return e}.bind(this))};function m(e,t,r,o,i){var a=v(e,o);if(!a){return[]}i.push(e);var s=e.getId();var p=t[s]&&t[s].dependencies||[];for(var h=0,c=p.length;h<c;h++){var l=n.getChangeFromChangesMap(r,p[h]);a=m(l,t,r,o,i);if(a.length===0){i=[];break}delete t[s]}return i}function v(e,n){var t=e.getDependentControlSelectorList();t.push(e.getSelector());return!t.some(function(e){return!l.bySelector(e,n)})}d.prototype.waitForChangesToBeApplied=function(e){var n=e.map(function(e){return this._waitForChangesToBeApplied(e)}.bind(this));return Promise.all(n).then(function(){return undefined})};d.prototype._waitForChangesToBeApplied=function(e){function t(n){return!n.isCurrentProcessFinished()&&(e.changeTypes.length===0||e.changeTypes.includes(n.getChangeType()))}e.changeTypes=e.changeTypes||[];var r=e.selector.id&&sap.ui.getCore().byId(e.selector.id)||e.selector;var o=this._oChangePersistence.getChangesMapForComponent();var i=[];var a=Object.assign({},o.mDependencies);var s=o.mChanges;var p=s[r.getId()]||[];var h=p.filter(t);var c=e.selector.appComponent||n.getAppComponentForControl(r);var l=[];h.forEach(function(e){var n=m(e,a,o.mChanges,c,[]);n.forEach(function(e){if(l.indexOf(e)===-1){l.push(e)}})});l.forEach(function(e){i=i.concat(e.addChangeProcessingPromises())},this);i.push(this.waitForVariantSwitch());return Promise.all(i)};d.prototype._removeOtherLayerChanges=function(e,n,r){if(r&&n){var o=Object.values(t).filter(function(e){return e!==n});return this.removeDirtyChanges(o,e,undefined,undefined,undefined,true)}return Promise.resolve()};d.prototype.saveAll=function(e,r,i,a,s,p){var h;var c;if(i){var l=o.getVersionsModel({reference:n.normalizeReference(this._sComponentName),layer:t.CUSTOMER});h=l.getProperty("/persistedVersion");c=l.getProperty("/draftFilenames")}return this._removeOtherLayerChanges(e,a,s).then(this._oChangePersistence.saveDirtyChanges.bind(this._oChangePersistence,e,r,undefined,h,c,p,a)).then(function(e){if(i&&e&&e.response){var n=e.response;if(Array.isArray(n)){n=n[0]}o.onAllChangesSaved({reference:n.reference,layer:n.layer})}return e})};d.prototype.processXmlView=function(e,t){var r=g.get(t.componentId);var o=n.getAppComponentForControl(r);t.appComponent=o;t.modifier=u;t.view=e;return this._oChangePersistence.getChangesForView(t).then(i.applyAllChangesForXMLView.bind(i,t)).catch(y.bind(this,t.view))};function y(e,n){f.error("Error processing view "+n+".");return e}d.prototype.getComponentChanges=function(e,n){return this._oChangePersistence.getChangesForComponent(e,n)};d.prototype.getOpenDependentChangesForControl=function(e,n){return this._oChangePersistence.getOpenDependentChangesForControl(e,n)};d.prototype.resetChanges=function(e,n,t,r,o){return this._oChangePersistence.resetChanges(e,n,r,o).then(C.bind(this,t,undefined))};d.prototype.removeDirtyChanges=function(e,n,t,r,o,i){return this._oChangePersistence.removeDirtyChanges(e,n,t,r,o).then(C.bind(this,n,i))};d.prototype.applyVariantChanges=function(e,t){var r;return e.reduce(function(e,n){return e.then(function(){var e={modifier:l,appComponent:t};this._oChangePersistence._addRunTimeCreatedChangeAndUpdateDependencies(t,n);r=e.modifier.bySelector(n.getSelector(),t);if(r){return i.applyChangeOnControl(n,r,e)}f.error("A flexibility change tries to change a nonexistent control.")}.bind(this))}.bind(this),new n.FakePromise)};d.prototype.saveSequenceOfDirtyChanges=function(e,n){return this._oChangePersistence.saveDirtyChanges(n,false,e)};return d});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FlexControllerFactory",["sap/ui/fl/FlexController","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/variants/VariantModel","sap/base/Log","sap/ui/performance/Measurement"],function(e,n,t,r,o,a,i,s,l,p){"use strict";var c={};c._instanceCache={};c._componentInstantiationPromises=new WeakMap;c.create=function(n){var t=c._instanceCache[n];if(!t){t=new e(n);c._instanceCache[n]=t}return t};c.createForControl=function(e){try{var t=n.getAppComponentForControl(e);var r=a.getFlexReferenceForControl(t||e);return c.create(r)}catch(e){l.error(e.message,undefined,"sap.ui.fl.FlexControllerFactory")}};function u(e,r){if(n.getUshellContainer()){return Promise.resolve(e)}var o=window.sessionStorage.getItem("sap.ui.rta.restart."+t.CUSTOMER);if(o){var i=a.getFlexReferenceForControl(r);if(o!==i&&o!=="true"){l.error("an application component was started "+"which does not match the component for which the restart was triggered:\n"+"Triggering component: "+o+"\n"+"Started component: "+i);return Promise.resolve(e)}return new Promise(function(n,t){Promise.all([sap.ui.getCore().loadLibrary("sap.ui.rta",{async:true}),r.rootControlLoaded()]).then(function(){sap.ui.require(["sap/ui/rta/api/startKeyUserAdaptation"],function(t){t({rootControl:r});n(e)})}).catch(function(e){t(e)})})}return Promise.resolve(e)}c.getChangesAndPropagate=function(e,t){if(n.isApplicationComponent(e)){var r=e.getId();o.clearFilteredResponse(a.getFlexReferenceForControl(e));var s=o.initialize({componentId:r,asyncHints:t.asyncHints}).then(f.bind(this,e));c._componentInstantiationPromises.set(e,s);return s}else if(n.isEmbeddedComponent(e)){var l=n.getAppComponentForControl(e);if(l&&n.isApplicationComponent(l)){var p=Promise.resolve();if(c._componentInstantiationPromises.has(l)){p=c._componentInstantiationPromises.get(l)}return p.then(function(){var e=l.getModel(i.getVariantModelName());if(!e){return f(l)}return e}).then(function(n){e.setModel(n,i.getVariantModelName())})}return Promise.resolve()}};function f(e){var n=e.getManifestObject();var t=c.createForControl(e,n);var o;return t._oChangePersistence.loadChangesMapForComponent(e).then(function(n){var a=r.applyAllChangesForControl.bind(r,n,e,t);a._bIsSapUiFlFlexControllerApplyChangesOnControl=true;e.addPropagationListener(a);o=new s({},{flexController:t,appComponent:e});return o.initialize()}).then(function(){e.setModel(o,i.getVariantModelName());p.end("flexProcessing");return o}).then(function(n){return u(n,e)})}return c},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Layer",[],function(){"use strict";return{USER:"USER",PUBLIC:"PUBLIC",CUSTOMER:"CUSTOMER",CUSTOMER_BASE:"CUSTOMER_BASE",PARTNER:"PARTNER",VENDOR:"VENDOR",BASE:"BASE"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/LayerUtils",["sap/base/util/UriParameters","sap/ui/thirdparty/hasher","sap/ui/fl/Layer"],function(e,r,t){"use strict";var a=[t.BASE,t.VENDOR,t.PARTNER,t.CUSTOMER_BASE,t.CUSTOMER,t.PUBLIC,t.USER];var n={};a.forEach(function(e,r){n[e]=r});function i(r){return e.fromQuery(window.location.search).get(r)}var u={_mLayersIndex:n,_sTopLayer:a[a.length-1],FL_MAX_LAYER_PARAM:"sap-ui-fl-max-layer",isValidLayer:function(e){return Object.keys(t).some(function(r){return r===e})},isVendorLayer:function(){return this.getCurrentLayer()===t.VENDOR},isCustomerDependentLayer:function(e){return[t.PUBLIC,t.CUSTOMER,t.CUSTOMER_BASE].indexOf(e)>-1},isDeveloperLayer:function(e){return u.compareAgainstCurrentLayer(e,t.CUSTOMER)===-1},doesCurrentLayerRequirePackage:function(){var e=this.getCurrentLayer();return e===t.VENDOR||e===t.PARTNER||e===t.CUSTOMER_BASE},getMaxLayer:function(e){var t=u.getMaxLayerTechnicalParameter(r.getHash(),e);return t||i(this.FL_MAX_LAYER_PARAM)||u._sTopLayer},getLayerIndex:function(e){return this._mLayersIndex[e]},isOverMaxLayer:function(e,r){return this.isOverLayer(e,this.getMaxLayer(r))},isOverLayer:function(e,r){return this.getLayerIndex(e)>this.getLayerIndex(r)},compareAgainstCurrentLayer:function(e,r){var t=r||u.getCurrentLayer();if(this.getLayerIndex(t)>this.getLayerIndex(e)||!e){return-1}else if(this.getLayerIndex(t)===this.getLayerIndex(e)){return 0}return 1},isLayerFilteringRequired:function(e){return this._sTopLayer!==this.getMaxLayer(e)},isSapUiLayerParameterProvided:function(){return!!i("sap-ui-layer")},getCurrentLayer:function(){var e=i("sap-ui-layer")||"";return e.toUpperCase()||t.CUSTOMER},filterChangeDefinitionsByMaxLayer:function(e,r){return e.filter(function(e){return!e.layer||!u.isOverMaxLayer(e.layer,r)})},filterChangeOrChangeDefinitionsByCurrentLayer:function(e,r){if(!r){return e}return e.filter(function(e){var t=e.getLayer&&e.getLayer()||e.layer;return r===t})},getMaxLayerTechnicalParameter:function(e,r){if(r){var t=r.parseShellHash(e)||{};if(t.params&&t.params.hasOwnProperty(this.FL_MAX_LAYER_PARAM)){return t.params[this.FL_MAX_LAYER_PARAM][0]}}return undefined}};return u});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Scenario",[],function(){"use strict";return{AppVariant:"APP_VARIANT",VersionedAppVariant:"VERSIONED_APP_VARIANT",AdaptationProject:"ADAPTATION_PROJECT",FioriElementsFromScratch:"FE_FROM_SCRATCH",UiAdaptation:"UI_ADAPTATION"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/Utils",["sap/base/strings/formatMessage","sap/base/util/ObjectPath","sap/base/util/isPlainObject","sap/base/util/uid","sap/base/util/UriParameters","sap/base/Log","sap/ui/base/SyncPromise","sap/ui/base/ManagedObject","sap/ui/core/util/reflection/BaseTreeModifier","sap/ui/core/Component","sap/ui/fl/Scenario","sap/ui/thirdparty/hasher","sap/ui/core/mvc/View","sap/ui/core/Configuration"],function(e,t,r,n,i,a,o,s,u,f,p,c,g,l){"use strict";function m(e){if(e&&e.getEntry){return e.getEntry("sap.app")&&e.getEntry("sap.app").type}return e&&e["sap.app"]&&e["sap.app"].type}function h(e,t){if(e&&e.startupParameters&&t){if(Array.isArray(e.startupParameters[t])){return e.startupParameters[t][0]}}}var d={formatAndLogMessage:function(t,r,n,i){var o=r.join(" ");o=e(o,n);a[t](o,i||"")},isVariantByStartupParameter:function(e){if(e){var t=this.getAppComponentForControl(e);if(t&&t.getComponentData){return!!h(t.getComponentData(),"sap-app-id")}}return false},getAppDescriptor:function(e){if(e){var t=this.getAppComponentForControl(e);if(t&&t.getMetadata){var r=t.getMetadata();if(r&&r.getManifest){return r.getManifest()}}}},getSiteIdByComponentData:function(e){return h(e,"hcpApplicationId")},isBinding:function(e){return typeof e==="string"&&!!s.bindingParser(e)||r(e)&&((e.hasOwnProperty("path")||e.hasOwnProperty("parts"))&&!e.hasOwnProperty("ui5object"))},isChangeRelatedToVariants:function(e){return e.getFileType()==="ctrl_variant_change"||e.getFileType()==="ctrl_variant_management_change"||e.getFileType()==="ctrl_variant"||e.getVariantReference()},getComponentForControl:function(e){function t(e){var r=f.getOwnerIdFor(e);if(!r){if(e&&typeof e.getParent==="function"){var n=e.getParent();if(n){return t(n)}}}return r||""}if(e){var r=t(e);if(r){return f.get(r)}}},getAppComponentForControl:function(e){var t=e instanceof f?e:d.getComponentForControl(e);if(t&&t.getAppComponent&&t.getAppComponent()instanceof f){return t.getAppComponent()}if(t&&t.oComponentData&&t.oComponentData.appComponent){return t.oComponentData.appComponent}if(t&&t.getManifestEntry){var r=t.getManifestEntry("sap.app");if(r&&r.type&&r.type!=="application"){if(t instanceof f){t=d.getComponentForControl(t)}return this.getAppComponentForControl(t)}}return t},getViewForControl:function(e){if(e instanceof g){return e}if(e&&typeof e.getParent==="function"){e=e.getParent();return d.getViewForControl(e)}},getClient:function(){var e;var t;e=i.fromQuery(window.location.search);t=e.get("sap-client");return t||undefined},getLrepUrl:function(){var e=l.getFlexibilityServices();var t=e.find(function(e){return e.connector==="LrepConnector"});return t?t.url:""},getCurrentLanguage:function(){var e=l.getLanguage();return d.convertBrowserLanguageToISO639_1(e)},convertBrowserLanguageToISO639_1:function(e){if(!e||typeof e!=="string"){return""}var t=e.indexOf("-");if(t<0&&e.length<=2){return e.toUpperCase()}if(t>0&&t<=2){return e.substring(0,t).toUpperCase()}return""},getControlType:function(e){var t;if(e&&typeof e.getMetadata==="function"){t=e.getMetadata();if(t&&typeof t.getElementName==="function"){return t.getElementName()}}},checkControlId:function(e,t){if(!t){e=e instanceof s?e:sap.ui.getCore().byId(e);t=d.getAppComponentForControl(e)}return u.checkControlId(e,t)},hasLocalIdSuffix:u.hasLocalIdSuffix,getParsedURLHash:function(e){if(e){return e.parseShellHash(c.getHash())||{}}return{}},getUrlParameter:function(e){return i.fromQuery(window.location.search).get(e)},getUshellContainer:function(){return t.get("sap.ushell.Container")},createDefaultFileName:function(e){var t=n().replace(/-/g,"_");if(e){t+="_"+e}return t},createNamespace:function(e,t){var r="changes";if(t==="ctrl_variant"){r="variants"}var n=e.reference.replace(".Component","");var i="apps/"+n+"/"+r+"/";return i},buildLrepRootNamespace:function(e,t,r){var n="apps/";var i=new Error("Error in sap.ui.fl.Utils#buildLrepRootNamespace: ");if(!e){i.message+="for every scenario you need a base ID";throw i}switch(t){case p.VersionedAppVariant:if(!r){i.message+="in a versioned app variant scenario you additionally need a project ID";throw i}n+=e+"/appVariants/"+r+"/";break;case p.AppVariant:if(!r){i.message+="in an app variant scenario you additionally need a project ID";throw i}n+=e+"/appVariants/"+r+"/";break;case p.AdaptationProject:if(!r){i.message+="in a adaptation project scenario you additionally need a project ID";throw i}n+=e+"/adapt/"+r+"/";break;case p.FioriElementsFromScratch:case p.UiAdaptation:default:n+=e+"/"}return n},isApplication:function(e){var t=m(e);return t==="application"},isApplicationComponent:function(e){return e instanceof f&&d.isApplication(e.getManifestObject())},isEmbeddedComponent:function(e){return e instanceof f&&m(e.getManifestObject())==="component"},indexOfObject:function(e,t){var r=-1;e.some(function(e,n){var i;var a;if(!e){i=[]}else{i=Object.keys(e)}if(!t){a=[]}else{a=Object.keys(t)}var o=i.length===a.length;var s=o&&!i.some(function(r){return e[r]!==t[r]});if(s){r=n}return s});return r},execPromiseQueueSequentially:function(e,t,r){if(e.length===0){if(r){return Promise.resolve()}return new d.FakePromise}var n=e.shift();if(typeof n==="function"){var i;try{i=n()}catch(e){i=Promise.reject(e)}return i.then(function(){if(!r&&i instanceof Promise){r=true}}).catch(function(e){var r="Error during execPromiseQueueSequentially processing occurred";r+=e?": "+e.message:"";a.error(r,e);if(t){throw new Error(r)}}).then(function(){return this.execPromiseQueueSequentially(e,t,r)}.bind(this))}a.error("Changes could not be applied, promise not wrapped inside function.");return this.execPromiseQueueSequentially(e,t,r)},FakePromise:function(e,t,r){d.FakePromise.fakePromiseIdentifier="sap.ui.fl.Utils.FakePromise";this.vValue=e;this.vError=t;this.bContinueWithFakePromise=arguments.length<3||r===d.FakePromise.fakePromiseIdentifier;var n=function(e,t){try{var r=t(e,d.FakePromise.fakePromiseIdentifier);if(o.isThenable(r)){return r}return new d.FakePromise(r)}catch(e){var n=e;return new d.FakePromise(undefined,n)}};d.FakePromise.prototype.then=function(e,t){if(!this.bContinueWithFakePromise){return Promise.resolve(e(this.vValue))}if(!this.vError){return n(this.vValue,e)}else if(t){return n(this.vError,t)}return this};d.FakePromise.prototype.catch=function(e){if(!this.bContinueWithFakePromise){return Promise.reject(e(this.vError))}if(this.vError){return n(this.vError,e)}return this};if(this.vValue instanceof Promise||this.vValue instanceof d.FakePromise){return this.vValue}},getChangeFromChangesMap:function(e,t){var r;Object.keys(e).forEach(function(n){e[n].some(function(e){if(e.getId()===t){r=e;return true}})});return r},requireAsync:function(e){var t=sap.ui.require(e);if(t){return Promise.resolve(t)}return new Promise(function(t,r){sap.ui.require([e],function(e){t(e)},function(e){r(e)})})},normalizeReference:function(e){return e.replace(/(.Component)$/g,"")},handleUrlParameters:function(e,t,r,n){if(this.hasParameterAndValue(t,r,n)){if(e.startsWith("?")){e=e.substr(1,e.length)}var i=e.split("&").filter(function(e){return e!==t+"="+r});e="";if(i.length>0){e="?"+i.toString()}}else{e+=(e.length>0?"&":"?")+t+"="+r}return e},hasParameterAndValue:function(e,t,r){return this.getParameter(e,r)===t},getParameter:function(e,t){if(t){var r=d.getParsedURLHash(t);return r.params&&r.params[e]&&r.params[e][0]}return d.getUrlParameter(e)},findAggregation:function(e,t){if(e){if(e.getMetadata){var r=e.getMetadata();var n=r.getAllAggregations();if(n){return n[t]}}}return undefined},getAggregation:function(e,t){var r=d.findAggregation(e,t);if(r){return e[r._sGetter]()}return undefined},getProperty:function(e,t){var r=e.getMetadata().getPropertyLikeSetting(t);if(r){var n=r._sGetter;return e[n]()}return undefined},getUShellService:function(e){if(e){var t=this.getUshellContainer();if(t){return t.getServiceAsync(e)}}return Promise.resolve()},getUShellServices:function(e){var t=e.map(function(e){return this.getUShellService(e)}.bind(this));return Promise.all(t).then(function(t){return e.reduce(function(e,r,n){e[r]=t&&t[n];return e},{})})}};return d},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/ChangesController",["sap/ui/fl/FlexControllerFactory","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/Utils"],function(t,e,r){"use strict";function n(t){var n=r.getAppDescriptor(t);return e.getAppIdFromManifest(n)}var p={getFlexControllerInstance:function(e){if(typeof e==="string"){return t.create(e)}var r=e.appComponent||e;return t.createForControl(r)},getDescriptorFlexControllerInstance:function(e){if(typeof e.appId==="string"){return t.create(e.appId)}var r=e.appComponent||e;var p=n(r);return t.create(p)},getAppComponentForSelector:function(t){if(typeof t.appId==="string"){return t}return t.appComponent||r.getAppComponentForControl(t)}};return p});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/DelegateMediator",["sap/base/Log","sap/base/util/merge","sap/base/util/restricted/_pick","sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r,n,a){"use strict";var i={};i._mDefaultDelegateItems={};i.types={READONLY:"readonly",WRITEONLY:"writeonly",COMPLETE:"complete"};function o(e,t){if(t){return t}if(e.getModel){var r=e.getModel();if(!r){return undefined}return r.getMetadata().getName()}}function u(e,t){t=o(e,t);var r=i._mDefaultDelegateItems[t];return(r||[]).map(function(e){e.payload={};return e})}function l(t,r,a){if(!a.length){return Promise.resolve([])}var i=[];a.forEach(function(a){i.push(function(i){return n.requireAsync(a.name).then(function(e){a.instance=e||{};i.push(a);return i}).catch(function(n){e.error("Failed to load the delegate for the control "+t.getId(r)+"\n"+n.message);return i})})});return i.reduce(function(e,t){return e.then(t)},Promise.resolve([]))}function s(e){return e&&typeof e==="function"}function f(e){return e.delegateType===i.types.COMPLETE||s(e.instance.getPropertyInfo)&&(s(e.instance.createLabel)||s(e.instance.createLayout))}function c(e){return e.delegateType===i.types.READONLY||s(e.instance.getPropertyInfo)}function d(e){return e.delegateType===i.types.WRITEONLY||s(e.instance.createLabel)||s(e.instance.createLayout)}function p(e,t){e.names.push(t.name);if(t.requiredLibraries){e.requiredLibraries=Object.assign(e.requiredLibraries||{},t.requiredLibraries)}if(t.payload&&!e.payload){e.payload=t.payload}return e}function g(e,n){e=p(e,n);return t(e,{instance:r(n.instance,["getPropertyInfo","getRepresentedProperties"])})}function m(e,n){e=p(e,n);return t(e,{instance:r(n.instance,["createLabel","createControlForProperty","createLayout"])})}function y(e,n){e=p(e,n);return t(e,r(n,"instance"))}function T(e){var t={names:[],instance:{},modelType:e.length&&e[0].modelType};var r=true;var n=true;for(var a=e.length-1;a>=0;a--){var i=e[a];if(f(i)){if(r&&n){t=y(t,i)}else if(r){t=g(t,i)}else if(n){t=m(t,i)}break}else if(c(i)&&r){t=g(t,i);r=false}else if(d(i)&&n){t=m(t,i);n=false}}return e.length?t:undefined}function D(e,t){return new Promise(function(r,n){if(!e){n(new Error("The control parameter is missing"))}if(!t){n(new Error("The modifier parameter is missing"))}if(!e){n(new Error("The input control should be available"))}if(t===a&&(!e.isA||!e.isA("sap.ui.base.ManagedObject"))){n(new Error("The input control should be a managed object"))}r()})}function h(e){return Object.values(i.types).some(function(t){return t===e.delegateType})}function b(e){var t=i._mDefaultDelegateItems[e.modelType]||[];var r=t.map(function(e){return e.delegateType});return r.indexOf(i.types.COMPLETE)>-1||r.indexOf(e.delegateType)>-1||e.delegateType===i.types.COMPLETE&&r.length}i.getKnownDefaultDelegateLibraries=function(){return["sap.ui.comp"]};i.getRequiredLibrariesForDefaultDelegate=function(e,t,r){r=o(t,r);var n=i._mDefaultDelegateItems[r]||[];return n.reduce(function(t,r){var n=e.indexOf(r.name)>-1;return t.concat(Object.keys(n&&r.requiredLibraries||{}))},[])};i.isDelegateRegistered=function(e){return!!i._mDefaultDelegateItems[e]};i.registerDefaultDelegate=function(e){if(!(e.modelType&&e.delegate)){throw new Error("'modelType' and 'delegate' properties are required for registration!")}e.delegateType=e.delegateType||i.types.COMPLETE;if(e.delegateType&&!h(e)){throw new Error("default 'delegateType': "+e.delegateType+" is invalid!")}if(b(e)){throw new Error("modelType "+e.modelType+"is already defined!")}if(!i._mDefaultDelegateItems[e.modelType]){i._mDefaultDelegateItems[e.modelType]=[]}i._mDefaultDelegateItems[e.modelType].push({name:e.delegate,requiredLibraries:e.requiredLibraries,delegateType:e.delegateType,modelType:e.modelType})};i.getDelegateForControl=function(e,t,r,n){return D(e,t).then(function(){return t.getFlexDelegate(e)}).then(function(a){var i=n&&u(e,r)||[];if(a){i.push(a)}return l(t,e,i)}).then(T.bind(this))};i.clear=function(){i._mDefaultDelegateItems={}};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Applier",["sap/base/Log","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/Utils"],function(e,n,r,t,a,o,i){"use strict";var s=new i.FakePromise;function l(e,n){var r=e.getSelector&&e.getSelector();if(!r||!r.id&&!r.name){return Promise.reject(Error("No selector in change found or no selector ID."))}function t(e){if(i.indexOfObject(n.failedSelectors,e)>-1){throw Error("A change depending on that control already failed, so the current change is skipped")}}return n.modifier.bySelectorTypeIndependent(r,n.appComponent,n.view).then(function(a){if(!a){throw Error("A flexibility change tries to change a nonexistent control.")}t(r);var o=e.getDependentControlSelectorList();o.forEach(function(e){var r=n.modifier.bySelector(e,n.appComponent,n.view);if(!r){throw new Error("A dependent selector control of the flexibility change is not available.")}t(e)});return a})}function c(e,n,r,o,i){var s=a.getControlIfTemplateAffected(n,e,i);var l=i.modifier;var c=!!t.sync.getAppliedCustomDataValue(s.control,n);var u=c||t.sync.hasChangeApplyFinishedCustomData(s.control,n);var f=n.isApplyProcessFinished();if(f&&!u){var d=a.checkIfDependencyIsStillValidSync.bind(null,i.appComponent,l,r);o._oChangePersistence.copyDependenciesFromInitialChangesMapSync(n,d,i.appComponent);n.setInitialApplyState()}else if(!f&&u){if(c){n.setRevertData(t.sync.getParsedRevertDataFromCustomData(s.control,n));n.markSuccessful()}else{n.markFailed()}}}function u(e){return e.modifier.targets==="xmlTree"}function f(e,n,r,o,s){var l=u(s);var c=a.getControlIfTemplateAffected(n,e,s);var f=s.modifier;return t.getAppliedCustomDataValue(c.control,n,f).then(function(e){var r=!!e;return Promise.all([r,r||t.hasChangeApplyFinishedCustomData(c.control,n,f)])}).then(function(c){var u=c[0];var f=c[1];var d=n.isApplyProcessFinished();var p=s.modifier;var g=s.appComponent;if(d&&!f){var h=new i.FakePromise;if(!l){var m=a.checkIfDependencyIsStillValid.bind(null,g,p,r);h=h.then(function(){return o._oChangePersistence.copyDependenciesFromInitialChangesMap(n,m,g)})}return h.then(n.setInitialApplyState.bind(n))}else if(!d&&f){if(u){return t.getParsedRevertDataFromCustomData(e,n,p).then(function(e){n.setRevertData(e);n.markSuccessful()})}n.markFailed();return undefined}else if(d&&f){n.markSuccessful()}return undefined})}function d(e,n){var r;if(u(n)&&e.getJsOnly()){r="Change cannot be applied in XML. Retrying in JS."}if(r){e.setInitialApplyState();throw Error(r)}}function p(e,r,a,o){return Promise.resolve().then(function(){if(a instanceof n){r.control=a}if(r.control){return o.modifier.updateAggregation(r.originalControl,e.getContent().boundAggregation)}return undefined}).then(function(){return t.addAppliedCustomData(r.control,e,o,u(o))}).then(function(){var n={success:true};e.markSuccessful(n);return n})}function g(e,n,r,a){var o=u(a);var s={success:false,error:e};var l=n.getId();var c="Change ''{0}'' could not be applied.";var f=e instanceof Error;var d=t.getCustomDataIdentifier(false,f,o);switch(d){case t.notApplicableChangesCustomDataKey:i.formatAndLogMessage("info",[c,e.message],[l]);break;case t.failedChangesCustomDataKeyXml:i.formatAndLogMessage("warning",[c,"Merge error detected while processing the XML tree."],[l],e.stack);break;case t.failedChangesCustomDataKeyJs:i.formatAndLogMessage("error",[c,"Merge error detected while processing the JS control tree."],[l],e.stack);break}return t.addFailedCustomData(r.control,n,a,d).then(function(){if(o){n.setInitialApplyState()}else{n.markFailed(s)}return s})}function h(n,r){var t=r.getChangeType();var a=r.getSelector().id;var o=r.getNamespace()+r.getId()+"."+r.getFileType();var i="A flexibility change could not be applied.";i+="\nThe displayed UI might not be displayed as intedend.";if(n.message){i+="\n   occurred error message: '"+n.message+"'"}i+="\n   type of change: '"+t+"'";i+="\n   LRep location of the change: "+o;i+="\n   id of targeted control: '"+a+"'.";e.warning(i,undefined,"sap.ui.fl.apply._internal.changes.Applier")}function m(e,n,t){var a={appComponent:t,modifier:r};var o=r.bySelector(e.originalSelectorToBeAdjusted,t);var i=n.getBindingInfo(e.getContent().boundAggregation).template;if(o.getParent()){var s=[];var l=o;do{s.push({aggregation:l.sParentAggregationName,index:l.getParent().getAggregation(l.sParentAggregationName).indexOf(l)});l=l.getParent()}while(l.getParent());s.reverse();s.forEach(function(e){i=i.getAggregation(e.aggregation)[e.index]})}e.addDependentControl(i,"originalSelector",a)}function v(e,n,r){var t=e.findIndex(function(e){return e.handler===n});if(t<0){t=e.length;e.push({handler:n,controls:[]})}if(!e[t].controls.includes(r)){e[t].controls.push(r)}}var C={addPreConditionForInitialChangeApplying:function(e){s=s.then(function(){return e})},applyChangeOnControl:function(e,n,r){var t=a.getControlIfTemplateAffected(e,n,r);var o=r.changeHandler?Promise.resolve(r.changeHandler):a.getChangeHandler(e,t,r);return o.then(function(n){d(e,r);return n}).then(function(n){if(e.hasApplyProcessStarted()){return e.addPromiseForApplyProcessing().then(function(n){e.markSuccessful();return n})}else if(!e.isApplyProcessFinished()){return(new i.FakePromise).then(function(){e.startApplying();return n.applyChange(e,t.control,r)}).then(function(n){return p(e,t,n,r)}).catch(function(n){return g(n,e,t,r)})}var a={success:true};e.markSuccessful(a);return a}).catch(function(e){return{success:false,error:e}})},applyAllChangesForControl:function(e,n,t,a){var l=e();var u=a.getId();var f=l.mChanges[u]||[];var d={modifier:r,appComponent:n,view:i.getViewForControl(a)};f.forEach(function(e){c(a,e,l,t,d);if(!e.isApplyProcessFinished()&&!e._ignoreOnce){e.setQueuedForApply()}});s=s.then(function(e,r){var t=[];var a=e.getId();var s=l.mChanges[a]||[];var c;if(l.mControlsWithDependencies[a]){o.removeControlsDependencies(l,a);c=true}s.forEach(function(i){if(i.originalSelectorToBeAdjusted){m(i,e,n);delete i.originalSelectorToBeAdjusted}if(i._ignoreOnce){delete i._ignoreOnce}else if(i.isApplyProcessFinished()){o.resolveDependenciesForChange(l,i.getId(),a)}else if(!l.mDependencies[i.getId()]){t.push(function(){return C.applyChangeOnControl(i,e,r).then(function(){o.resolveDependenciesForChange(l,i.getId(),a)})})}else{var s=C.applyChangeOnControl.bind(C,i,e,r);o.addChangeApplyCallbackToDependency(l,i.getId(),s)}});if(s.length||c){return i.execPromiseQueueSequentially(t).then(function(){return o.processDependentQueue(l,n,a)})}return undefined}.bind(null,a,d));return s},applyAllChangesForXMLView:function(n,r){if(!Array.isArray(r)){var t="No list of changes was passed for processing the flexibility on view: "+n.view+".";e.error(t,undefined,"sap.ui.fl.apply._internal.changes.Applier");r=[]}var o=[];n.failedSelectors=[];return r.reduce(function(e,r){var t;return e.then(l.bind(null,r,n)).then(function(e){t=e;var o=a.getControlIfTemplateAffected(r,t,n);return a.getChangeHandler(r,o,n)}).then(function(e){n.changeHandler=e;r.setQueuedForApply();return f(t,r,undefined,undefined,n)}).then(function(){if(!r.isApplyProcessFinished()){if(typeof n.changeHandler.onAfterXMLChangeProcessing==="function"){v(o,n.changeHandler,t)}return C.applyChangeOnControl(r,t,n)}return{success:true}}).then(function(e){if(!e.success){throw Error(e.error)}}).catch(function(e){r.getDependentSelectorList().forEach(function(e){if(i.indexOfObject(n.failedSelectors,e)===-1){n.failedSelectors.push(e)}});h(e,r)})},new i.FakePromise).then(function(){delete n.failedSelectors;o.forEach(function(r){r.controls.forEach(function(t){try{r.handler.onAfterXMLChangeProcessing(t,n)}catch(n){e.error("Error during onAfterXMLChangeProcessing",n)}})});return n.view})}};return C});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/FlexCustomData",["sap/ui/fl/Utils","sap/base/Log","sap/ui/core/CustomData"],function(t,e){"use strict";var a={};a.sync={};a.appliedChangesCustomDataKey="sap.ui.fl.appliedChanges";a.failedChangesCustomDataKeyJs="sap.ui.fl.failedChanges.js";a.failedChangesCustomDataKeyXml="sap.ui.fl.failedChanges.xml";a.notApplicableChangesCustomDataKey="sap.ui.fl.notApplicableChanges";a.sync.getAppliedCustomDataValue=function(t,e){var n=r(t,a._getCustomDataKey(e,a.appliedChangesCustomDataKey));return n.customDataValue};a.getAppliedCustomDataValue=function(t,e,n){return o(t,n,a._getCustomDataKey(e,a.appliedChangesCustomDataKey)).then(function(t){return t.customDataValue})};a.sync.getParsedRevertDataFromCustomData=function(t,n){var u=a.sync.getAppliedCustomDataValue(t,n);try{return u&&JSON.parse(u)}catch(t){e.error("Could not parse revert data from custom data",u);return undefined}};a.getParsedRevertDataFromCustomData=function(t,e,n){return a.getAppliedCustomDataValue(t,e,n).then(function(t){return t&&JSON.parse(t)})};a.sync.hasChangeApplyFinishedCustomData=function(e,n){var u=t.getAggregation(e,"customData")||[];var r=[a._getCustomDataKey(n,a.appliedChangesCustomDataKey),a._getCustomDataKey(n,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(n,a.notApplicableChangesCustomDataKey)];return u.some(function(e){var a=t.getProperty(e,"key");if(r.indexOf(a)>-1){return!!t.getProperty(e,"value")}return false})};a.hasChangeApplyFinishedCustomData=function(t,e,n){return Promise.resolve().then(n.getAggregation.bind(n,t,"customData")).then(function(t){t=t||[];var u=[a._getCustomDataKey(e,a.appliedChangesCustomDataKey),a._getCustomDataKey(e,a.failedChangesCustomDataKeyJs),a._getCustomDataKey(e,a.notApplicableChangesCustomDataKey)];return Promise.all(t.map(function(t){return Promise.resolve().then(n.getProperty.bind(n,t,"key")).then(function(e){if(u.indexOf(e)>-1){return n.getProperty(t,"value")}return undefined}).then(function(t){return!!t})})).then(function(t){return t.includes(true)})})};function n(t,e){var a=e.getRevertData();if(t&&a!==undefined){return JSON.stringify(a)}return"true"}a.addAppliedCustomData=function(t,e,r,o){var s=n(o,e);var i=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);return u(t,i,s,r)};a.addFailedCustomData=function(t,e,n,r){var o=a._getCustomDataKey(e,r);return u(t,o,"true",n)};a.sync.destroyAppliedCustomData=function(t,e,n){var u=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);var o=r(t,u);if(o.customData){n.destroy(o.customData)}};a.destroyAppliedCustomData=function(t,e,n){var u=a._getCustomDataKey(e,a.appliedChangesCustomDataKey);return o(t,n,u).then(function(t){if(t.customData){n.destroy(t.customData)}})};a.getCustomDataIdentifier=function(t,e,n){if(t){return a.appliedChangesCustomDataKey}if(!e){return a.notApplicableChangesCustomDataKey}if(n){return a.failedChangesCustomDataKeyXml}return a.failedChangesCustomDataKeyJs};a._getCustomDataKey=function(t,e){return e+"."+t.getId()};function u(t,e,a,n){return o(t,n.modifier,e).then(function(u){if(!u.customData){return n.modifier.createAndAddCustomData(t,e,a,n.appComponent)}return n.modifier.setProperty(u.customData,"value",a)})}function r(e,a){var n=t.getAggregation(e,"customData")||[];var u={};n.some(function(e){var n=t.getProperty(e,"key");if(n===a){u.customData=e;u.customDataValue=t.getProperty(e,"value");return true}return false});return u}function o(t,e,a){return Promise.resolve().then(e.getAggregation.bind(e,t,"customData")).then(function(t){t=t||[];var n={};return t.reduce(function(t,u){return t.then(e.getProperty.bind(e,u,"key")).then(function(t){if(t===a){n.customData=u;return e.getProperty(u,"value")}return undefined}).then(function(t){if(t){n.customDataValue=t}})},Promise.resolve()).then(function(){return n})})}return a},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Reverter",["sap/base/Log","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/Utils"],function(e,r,n,t){"use strict";var o={};function i(e){if(!e.isApplyProcessFinished()&&e.hasApplyProcessStarted()){return e.addPromiseForApplyProcessing().then(function(r){if(r&&r.error){e.markRevertFinished(r.error);throw Error(r.error)}})}return Promise.resolve()}function a(e,n,t,i){return o.revertChangeOnControl(e,n,t).then(function(t){return r.destroyAppliedCustomData(t||n,e,i.modifier).then(function(){return!!t})}).then(function(r){if(r){i.flexController._oChangePersistence._deleteChangeInMap(e)}})}o.revertChangeOnControl=function(r,t,o){var a=n.getControlIfTemplateAffected(r,t,o);var l;return n.getChangeHandler(r,a,o).then(function(e){l=e}).then(i.bind(null,r)).then(function(){if(r.isSuccessfullyApplied()){r.startReverting();return l.revertChange(r,a.control,o)}throw Error("Change was never applied")}).then(function(){a.control=o.modifier.bySelector(r.getSelector(),o.appComponent,o.view);if(a.bTemplateAffected){return o.modifier.updateAggregation(a.control,r.getContent().boundAggregation)}return undefined}).then(function(){r.markRevertFinished();return a.control}).catch(function(n){var t="Change could not be reverted: "+n.message;e.error(t);r.markRevertFinished(t);return false})};o.revertMultipleChanges=function(r,n){var o=[];r.forEach(function(r){r.setQueuedForRevert();o.push(function(){var o=r.getSelector&&r.getSelector();var i=n.modifier.bySelector(o,n.appComponent);if(!i){e.warning("A flexibility change tries to revert changes on a nonexistent control with id "+o.id);return new t.FakePromise}var l={modifier:n.modifier,appComponent:n.appComponent,view:t.getViewForControl(i)};return a(r,i,l,n)})});return t.execPromiseQueueSequentially(o)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/Utils",["sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/Utils"],function(e,n,t){"use strict";function r(e,n){if(n||e.hasApplyProcessStarted()){return false}return true}var a={getControlIfTemplateAffected:function(e,n,t){var r=t.modifier;var a={originalControl:n};var i=e.getOriginalSelector();if(e.getContent().boundAggregation&&i){a.control=r.bySelector(i,t.appComponent,t.view);a.controlType=r.getControlType(a.control);a.bTemplateAffected=true}else{a.control=n;a.controlType=r.getControlType(n);a.bTemplateAffected=false}return a},getChangeHandler:function(e,r,a){var i=a.modifier.getLibraryName(r.control);return t.requireAsync("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration").then(function(e){return e.waitForChangeHandlerRegistration(i)}).then(function(){var t=e.getChangeType();var i=e.getLayer();return n.getChangeHandler(t,r.controlType,r.control,a.modifier,i)})},checkIfDependencyIsStillValidSync:function(n,a,i,l){var o=t.getChangeFromChangesMap(i.mChanges,l);var c=a.bySelector(o.getSelector(),n);var g=e.sync.hasChangeApplyFinishedCustomData(c,o);return r(o,g)},checkIfDependencyIsStillValid:function(n,a,i,l){var o=t.getChangeFromChangesMap(i.mChanges,l);var c=a.bySelector(o.getSelector(),n);return e.hasChangeApplyFinishedCustomData(c,o,a).then(r.bind(null,o))},filterChangeByView:function(e,n){var t=e.modifier;var r=e.appComponent;var a=n.getSelector();if(!a){return false}if(a.viewSelector){var i=t.getControlIdBySelector(a.viewSelector,r);return i===e.viewId}var l=a.id;if(l){var o;if(n.getSelector().idIsLocal){if(r){o=r.getLocalId(e.viewId)}}else{o=e.viewId}var c=0;var g;do{c=l.indexOf("--",c);g=l.slice(0,c);c++}while(g!==o&&c>0);return g===o}return false}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/Applier",["sap/base/util/isEmptyObject","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory"],function(e,t){"use strict";var n="$sap.ui.fl.changes";function r(e){var r=e&&e.getEntry&&e.getEntry(n)&&e.getEntry(n).descriptor||[];return r.map(function(e){return t.createAppDescriptorChange(e)})}var a={applyChanges:function(t,n,r){return r.registry().then(function(e){var t=n.map(function(t){return e[t.getChangeType()]&&e[t.getChangeType()]()});return Promise.all(t)}).then(function(a){a.forEach(function(a,s){try{var i=n[s];t=a.applyChange(t,i);if(!a.skipPostprocessing&&!e(i.getTexts())){t=r.processTexts(t,i.getTexts())}}catch(e){r.handleError(e)}});return t})},applyChangesIncludedInManifest:function(e,t){var a=r(e);var s=e.getJson();delete s[n];if(a.length>0){return this.applyChanges(s,a,t).then(function(){return})}return Promise.resolve()}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory",["sap/ui/fl/requireAsync","sap/base/Log"],function(e,r){"use strict";var t={registry:function(){return e("sap/ui/fl/apply/_internal/changes/descriptor/Registration")},handleError:function(e){r.error(e)},processTexts:function(e,t){var n=JSON.stringify(e);Object.keys(t).forEach(function(e){if(t[e].value[""]){n=n.replace("{{"+e+"}}",t[e].value[""])}else{r.error("Text change has to contain default language")}});return JSON.parse(n)}};var n={getRuntimeStrategy:function(){return t}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor",["sap/ui/fl/apply/_internal/changes/descriptor/Applier","sap/ui/fl/apply/_internal/changes/descriptor/ApplyStrategyFactory","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/performance/Measurement","sap/ui/fl/Utils"],function(e,t,n,a,i,r){"use strict";var s={preprocessManifest:function(s,p){if(!r.isApplication(s,true)||!p.id){return Promise.resolve(s)}i.start("flexStateInitialize","Initialization of flex state",["sap.ui.fl"]);var l=p.componentData||{};var c=a.getFlexReference({manifest:s,componentData:l});if(!a.getChangeManifestFromAsyncHints(p.asyncHints)){n.initialize({componentData:l,asyncHints:p.asyncHints,rawManifest:s,componentId:p.id,reference:c,partialFlexState:true}).then(i.end.bind(undefined,"flexStateInitialize"));return Promise.resolve(s)}return n.initialize({componentData:l,asyncHints:p.asyncHints,rawManifest:s,componentId:p.id,reference:c,partialFlexState:true}).then(function(){i.end("flexStateInitialize");i.start("flexAppDescriptorMerger","Client side app descriptor merger",["sap.ui.fl"]);var a=Object.assign({},s);var r=n.getAppDescriptorChanges(c);return e.applyChanges(a,r,t.getRuntimeStrategy())}).then(function(e){i.end("flexAppDescriptorMerger");return e})}};return s});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/controlVariants/URLHandler",["sap/ui/core/Component","sap/ui/fl/Utils","sap/base/Log","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/isEmptyObject","sap/ui/base/ManagedObjectObserver","sap/ui/thirdparty/hasher","sap/base/util/includes","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState"],function(e,a,r,t,n,o,i,s,l,p,m){"use strict";var c={};var d={};function u(e,a){var r=[];return e.reduce(function(e,t){var n=a.getVariantManagementReference(t).variantManagementReference;if(n){if(l(r,n)){e.updateRequired=true;return e}r.push(n)}if(n&&a.oData[n].currentVariant!==t){e.updateRequired=true;if(a.oData[n].currentVariant!==a.oData[n].defaultVariant){e.parameters.push(a.oData[n].currentVariant)}}else{e.parameters.push(t)}return e},{updateRequired:false,parameters:[]})}function f(e,a){var r=n.get(["params",p.VARIANT_TECHNICAL_PARAMETER],e);if(r){var t=u(r,a);if(t.updateRequired){d.update({updateURL:!a._bDesignTimeMode,parameters:t.parameters,updateHashEntry:true,model:a})}}}function v(e,a){try{var t=e.getUShellService("URLParsing");if(t){var n=t.parseShellHash(a);f(n,e)}}catch(e){r.error(e.message)}var o=e.getUShellService("ShellNavigation");return o&&o.NavigationFilterStatus.Continue}function A(e){var a=e.getUShellService("ShellNavigation");if(!c[e.sFlexReference]){c[e.sFlexReference]=v.bind(null,e);if(a){a.registerNavigationFilter(c[e.sFlexReference])}}}function h(e){var a=e.getUShellService("ShellNavigation");if(a){a.unregisterNavigationFilter(c[e.sFlexReference]);delete c[e.sFlexReference]}}function R(e){var a=e.model;var t=a.getUShellService("URLParsing");var n=a.getUShellService("CrossApplicationNavigation");var o=t&&t.parseShellHash(s.getHash());if(o&&o.params){var i=a.oAppComponent&&a.oAppComponent.getComponentData&&a.oAppComponent.getComponentData()&&a.oAppComponent.getComponentData().technicalParameters;if(!i){r.warning("Component instance not provided, so technical parameters in component data and browser history remain unchanged")}if(e.parameters.length===0){delete o.params[p.VARIANT_TECHNICAL_PARAMETER];i&&delete i[p.VARIANT_TECHNICAL_PARAMETER]}else{o.params[p.VARIANT_TECHNICAL_PARAMETER]=e.parameters;i&&(i[p.VARIANT_TECHNICAL_PARAMETER]=e.parameters)}if(e.silent){s.changed.active=false;s.replaceHash(t.constructShellHash(o));s.changed.active=true}else{n.toExternal({target:{semanticObject:o.semanticObject,action:o.action,context:o.contextRaw},params:o.params,appSpecificRoute:o.appSpecificRoute,writeHistory:false})}}}function g(e){var a={index:-1};var r=e.model;var n=r.getUShellService("URLParsing");var o=n&&n.parseShellHash(s.getHash()).params;if(o){a.parameters=[];if(r._bDesignTimeMode){o[p.VARIANT_TECHNICAL_PARAMETER]=d.getStoredHashParams(e)}if(Array.isArray(o[p.VARIANT_TECHNICAL_PARAMETER])){o[p.VARIANT_TECHNICAL_PARAMETER]=o[p.VARIANT_TECHNICAL_PARAMETER].map(decodeURIComponent);o[p.VARIANT_TECHNICAL_PARAMETER].some(function(t,n){var o=m.getVariant({vmReference:e.vmReference,vReference:t,reference:r.oChangePersistence.getComponentName()});if(o){a.index=n;return true}})}}return t(a,o&&o[p.VARIANT_TECHNICAL_PARAMETER]&&{parameters:o[p.VARIANT_TECHNICAL_PARAMETER]})}function C(e){var a=e.getUShellService("URLParsing");var r=a&&a.parseShellHash(s.getHash());return r&&r.params&&r.params[p.VARIANT_TECHNICAL_PARAMETER]}d.variantTechnicalParameterName="sap-ui-fl-control-variant-id";d.initialize=function(e){var a=e.model;var r=a.getUShellService("URLParsing");var t=r&&r.parseShellHash(s.getHash());var n=t&&t.params&&t.params[p.VARIANT_TECHNICAL_PARAMETER];d.attachHandlers(e);d.update({model:a,parameters:n,updateHashEntry:Array.isArray(n)&&n.length>0});f(t,a)};d.updateVariantInURL=function(e){var a=d.removeURLParameterForVariantManagement(e);if(!a.parameters){return}var r=a.parameters||[];var t=a.index;var n=e.newVReference===e.model.oData[e.vmReference].defaultVariant;if(!n){if(t===-1){r=r.concat([e.newVReference])}else{r=r.slice(0,t).concat([e.newVReference],r.slice(t))}}if(!n||t>-1){d.update({parameters:r,updateURL:!e.model._bDesignTimeMode,updateHashEntry:true,model:e.model})}};d.removeURLParameterForVariantManagement=function(e){var a=g(e);if(a.index>-1){a.parameters.splice(a.index,1)}return a};d.attachHandlers=function(a){function r(){return a.model._oVariantSwitchPromise.then(function(){a.model._oHashData.controlPropertyObservers.forEach(function(e){e.destroy()});h(a.model);a.model.destroy();a.model.oComponentDestroyObserver.unobserve(a.model.oAppComponent,{destroy:true});a.model.oComponentDestroyObserver.destroy()})}A(a.model);if(!a.model.oComponentDestroyObserver&&a.model.oAppComponent instanceof e){a.model.oComponentDestroyObserver=new i(r.bind(null));a.model.oComponentDestroyObserver.observe(a.model.oAppComponent,{destroy:true})}};d.registerControl=function(e){if(e.updateURL){e.model._oHashData.variantControlIds.push(e.vmReference)}};d.update=function(e){if(!e.model._oHashData){e.model._oHashData={hashParams:[],controlPropertyObservers:[],variantControlIds:[]}}if(!e||!Array.isArray(e.parameters)){r.info("Variant URL parameters could not be updated since invalid parameters were received");return}if(e.updateURL){R(e)}if(e.updateHashEntry&&!o(e.model)){e.model._oHashData.hashParams=e.parameters}};d.getStoredHashParams=function(e){return Array.prototype.slice.call(e.model._oHashData.hashParams)};d.handleModelContextChange=function(e){var a="modelContextChange";function r(a,r){var t=r.model.getVariantManagementReferenceForControl(a.getSource());var n=r.model._oHashData.variantControlIds;var o=n.indexOf(t);if(o>-1){n.slice(o).forEach(function(a){if(g({vmReference:a,model:e.model}).index===-1){r.model.switchToDefaultForVariantManagement(a)}})}}var t=new i(function(t){if(t.current===true&&t.old===false){t.object.attachEvent(a,{model:e.model},r)}else if(t.current===false&&t.old===true){t.object.detachEvent(a,r)}});t.observe(e.vmControl,{properties:["resetOnContextChange"]});e.model._oHashData.controlPropertyObservers.push(t);if(e.vmControl.getResetOnContextChange()!==false){e.vmControl.attachEvent(a,{model:e.model},r)}};d.clearAllVariantURLParameters=function(e){if(C(e.model)){d.update({updateURL:true,parameters:[],updateHashEntry:false,model:e.model})}};return d});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/controlVariants/Utils",["sap/ui/core/Core","sap/ui/fl/Utils"],function(e,t){"use strict";function r(e,t){if(!t){return undefined}if(e.indexOf(t.getId())>-1){return t.getId()}return r(e,t.getParent())}function n(r,n){var a=t.getAppComponentForControl(r);var o=a.getRootControl();var i=[];if(!n&&o.getDomRef()){i=Array.from(o.getDomRef().querySelectorAll(".sapUiFlVarMngmt"))}if(n||i.length===0){i=Array.from(e.getStaticAreaRef().querySelectorAll(".sapUiFlVarMngmt"))}return i.map(function(e){return e.id})}var a={DEFAULT_AUTHOR:"SAP",VARIANT_TECHNICAL_PARAMETER:"sap-ui-fl-control-variant-id",compareVariants:function(e,t){if(e.getName().toLowerCase()<t.getName().toLowerCase()){return-1}else if(e.getName().toLowerCase()>t.getName().toLowerCase()){return 1}return 0},getIndexToSortVariant:function(e,t){var r=e.length;e.some(function(e,n){if(a.compareVariants(t.instance,e.instance)<0){r=n;return true}});return r},getRelevantVariantManagementControlId:function(t,a,o){var i={};if(!a||!a.length){a=n(t,o)}var u=a.reduce(function(t,r){var n=e.byId(r);if(n){var a=n.getFor();a.forEach(function(e){i[e]=r});t=t.concat(a)}return t},[]);var f=r(u,t);return i[f]},belongsToVariantManagement:function(e){var t=n(e);return!!a.getRelevantVariantManagementControlId(e,t)},getAllVariantManagementControlIds:function(e){return n(e)}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/AppDescriptorChange",["sap/ui/fl/apply/_internal/flexObjects/FlexObject"],function(e){"use strict";var t=e.extend("sap.ui.fl.apply._internal.flexObjects.AppDescriptorChange",{metadata:{properties:{appDescriptorChange:{type:"boolean",defaultValue:true}}}});t.getMappingInfo=function(){return Object.assign(e.getMappingInfo(),{appDescriptorChange:"appDescriptorChange"})};t.prototype.getMappingInfo=function(){return t.getMappingInfo()};t.prototype.getSelector=function(){return{}};t.prototype.isValidForDependencyMap=function(){return false};t.prototype.getVariantReference=function(){return undefined};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/CompVariant",["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/Variant","sap/ui/fl/LayerUtils","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/Utils"],function(t,e,r,a,n,i,s){"use strict";var o=r.extend("sap.ui.fl.apply._internal.flexObjects.CompVariant",{metadata:{properties:{persisted:{type:"boolean",defaultValue:true},persistencyKey:{type:"string"}},aggregations:{revertData:{type:"sap.ui.base.ManagedObject",multiple:true,singularName:"revertData",defaultValue:[]},changes:{type:"sap.ui.base.ManagedObject",multiple:true,defaultValue:[]}}},constructor:function(t){r.apply(this,arguments);this.setFileType("variant");if(t.favorite!==undefined){this.setFavorite(!!t.favorite)}else if(t.layer===n.VENDOR||t.layer===n.CUSTOMER_BASE){this.setFavorite(true)}}});o.STANDARD_VARIANT_ID="*standard*";o.getMappingInfo=function(){return Object.assign(r.getMappingInfo(),{persistencyKey:"selector.persistencyKey",variantId:"variantId"})};o.prototype.getMappingInfo=function(){return o.getMappingInfo()};function p(t){var e=i.getInstanceOrUndef();var r=e&&e.getUserId();return!r||!t||r.toUpperCase()===t.toUpperCase()}function u(t,e,r){if(e){return t===e}else if(t===n.USER){return true}var s=i.getInstanceOrUndef();if(a.isSapUiLayerParameterProvided()){e=a.getCurrentLayer()}else if(!e){e=s.isPublicLayerAvailable()?n.PUBLIC:n.CUSTOMER}var o=t===e;var u=s.isKeyUser()||p(r);return o&&u}function f(t){return!t||s.getCurrentLanguage()===t}function l(t,e){var r=i.getInstanceOrUndef();if(!r){return true}if(!t||!e){return true}var a=r.getSystem();var n=r.getClient();return a===t&&e===n}o.prototype.getPackage=function(){return this.getFlexObjectMetadata().packageName};o.prototype.isVariant=function(){return true};o.prototype.isRenameEnabled=function(t){return!this.getStandardVariant()&&this.isEditEnabled(t)&&f(this.getSupportInformation().originalLanguage)};o.prototype.isEditEnabled=function(t){var e=t&&a.isDeveloperLayer(t);var r=l(this.getSupportInformation().sourceSystem,this.getSupportInformation().sourceClient);var n=u(this.getLayer(),t,this.getOwnerId());return e||r&&n};o.prototype.isDeleteEnabled=function(t){var e=l(this.getSupportInformation().sourceSystem,this.getSupportInformation().sourceClient);return e&&u(this.getLayer(),t,this.getOwnerId())&&!this.getStandardVariant()};o.prototype.storeFavorite=function(t){if(t!==this.getFavorite()){this.setState(e.LifecycleState.DIRTY);this.setFavorite(t)}};o.prototype.getOwnerId=function(){return this.getSupportInformation().user||""};o.prototype.storeContent=function(t){this.setContent(t)};o.prototype.storeExecuteOnSelection=function(t){if(t!==this.getExecuteOnSelection()){this.setState(e.LifecycleState.DIRTY);this.setExecuteOnSelection(t)}};o.prototype.storeName=function(t){this.setName(t)};o.prototype.storeContexts=function(t){this.setContexts(t);this.setState(e.LifecycleState.DIRTY)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/ControllerExtensionChange",["sap/ui/fl/apply/_internal/flexObjects/FlexObject"],function(e){"use strict";var t=e.extend("sap.ui.fl.apply._internal.flexObjects.ControllerExtensionChange",{metadata:{properties:{controllerName:{type:"string"}}}});t.getMappingInfo=function(){return Object.assign(e.getMappingInfo(),{controllerName:"selector.controllerName"})};t.prototype.getMappingInfo=function(){return t.getMappingInfo()};t.prototype.getSelector=function(){return{controllerName:this.getControllerName()}};t.prototype.getVariantReference=function(){return undefined};t.prototype.isValidForDependencyMap=function(){return false};t.prototype.setInitialApplyState=function(){};t.prototype.getModuleName=function(){return this.getFlexObjectMetadata().moduleName};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/FlVariant",["sap/ui/core/Core","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/Variant"],function(e,t,n){"use strict";var a=n.extend("sap.ui.fl.apply._internal.flexObjects.FlVariant",{metadata:{properties:{variantReference:{type:"string"},variantManagementReference:{type:"string"},visible:{type:"boolean",defaultValue:true}}},constructor:function(a,i){if(typeof a!=="string"&&a!==undefined){i=a;a=i&&i.id}i.fileType="ctrl_variant";if(i.favorite===undefined){i.favorite=true}n.apply(this,arguments);if(!this.getName()&&i.content&&i.content.title){this.setName(i.content.title)}var r=this.getName().match(/.i18n>(\w+)./);if(r){this.setName(e.getLibraryResourceBundle("sap.ui.fl").getText(r[1]))}var f=this.getSupportInformation();if(this.getId()===this.getVariantManagementReference()){this.setStandardVariant(true);if(!f.user){f.user=t.DEFAULT_AUTHOR;this.setSupportInformation(f)}}}});a.getMappingInfo=function(){return Object.assign(n.getMappingInfo(),{variantReference:"variantReference",variantManagementReference:"variantManagementReference"})};a.prototype.getMappingInfo=function(){return a.getMappingInfo()};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/FlexObject",["sap/base/util/deepClone","sap/base/util/isEmptyObject","sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/util/restricted/_omit","sap/ui/base/ManagedObject","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Layer","sap/ui/fl/registry/Settings","sap/ui/fl/Utils"],function(t,e,a,n,r,i,o,s,p,u){"use strict";var c=i.extend("sap.ui.fl.apply._internal.flexObjects.FlexObject",{metadata:{properties:{state:{type:"string",defaultValue:o.LifecycleState.NEW},fileType:{type:"string",defaultValue:"change"},layer:{type:"string"},flexObjectMetadata:{type:"object",defaultValue:{}},supportInformation:{type:"object",defaultValue:{}},content:{type:"any",defaultValue:{}},texts:{type:"object",defaultValue:{}}}},constructor:function(){i.apply(this,arguments);var t=this.getFlexObjectMetadata();var e=t.reference;if(e){if(!t.namespace){t.namespace=u.createNamespace({reference:e},this.getFileType())}if(!t.projectId){t.projectId=e.replace(".Component","")}}this.setFlexObjectMetadata(t);var a=this.getSupportInformation();if(!a.originalLanguage){a.originalLanguage=u.getCurrentLanguage()}this.setSupportInformation(a)}});c.getMappingInfo=function(){return Object.assign({},{"flexObjectMetadata.changeType":"changeType","flexObjectMetadata.reference":"reference","flexObjectMetadata.namespace":"namespace","flexObjectMetadata.creation":"creation","flexObjectMetadata.projectId":"projectId","flexObjectMetadata.packageName":"packageName","flexObjectMetadata.moduleName":"moduleName","supportInformation.generator":"support.generator","supportInformation.service":"support.service","supportInformation.sourceSystem":"sourceSystem","supportInformation.sourceClient":"sourceClient","supportInformation.user":"support.user","supportInformation.sapui5Version":"support.sapui5Version","supportInformation.sourceChangeFileName":"support.sourceChangeFileName","supportInformation.compositeCommand":"support.compositeCommand","supportInformation.command":"support.command","supportInformation.oDataInformation":"oDataInformation","supportInformation.originalLanguage":"originalLanguage",layer:"layer",fileType:"fileType",id:"fileName",content:"content",texts:"texts"})};c.prototype.getMappingInfo=function(){return c.getMappingInfo()};c.prototype.setContent=function(t,e){this.setProperty("content",t);if(!e){this.setState(o.LifecycleState.DIRTY)}return this};c.prototype.getFlexObjectMetadata=function(){return Object.assign({},this.getProperty("flexObjectMetadata"))};c.prototype.getSupportInformation=function(){return Object.assign({},this.getProperty("supportInformation"))};function f(t,e){if(!Object.values(o.LifecycleState).includes(t)){return false}if(e===o.LifecycleState.NEW&&t===o.LifecycleState.DIRTY){return false}return true}c.prototype.setState=function(t){var e=this.getState();if(e!==t&&f(t,e)){this._sPreviousState=e;this.setProperty("state",t)}return this};c.prototype.markForDeletion=function(){this.setState(o.LifecycleState.DELETED)};c.prototype.restorePreviousState=function(){if(this._sPreviousState){this.setState(this._sPreviousState);delete this._sPreviousState}};c.prototype.isChangeFromOtherSystem=function(){var t=this.getSupportInformation().sourceSystem;var e=this.getSupportInformation().sourceClient;if(!t||!e){return false}var a=p.getInstanceOrUndef();if(!a){return true}var n=a.getSystem();var r=a.getClient();if(!n||!r){return false}return t!==n||e!==r};c.prototype.getNamespace=function(){return this.getFlexObjectMetadata().namespace};c.prototype.getChangeType=function(){return this.getFlexObjectMetadata().changeType};c.prototype.isUserDependent=function(){return this.getLayer()===s.USER};c.prototype.getText=function(t){var e=this.getTexts()[t]||{};return e.value||""};c.prototype.setText=function(t,e,a,n){var r=Object.assign({},this.getTexts());var i={value:e};if(a){i.type=a}r[t]=Object.assign({},r[t],i);this.setTexts(r);if(!n){this.setState(o.LifecycleState.DIRTY)}return this};c.prototype.setRequest=function(t){this._sRequest=t};c.prototype.getRequest=function(){return this._sRequest||""};c.prototype.getDefinition=function(){return this.convertToFileContent()};c.prototype.getCreation=function(){return this.getFlexObjectMetadata().creation};c.prototype.setCreation=function(t){var e=this.getFlexObjectMetadata();e.creation=t;this.setFlexObjectMetadata(e)};function l(t){return t.length?t.charAt(0).toUpperCase()+t.slice(1):t}function g(t){return typeof this[t]==="function"?this[t].bind(this):function(){throw new Error(t+" is not a valid mutator")}}function h(e){var a=e.split(".");a[0]=l(a[0]);var r=a.shift();var i=g.call(this,"get"+r);var o=g.call(this,"set"+r);return{getValue:function(){var e=t(i());if(a.length>0){return n.get(a,e)}return e},setValue:function(e){var r=t(i());if(a.length>0){n.set(a,e,r)}else{r=e}o(r);return this}.bind(this)}}c.prototype.convertToFileContent=function(){var t={};Object.entries(this.getMappingInfo()).forEach(function(e){var a=h.call(this,e[0]).getValue();if(a!==undefined){n.set(e[1],a,t)}}.bind(this));return t};function y(t,e){var a=h.call(this,t);var n=a.getValue();if(n!==e){a.setValue(e)}}c.mapFileContent=function(e,n){var r=Object.values(n);var i={};var o=function(t,e,s){var p=s?s+"."+t:t;var u=r.indexOf(p);if(u>=0){var c=Object.keys(n)[u];i[c]=e}else if(a(e)){Object.entries(e).forEach(function(t){o(t[0],t[1],p)})}};Object.entries(t(e)).forEach(function(t){o(t[0],t[1])});return i};c.prototype.update=function(t){var e=r(t,["fileName"]);var a=c.mapFileContent(e,this.getMappingInfo());Object.entries(a).forEach(function(t){y.call(this,t[0],t[1])}.bind(this))};c.prototype.setResponse=function(t){if(!t||e(t)){return}this.update(t);this.setState(o.LifecycleState.PERSISTED)};return c});
/* !
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory",["sap/base/util/restricted/_pick","sap/base/util/ObjectPath","sap/ui/core/Core","sap/ui/fl/apply/_internal/flexObjects/AppDescriptorChange","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/ControllerExtensionChange","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/FlVariant","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,r,n,a,o,i,c,s,l,p,u){"use strict";var f={BASE_FLEX_OBJECT:i,COMP_VARIANT_OBJECT:a,FL_VARIANT_OBJECT:c,CONTROLLER_EXTENSION:o,APP_DESCRIPTOR_CHANGE:n,UI_CHANGE:s};function g(e){if(e.fileType==="variant"){return f.COMP_VARIANT_OBJECT}else if(e.fileType==="ctrl_variant"){return f.FL_VARIANT_OBJECT}else if(e.changeType==="codeExt"){return f.CONTROLLER_EXTENSION}else if(e.appDescriptorChange){return f.APP_DESCRIPTOR_CHANGE}return f.UI_CHANGE}function m(e){var t=e.type||e.changeType;var n=e.fileName||e.id||u.createDefaultFileName(t);return{id:n,layer:e.layer,content:e.content,texts:e.texts,supportInformation:{service:e.ODataService,oDataInformation:e.oDataInformation,command:e.command,compositeCommand:e.compositeCommand,generator:e.generator,sapui5Version:r.getConfiguration().getVersion().toString(),sourceChangeFileName:e.support&&e.support.sourceChangeFileName,sourceSystem:e.sourceSystem,sourceClient:e.sourceClient,originalLanguage:e.originalLanguage,user:e.user},flexObjectMetadata:{changeType:t,reference:e.reference,packageName:e.packageName,projectId:e.projectId}}}var C={};C.createFromFileContent=function(e,n){var a=Object.assign({},e);var o=n||g(a);if(!o){throw new Error("Unknown file type")}a.support=Object.assign({generator:"FlexObjectFactory.createFromFileContent",sapui5Version:r.getConfiguration().getVersion().toString()},a.support||{});var c=o.getMappingInfo();var s=i.mapFileContent(a,c);var l=Object.entries(s).reduce(function(e,r){t.set(r[0].split("."),r[1],e);return e},{});var p=new o(l);return p};C.createUIChange=function(e){var t=m(e);if(!t.layer){t.layer=e.isUserDependent?l.USER:p.getCurrentLayer()}t.selector=e.selector;t.jsOnly=e.jsOnly;t.variantReference=e.variantReference;t.fileType=e.fileType||"change";return new s(t)};C.createAppDescriptorChange=function(e){e.compositeCommand=e.compositeCommand||e.support&&e.support.compositeCommand;var t=m(e);return new n(t)};C.createControllerExtensionChange=function(e){e.generator=e.generator||"FlexObjectFactory.createControllerExtensionChange";e.changeType="codeExt";e.content={codeRef:e.codeRef};var t=m(e);t.flexObjectMetadata.moduleName=e.moduleName;t.controllerName=e.controllerName;return new o(t)};C.createFlVariant=function(e){e.generator=e.generator||"FlexObjectFactory.createFlVariant";var t=m(e);t.variantManagementReference=e.variantManagementReference;t.variantReference=e.variantReference;t.contexts=e.contexts;t.texts={variantName:{value:e.variantName,type:"XFLD"}};return new c(t)};C.createCompVariant=function(e){e.generator=e.generator||"FlexObjectFactory.createCompVariant";e.user=t.get("support.user",e);var r=m(e);r.variantId=e.variantId||r.id;r.contexts=e.contexts;r.favorite=e.favorite;r.persisted=e.persisted;r.persistencyKey=e.persistencyKey||t.get("selector.persistencyKey",e);if(e.layer===l.VENDOR||e.layer===l.CUSTOMER_BASE){r.favorite=true}if(e.executeOnSelection!==undefined){r.executeOnSelection=e.executeOnSelection}else{r.executeOnSelection=r.content&&(r.content.executeOnSelect||r.content.executeOnSelection)}return new a(r)};return C});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/States",[],function(){"use strict";return{LifecycleState:{NEW:"NEW",PERSISTED:"NONE",DELETED:"DELETE",DIRTY:"UPDATE"},ApplyState:{INITIAL:"initial",APPLYING:"applying",REVERTING:"reverting",REVERT_FINISHED:"revert finished",APPLY_SUCCESSFUL:"apply successful",APPLY_FAILED:"apply failed"},Operations:{APPLY:"apply",REVERT:"revert"}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/UIChange",["sap/base/util/isEmptyObject","sap/base/util/isPlainObject","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/Utils"],function(e,t,s,r,o){"use strict";var n=s.extend("sap.ui.fl.apply._internal.flexObjects.UIChange",{metadata:{properties:{selector:{type:"object",defaultValue:{}},dependentSelectors:{type:"object",defaultValue:{}},applyState:{type:"string",defaultValue:r.ApplyState.NEW},jsOnly:{type:"boolean"},variantReference:{type:"string"},revertData:{type:"any",defaultValue:null}},aggregations:{},associations:{},events:{}},constructor:function(){s.apply(this,arguments);this._oChangeProcessingPromises={};this.setInitialApplyState()}});n.getMappingInfo=function(){return Object.assign(s.getMappingInfo(),{selector:"selector",dependentSelectors:"dependentSelector",jsOnly:"jsOnly",variantReference:"variantReference"})};n.prototype.getMappingInfo=function(){return n.getMappingInfo()};n.prototype.setQueuedForRevert=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==r.Operations.REVERT){this._aQueuedProcesses.unshift(r.Operations.REVERT)}};n.prototype.isQueuedForRevert=function(){return this._aQueuedProcesses.indexOf(r.Operations.REVERT)>-1};n.prototype.setQueuedForApply=function(){if(this._aQueuedProcesses[this._aQueuedProcesses.length-1]!==r.Operations.APPLY){this._aQueuedProcesses.unshift(r.Operations.APPLY)}};n.prototype.isQueuedForApply=function(){return this._aQueuedProcesses.indexOf(r.Operations.APPLY)>-1};n.prototype.setInitialApplyState=function(){this._aQueuedProcesses=[];delete this._ignoreOnce;this.setApplyState(r.ApplyState.INITIAL);this._oChangeProcessedPromise={};this._oChangeProcessedPromise.promise=new Promise(function(e){this._oChangeProcessedPromise.resolveFunction={resolve:e}}.bind(this))};n.prototype.isInInitialState=function(){return this._aQueuedProcesses.length===0&&this.getApplyState()===r.ApplyState.INITIAL};n.prototype.isValidForDependencyMap=function(){return!!this.getSelector().id};n.prototype.startApplying=function(){this.setApplyState(r.ApplyState.APPLYING)};n.prototype.markFinished=function(e,t){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(r.Operations.APPLY,e);var s=t!==false?r.ApplyState.APPLY_SUCCESSFUL:r.ApplyState.APPLY_FAILED;this.setApplyState(s)};n.prototype.markSuccessful=function(e){this.markFinished(e,true)};n.prototype.markFailed=function(e){this.markFinished(e,false)};n.prototype.startReverting=function(){this.setApplyState(r.ApplyState.REVERTING)};n.prototype.markRevertFinished=function(e){this._aQueuedProcesses.pop();this._resolveChangeProcessingPromiseWithError(r.Operations.REVERT,e);this.setApplyState(r.ApplyState.REVERT_FINISHED)};n.prototype.hasApplyProcessStarted=function(){return this.getApplyState()===r.ApplyState.APPLYING};n.prototype.isSuccessfullyApplied=function(){return this.getApplyState()===r.ApplyState.APPLY_SUCCESSFUL};n.prototype.hasApplyProcessFailed=function(){return this.getApplyState()===r.ApplyState.APPLY_FAILED};n.prototype.isApplyProcessFinished=function(){return this.isSuccessfullyApplied()||this.hasApplyProcessFailed()};n.prototype.hasRevertProcessStarted=function(){return this.getApplyState()===r.ApplyState.REVERTING};n.prototype.isRevertProcessFinished=function(){return this.getApplyState()===r.ApplyState.REVERT_FINISHED};n.prototype.isCurrentProcessFinished=function(){return this._aQueuedProcesses.length===0&&this.getApplyState()!==r.ApplyState.INITIAL};n.prototype.addChangeProcessingPromise=function(e){if(!this._oChangeProcessingPromises[e]){this._oChangeProcessingPromises[e]={};this._oChangeProcessingPromises[e].promise=new Promise(function(t){this._oChangeProcessingPromises[e].resolveFunction={resolve:t}}.bind(this))}return this._oChangeProcessingPromises[e].promise};n.prototype.addChangeProcessingPromises=function(){var e=[];if(this.getApplyState()===r.ApplyState.INITIAL&&this._oChangeProcessedPromise){e.push(this._oChangeProcessedPromise.promise)}this._aQueuedProcesses.forEach(function(t){e.push(this.addChangeProcessingPromise(t))},this);return e};n.prototype.addPromiseForApplyProcessing=function(){return this.addChangeProcessingPromise(r.Operations.APPLY)};n.prototype._resolveChangeProcessingPromiseWithError=function(e,t){if(this._oChangeProcessingPromises[e]){this._oChangeProcessingPromises[e].resolveFunction.resolve(t);delete this._oChangeProcessingPromises[e]}if(this._oChangeProcessedPromise){this._oChangeProcessedPromise.resolveFunction.resolve(t);this._oChangeProcessedPromise=null}};n.prototype.hasRevertData=function(){return this.getRevertData()!==null};n.prototype.resetRevertData=function(){this.setRevertData(null)};n.prototype.setDependentSelectors=function(e){this.setProperty("dependentSelectors",e);delete this._aDependentSelectorList};n.prototype.addDependentControl=function(t,s,r,o){if(!t){throw new Error("Parameter vControl is mandatory")}if(!s){throw new Error("Parameter sAlias is mandatory")}if(!r||e(r)){throw new Error("Parameter mPropertyBag is mandatory")}var n=Object.assign({},this.getDependentSelectors());if(n[s]){throw new Error("Alias '"+s+"' already exists in the change.")}var i=r.modifier;var p=r.appComponent;if(Array.isArray(t)){var a=[];t.forEach(function(e){a.push(i.getSelector(e,p,o))});n[s]=a}else{n[s]=i.getSelector(t,p,o)}this.setDependentSelectors(n);delete this._aDependentSelectorList};n.prototype.getDependentControl=function(e,t){var s=[];if(!e){throw new Error("Parameter sAlias is mandatory")}if(!t){throw new Error("Parameter mPropertyBag is mandatory")}var r=t.modifier;var o=t.appComponent;var n=this.getDependentSelectors()[e];if(Array.isArray(n)){n.forEach(function(e){s.push(r.bySelector(e,o,t.view))});return s}return r.bySelector(n,o,t.view)};n.prototype.getDependentSelectorList=function(){var e=[this.getSelector()];if(!this._aDependentSelectorList){if(!this.getOriginalSelector()){Object.entries(this.getDependentSelectors()).some(function(t){var s=t[1];if(!Array.isArray(s)){s=[s]}s.forEach(function(t){if(t&&o.indexOfObject(e,t)===-1){e.push(t)}})})}this._aDependentSelectorList=e}return this._aDependentSelectorList};n.prototype.getDependentControlSelectorList=function(){var e=this.getDependentSelectorList().concat();if(e.length>0){var t=this.getSelector();var s=o.indexOfObject(e,t);if(s>-1){e.splice(s,1)}}return e};n.prototype.getOriginalSelector=function(){return this.getDependentSelectors().originalSelector};n.prototype.setExtensionPointInfo=function(e){this._oExtensionPointInfo=e};n.prototype.getExtensionPointInfo=function(){if(t(this._oExtensionPointInfo)){return Object.assign({},this._oExtensionPointInfo)}return this._oExtensionPointInfo};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/UpdatableChange",["sap/ui/fl/apply/_internal/flexObjects/UIChange"],function(e){"use strict";var t=e.extend("sap.ui.fl.apply._internal.flexObjects.UpdatableChange",{metadata:{aggregations:{revertInfo:{type:"sap.ui.base.ManagedObject",multiple:true,singularName:"revertInfo",defaultValue:[]}}}});t.getMappingInfo=function(){return Object.assign(e.getMappingInfo(),{})};t.prototype.popLatestRevertInfo=function(){var e=this.getRevertInfo().pop();this.removeRevertInfo(e);return e};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexObjects/Variant",["sap/ui/fl/apply/_internal/flexObjects/FlexObject"],function(t){"use strict";var e=t.extend("sap.ui.fl.apply._internal.flexObjects.Variant",{metadata:{properties:{favorite:{type:"boolean",defaultValue:false},executeOnSelection:{type:"boolean",defaultValue:false},standardVariant:{type:"boolean",defaultValue:false},contexts:{type:"object",defaultValue:{}},variantId:{type:"string"}}},constructor:function(){t.apply(this,arguments);if(!this.getVariantId()){this.setVariantId(this.getId())}}});e.getMappingInfo=function(){return Object.assign(t.getMappingInfo(),{favorite:"favorite",executeOnSelection:"executeOnSelection",standardVariant:"standardVariant",contexts:"contexts"})};e.prototype.getMappingInfo=function(){return e.getMappingInfo()};e.prototype.getName=function(){return this.getText("variantName")};e.prototype.setName=function(t,e){this.setText("variantName",t,"XFLD",e)};return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/FlexState",["sap/base/util/restricted/_omit","sap/base/util/each","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap","sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap","sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap","sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap","sap/ui/fl/apply/_internal/flexState/Loader","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/write/_internal/FlexInfoSession"],function(e,n,t,a,r,i,o,s,p,c,l,f,u,g,d,h){"use strict";var m={};var v={};var S={};var R={};var F;var C;var x;var I={appDescriptorChanges:{prepareFunction:o,pathInResponse:[]},changes:{prepareFunction:s,pathInResponse:["changes"]},variants:{prepareFunction:c,pathInResponse:["variants","variantChanges","variantDependentControlChanges","variantManagementChanges"]},compVariants:{prepareFunction:p,pathInResponse:["comp.variants","comp.standardVariants","comp.defaultVariants","comp.changes"]}};var D={compVariants:{},variants:{}};function y(e){var n=i.get(e.componentId);e.componentData=e.componentData||n.getComponentData()||{};e.manifest=e.manifest||e.rawManifest||n.getManifestObject();e.reference=e.reference||f.getFlexReference(e)}function V(e,n){if(!v[e]){throw new Error("State is not yet initialized")}if(!v[e].preparedMaps[n]){if(!v[e].storageResponse){v[e].storageResponse=L(v[e].unfilteredStorageResponse)}var t={unfilteredStorageResponse:v[e].unfilteredStorageResponse,storageResponse:v[e].storageResponse,componentId:v[e].componentId,componentData:v[e].componentData,reference:e};v[e].preparedMaps[n]=m.callPrepareFunction(n,t)}return v[e].preparedMaps[n]}function P(e){return V(e,"appDescriptorChanges")}function M(e){return V(e,"changes")}function U(e){return V(e,"variants")}function b(e){return V(e,"compVariants")}function z(e){if(e.reference.endsWith(".Component")){var n=e.reference.split(".");n.pop();var a=n.join(".");v[a]=t({},{storageResponse:{changes:u.getEmptyFlexDataResponse()},unfilteredStorageResponse:{changes:u.getEmptyFlexDataResponse()},preparedMaps:{},componentId:e.componentId,partialFlexState:e.partialFlexState});R[a]=R[e.reference]}}function L(e){var r=t({},e);var i=r.changes;var o=B("URLParsing");if(g.isLayerFilteringRequired(o)){n(I,function(e,n){n.pathInResponse.forEach(function(e){a.set(e,g.filterChangeDefinitionsByMaxLayer(a.get(e,i),o),i)})})}return r}function _(e){R[e.reference]=l.loadFlexData(e).then(function(n){v[e.reference]=t({},{unfilteredStorageResponse:n,preparedMaps:{},componentId:e.componentId,componentData:e.componentData,partialFlexState:e.partialFlexState});z(e);E(e.reference);N(e.reference,n);return n});return R[e.reference]}function N(e,n){var t=n&&n.changes||{};if(t.info!==undefined){var a=h.getByReference(e);if(a===null){a={}}a.allContextsProvided=t.info.allContextsProvided;h.setByReference(a,e)}}function E(e){var n=B("ShellNavigation");if(n&&!S[e]){S[e]=O.bind(null,e);n.registerNavigationFilter(S[e])}}function j(e){var n=B("ShellNavigation");if(n){if(S[e]){n.unregisterNavigationFilter(S[e]);delete S[e]}}}function O(e,n,t){var a=B("ShellNavigation");if(a){try{var i=g.getMaxLayerTechnicalParameter(n,B("URLParsing"));var o=g.getMaxLayerTechnicalParameter(t,B("URLParsing"));if(i!==o){m.clearFilteredResponse(e)}}catch(e){r.error(e.message)}return a.NavigationFilterStatus.Continue}return undefined}function w(e){var n=v[e.reference];if(n.partialFlexState===true&&e.partialFlexState!==true){n.partialFlexState=false;e.partialFlexData=t({},n.unfilteredStorageResponse.changes);e.reInitialize=true}return e}function k(e){var n=v[e.reference].componentId;if(!e.reInitialize&&n!==e.componentId){e.reInitialize=true}return e}function A(){return Promise.all([d.getUShellService("ShellNavigation"),d.getUShellService("URLParsing")]).then(function(e){F=e[0];C=e[1]}).catch(function(e){r.error("Error getting service from Unified Shell: "+e.message)})}function B(e){if(d.getUshellContainer()){if(e==="ShellNavigation"){return F}else if(e==="URLParsing"){return C}}return undefined}function q(){return Promise.all([d.requireAsync("sap/ui/fl/ChangePersistenceFactory")]).then(function(e){x=e[0]}).catch(function(e){r.error("Error loading modules: "+e.message)})}m.initialize=function(e){return Promise.all([A(),q()]).then(function(){y(e);var n=e.reference;if(R[n]){return R[n].then(w.bind(null,e)).then(k).then(function(e){return e.reInitialize?_(e):v[n].unfilteredStorageResponse})}return _(e)}).then(function(e){if(!v[e.reference].componentData){var n=i.get(e.componentId);v[e.reference].componentData=n?n.getComponentData():e.componentData}}.bind(null,e))};m.isInitialized=function(e){var n=e.reference?e.reference:f.getFlexReferenceForControl(e.control);return!!v[n]};m.clearAndInitialize=function(e){y(e);m.clearState(e.reference);m.clearState(d.normalizeReference(e.reference));return m.initialize(e)};m.clearState=function(e){if(e){j(e);delete v[e];delete R[e];if(x&&(x._instanceCache||{}).hasOwnProperty(e)){x._instanceCache[e].removeDirtyChanges()}}else{Object.keys(v).forEach(function(e){j(e)});v={};R={}}};m.setInitialNonFlCompVariantData=function(e,n,t,a){D.compVariants[e]=D.compVariants[e]||{};D.compVariants[e][n]={};D.compVariants[e][n].standardVariant=t;D.compVariants[e][n].variants=a};m.getInitialNonFlCompVariantData=function(e){return D.compVariants[e]};m.setFakeStandardVariant=function(e,n,a){var r=m.getVariantsState(e);if(!r[Object.keys(a)[0]]){t(r,a);D.variants[e]=D.variants[e]||{};D.variants[e][n]=D.variants[e][n]||{};t(D.variants[e][n],a)}};m.resetFakedStandardVariants=function(e,n){if(D.variants[e]){delete D.variants[e][n]}};m.clearFilteredResponse=function(e){if(v[e]){v[e].preparedMaps={};delete v[e].storageResponse}};m.getUIChanges=function(e){return M(e).changes};m.getAppDescriptorChanges=function(e){return P(e).appDescriptorChanges};m.getVariantsState=function(e){var t=U(e);if(D.variants[e]){n(D.variants[e],function(a,r){if(v[e].componentId===a){n(r,function(e,n){if(!t[e]){t[e]=n}})}})}return t};m.getUI2Personalization=function(e){return v[e].unfilteredStorageResponse.changes.ui2personalization};m.getCompVariantsMap=function(e){return b(e)};m.callPrepareFunction=function(e,n){return I[e].prepareFunction(n)};m.getStorageResponse=function(e){if(R[e]){return R[e].then(function(){return v[e].unfilteredStorageResponse})}return Promise.resolve()};m.getFlexObjectsFromStorageResponse=function(e){return v[e]&&v[e].unfilteredStorageResponse.changes};return m});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/Loader",["sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/initial/_internal/Storage","sap/ui/fl/Utils"],function(e,n,t){"use strict";function a(e){if(typeof e==="string"){e={id:e}}e.idIsLocal=true;return e}function r(e,n){if(e){[n.changes,n.variantChanges,n.variantDependentControlChanges,n.variantManagementChanges].forEach(function(e){e.forEach(function(e){if(!e.selector.idIsLocal){e.selector=a(e.selector);if(e.dependentSelector){Object.keys(e.dependentSelector).forEach(function(n){if(Array.isArray(e.dependentSelector[n])){e.dependentSelector[n]=e.dependentSelector[n].map(a)}else{e.dependentSelector[n]=a(e.dependentSelector[n])}})}}})})}return n}function i(n){return n&&!!e.getOvpEntry(n)}function o(e){return{changes:e,cacheKey:e.cacheKey}}return{loadFlexData:function(a){var c=e.getBaseComponentNameFromManifest(a.manifest);if(a.partialFlexData){return n.completeFlexData({reference:a.reference,componentName:c,partialFlexData:a.partialFlexData}).then(o)}var s=a.reInitialize?undefined:e.getCacheKeyFromAsyncHints(a.reference,a.asyncHints);return n.loadFlexData({preview:e.getPreviewSectionFromAsyncHints(a.asyncHints),reference:a.reference,componentName:c,cacheKey:s,siteId:t.getSiteIdByComponentData(a.componentData),appDescriptor:a.manifest.getRawJson?a.manifest.getRawJson():a.manifest,version:a.version,allContexts:a.allContexts}).then(r.bind(undefined,i(a.manifest))).then(o)}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/ManifestUtils",["sap/ui/fl/Utils"],function(e){"use strict";function t(e){if(e&&e.indexOf(".Component")<0){e+=".Component"}return e}function n(e){if(e&&e.requests&&Array.isArray(e.requests)){return e.requests.find(function(e){return e.name==="sap.ui.fl.changes"})}}function r(e){var n=e.manifest;var r=e.componentData||{};if(r.startupParameters){if(Array.isArray(r.startupParameters["sap-app-id"])){return r.startupParameters["sap-app-id"][0]}}var i=n.getEntry?n.getEntry("sap.ui5"):n["sap.ui5"];if(i){if(i.appVariantId){return i.appVariantId}if(i.componentName){return t(i.componentName)}}return t(a(n))}function a(e){if(e){var t="${pro"+"ject.art"+"ifactId}";var n=e.getEntry?e.getEntry("sap.app"):e["sap.app"];var r=n&&n.id;if(r===t){if(e.getComponentName){return e.getComponentName()}if(e.name){return e.name}}return r}throw new Error("No Manifest received, descriptor changes are not possible")}var i={getAppIdFromManifest:a,getFlexReference:r,getFlexReferenceForControl:function(t){var n=e.getAppComponentForControl(t);return n&&r({manifest:n.getManifestObject(),componentData:n.getComponentData()})},getOvpEntry:function(e){return e.getEntry?e.getEntry("sap.ovp"):e["sap.ovp"]},getCacheKeyFromAsyncHints:function(e,t){var r=n(t);if(r&&r.reference===e){return r.cachebusterToken||"<NO CHANGES>"}},getPreviewSectionFromAsyncHints:function(e){var t=n(e);if(t){return t.preview}},getChangeManifestFromAsyncHints:function(e){var t=n(e);if(t){return false}return true},getBaseComponentNameFromManifest:function(e){var t=e.getEntry?e.getEntry("sap.ui5"):e["sap.ui5"];return t&&t.componentName||a(e)},isFlexExtensionPointHandlingEnabled:function(t){var n=e.getAppComponentForControl(t);return!!(n&&n.getManifestEntry("sap.ui5")&&n.getManifestEntry("sap.ui5").flexExtensionPointEnabled)}};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/appDescriptorChanges/prepareAppDescriptorMap",["sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory"],function(e){"use strict";return function(r){var p=r.storageResponse.changes.appDescriptorChanges||[];var a=p.map(function(r){return e.createFromFileContent(r)});return{appDescriptorChanges:a}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler",["sap/base/util/includes","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Utils"],function(e,n,t){"use strict";var d="sap.ui.fl:PendingChange";var i={};function c(e,t){return n.getControlIdBySelector(e,t)}function s(e){return{changeObject:e,dependencies:[],controlsDependencies:[],dependentIds:[]}}function a(e,n,t){r(t,n,e);o(t,n)}function o(n,t){if(!e(n.aChanges,t)){n.aChanges.push(t)}}function r(n,t,d){if(!n.mChanges[d]){n.mChanges[d]=[]}if(!e(n.mChanges[d],t)){n.mChanges[d].push(t)}}function p(e,n,t){var d=e.getSelector();if(d){if(d.id){a(c(d,n),e,t)}else{o(t,e)}}return t.aChanges}function f(e,n){return e.some(function(e){return e.id===n.id&&e.idIsLocal===n.idIsLocal})}function u(e,n,t,d,i,s,a){var o=t.getDependentSelectorList();n.some(function(n){if(f(o,n)){var r=c(n,i);var p=d&&s.indexOf(e)<s.indexOf(t);if(p){l(t,e,r,a,true)}else{l(e,t,r,a)}return true}})}function h(e,n,t,d){if(e.isValidForDependencyMap()){var i=e.getDependentSelectorList();g(e,i,n,d);var c=t.indexOf(e);var s=c<t.length-1;var a=t.slice();a.splice(c,1);a.reverse().forEach(function(c){if(c.isValidForDependencyMap()){u(e,i,c,s,n,t,d)}})}}function g(e,n,t,d){if(n.length){var i=n.map(function(e){return c(e,t)});if(!d.mDependencies[e.getId()]){d.mDependencies[e.getId()]=s(e)}d.mDependencies[e.getId()].controlsDependencies=i;i.forEach(function(n){d.mControlsWithDependencies[n]=d.mControlsWithDependencies[n]||[];d.mControlsWithDependencies[n].push(e.getId())})}}function l(n,t,d,i,c){if(m(n,t,d,i,c)){i.mDependencies[n.getId()].dependencies.push(t.getId());if(!e(i.mDependencies[n.getId()].dependentIds,d)){i.mDependencies[n.getId()].dependentIds.push(d)}if(!i.mDependentChangesOnMe[t.getId()]){i.mDependentChangesOnMe[t.getId()]=[]}i.mDependentChangesOnMe[t.getId()].push(n.getId())}}function m(n,t,d,i,c){var s=!c&&e(i.mDependencies[n.getId()].dependentIds,d);var a=false;if(i.mDependentChangesOnMe[t.getId()]){i.mDependentChangesOnMe[t.getId()].some(function(t){a=e(i.mDependencies[n.getId()].dependencies,t);return a})}return!s&&!a}function D(e,n){var c=[];var s=[];var a=[];if(e.dependencyRemovedInLastBatch[n]){e.dependencyRemovedInLastBatch[n].forEach(function(n){var t=e.mDependencies[n];if(t&&t.dependencies.length===0&&!(t.controlsDependencies&&t.controlsDependencies.length)){s.push(n);c.push(t.changeObject.getId());if(t[d]){a.push(function(){return t[d]()})}}})}return t.execPromiseQueueSequentially(a).then(function(n,t,d){delete e.dependencyRemovedInLastBatch[d];t.forEach(function(n){delete e.mDependencies[n]});n.forEach(function(n){i.resolveDependenciesForChange(e,n,d)});return!!n.length}.bind(undefined,c,s,n))}i.createEmptyDependencyMap=function(){return{aChanges:[],mChanges:{},mDependencies:{},mDependentChangesOnMe:{},mControlsWithDependencies:{},dependencyRemovedInLastBatch:{}}};i.addChangeAndUpdateDependencies=function(e,n,t){var d=p(e,n,t);h(e,n,d,t)};i.insertChange=function(e,n,t){var d=n&&n.aChanges&&n.aChanges.indexOf(t);if(d>-1){n.aChanges.splice(d+1,0,e)}};i.addRuntimeChangeAndUpdateDependencies=function(e,n,t,d){var i=p(e,n,t);h(e,n,i,d)};i.processDependentQueue=function(e,n,t){return D(e,t).then(function(t,d){if(d){return i.processDependentQueue(e,n,t)}}.bind(undefined,t))};i.addChangeApplyCallbackToDependency=function(e,n,t){e.mDependencies[n][d]=t};i.removeControlsDependencies=function(n,t){var d=n.mControlsWithDependencies[t];if(d){d.forEach(function(d){var i=n.mDependencies[d];if(i&&i.controlsDependencies&&i.controlsDependencies.length){var c=i.controlsDependencies.indexOf(t);if(c>-1){i.controlsDependencies.splice(c,1);delete n.mControlsWithDependencies[t];n.dependencyRemovedInLastBatch[t]=n.dependencyRemovedInLastBatch[t]||[];if(!e(n.dependencyRemovedInLastBatch[t],d)){n.dependencyRemovedInLastBatch[t].push(d)}}}});delete n.mControlsWithDependencies[t]}};i.resolveDependenciesForChange=function(n,t,d){var i=n.mDependentChangesOnMe[t];if(i){i.forEach(function(i){var c=n.mDependencies[i];var s=c?c.dependencies.indexOf(t):-1;if(s>-1){c.dependencies.splice(s,1);n.dependencyRemovedInLastBatch[d]=n.dependencyRemovedInLastBatch[d]||[];if(!e(n.dependencyRemovedInLastBatch[d],i)){n.dependencyRemovedInLastBatch[d].push(i)}}});delete n.mDependentChangesOnMe[t]}};i.removeChangeFromMap=function(e,n){Object.keys(e.mChanges).some(function(t){var d=e.mChanges[t];var i=d.map(function(e){return e.getId()}).indexOf(n);if(i!==-1){d.splice(i,1);return true}});var t=e.aChanges.map(function(e){return e.getId()}).indexOf(n);if(t!==-1){e.aChanges.splice(t,1)}};i.removeChangeFromDependencies=function(e,n,t){i.resolveDependenciesForChange(e,n,t);delete e.mDependencies[n]};i.getOpenDependentChangesForControl=function(e,t,d){var i=[];Object.keys(e.mDependencies).forEach(function(c){e.mDependencies[c].changeObject.getDependentSelectorList().forEach(function(s){if(n.getControlIdBySelector(s,d)===t){i.push(e.mDependencies[c].changeObject)}})});return i};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/changes/prepareChangesMap",[],function(){"use strict";return function(){}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger",["sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/base/Log"],function(e,t,n){"use strict";var a={addFavorite:function(e){e.setFavorite(true)},removeFavorite:function(e){e.setFavorite(false)},updateVariant:function(e,t){var n=t.getContent();if(n.executeOnSelection!==undefined){e.setExecuteOnSelection(n.executeOnSelection)}if(n.favorite!==undefined){e.setFavorite(n.favorite)}if(n.contexts){e.setContexts(n.contexts)}if(n.variantContent){e.setContent(n.variantContent,true)}var a=t.getText("variantName");if(a){e.setName(a,true)}},standardVariant:function(e,t){e.setExecuteOnSelection(t.getContent().executeOnSelect)}};function r(e){var t={};e.changes.forEach(function(e){var n=e.getSelector().variantId||e.getContent().key;if(!t[n]){t[n]=[]}t[n].push(e)});return t}function i(e,t){n.error("No change handler for change with the ID '"+t.getId()+"' and type '"+t.getChangeType()+"' defined.\n"+"The variant '"+e.getId()+"'was not modified'")}function o(n,a){var r={fileName:a.fileName,variantId:a.id||e.STANDARD_VARIANT_ID,persisted:a.persisted,content:a.content||{},texts:{variantName:{value:a.name||""}},selector:{persistencyKey:n}};if(a.favorite!==undefined){r.favorite=a.favorite}if(a.executeOnSelection!==undefined){r.executeOnSelection=a.executeOnSelection}return t.createCompVariant(r)}function f(e,t){var n=a[t.getChangeType()]||i;n(e,t);e.addChange(t)}function c(e,t){var n=t.getVariantId();if(e[n]){e[n].forEach(function(e){f(t,e)})}}return{merge:function(e,t,n){var a=t.nonPersistedVariants.concat(t.variants);var i=r(t);var f;a.forEach(function(e){if(e.getContent()&&e.getContent().standardvariant){f=e}});if(!f){f=o(e,n)}else{a=a.filter(function(e){return!e.getContent()||!e.getContent().standardvariant})}a.forEach(c.bind(undefined,i));f.setFavorite(true);f.setStandardVariant(true);t.byId[f.getVariantId()]=f;var u=t.standardVariantChange;if(u){i[f.getVariantId()]=i[f.getVariantId()]||[];i[f.getVariantId()].push(u);i[f.getVariantId()].sort(function(e,t){if(e.getCreation()<t.getCreation()){return-1}if(e.getCreation()>t.getCreation()){return 1}return 0})}c(i,f);t.standardVariant=f;return{standardVariant:f,variants:a}},createVariant:function(e,t){return o(e,t)},applyChangeOnVariant:f}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/compVariants/prepareCompVariantsMap",["sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantMerger"],function(e,a,n,t){"use strict";function r(e,a){e[a]=e[a]||{byId:{},variants:[],nonPersistedVariants:[],changes:[],defaultVariants:[],standardVariantChange:undefined,standardVariant:undefined};return e[a]}function i(e,a,n){n=n||[];var i=r(e,a);i.nonPersistedVariants.forEach(function(e){delete i.byId[e.getId()]});i.nonPersistedVariants=n.map(function(e){var n=Object.assign({id:e.id,persisted:false},e);n=t.createVariant(a,n);i.byId[e.id]=n;return n});return i}function s(t,i,s){var c=t[i].map(function(t){var r;if(i==="variants"){r=e.createCompVariant(t)}else{r=e.createFromFileContent(t,n)}r.setState(a.LifecycleState.PERSISTED);return r});c.forEach(function(e){var a=e.getPersistencyKey?e.getPersistencyKey():e.getSelector().persistencyKey;r(s,a).byId[e.getId()]=e;switch(i){case"standardVariants":r(s,a).standardVariantChange=e;break;default:r(s,a)[i].push(e)}})}return function(e){var a={};a._getOrCreate=r.bind(undefined,a);a._initialize=i.bind(undefined,a);if(e.storageResponse.changes.comp){["variants","changes","defaultVariants","standardVariants"].forEach(function(n){s(e.storageResponse.changes.comp,n,a)})}return a}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher",["sap/base/util/restricted/_pick","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/changes/Reverter"],function(e,n,r){"use strict";function t(r){var t=n.getControlChangesForVariant(Object.assign(e(r,["vmReference","variantsMap","reference"]),{vReference:r.currentVReference}));var a=n.getControlChangesForVariant(Object.assign(e(r,["vmReference","variantsMap","reference"]),{vReference:r.newVReference}));var i=Object.keys(r.changesMap).reduce(function(e,n){return e.concat(r.changesMap[n])},[]);var s=i.map(function(e){return e.getId()});var c=t.reduce(function(e,n){var r=s.indexOf(n.getId());if(r>-1){e=e.concat(i[r])}return e},[]);var o=[];if(a.length>0){o=c.slice();c.some(function(e){if(a[0]&&e.getId()===a[0].getId()){a.shift();o.shift()}else{return true}})}else{o=c}var l={changesToBeReverted:o.reverse(),changesToBeApplied:a};return l}var a={switchVariant:function(e){return Promise.resolve().then(function(){e.changesMap=e.flexController._oChangePersistence.getChangesMapForComponent().mChanges;e.variantsMap=n.getContent(e.reference);var a=t(e);return r.revertMultipleChanges(a.changesToBeReverted,e).then(e.flexController.applyVariantChanges.bind(e.flexController,a.changesToBeApplied,e.appComponent)).then(n.setCurrentVariant.bind(null,e))})}};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState",["sap/base/util/restricted/_omit","sap/base/util/restricted/_pick","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,a,r,i,c,o,f,s,u,g){"use strict";var l={};var v={};function d(e){var t=[];if(e.variantData.instance.getVariantReference()){t=l.getControlChangesForVariant(Object.assign(e,{vReference:e.variantData.instance.getVariantReference()}));return t.filter(function(t){return u.compareAgainstCurrentLayer(t.getLayer(),e.variantData.instance.getLayer())===-1})}return t}function p(e){var t=l.getContent(e.reference);var n=r.get([e.vmReference,"variants"],t);return n||[]}function C(e,t,n){var a=t.changeType;if(!e){e={}}if(!e[a]){e[a]=[]}if(n){e[a].push(t);return true}return e[a].some(function(n,r){if(n.fileName===t.fileName){e[a].splice(r,1);return true}})}function V(e,t){var n=m(e);t[n].push(e)}function h(e,t){var n=m(e);var a=-1;t[n].some(function(t,n){if(t.fileName===e.fileName){a=n;return true}});if(a>-1){t[n].splice(a,1)}}function m(e){switch(e.fileType){case"change":return"variantDependentControlChanges";case"ctrl_variant":return"variants";case"ctrl_variant_change":return"variantChanges";case"ctrl_variant_management_change":return"variantManagementChanges";default:}}l.addUpdateStateListener=function(e,t){v[e]=t};l.removeUpdateStateListener=function(e){delete v[e]};l.getContent=function(e){return s.getVariantsState(e)};l.addFakeStandardVariant=function(e,t,n){s.setFakeStandardVariant(e,t,n)};l.clearFakedStandardVariants=function(e,t){s.resetFakedStandardVariants(e,t)};l.getControlChangesForVariant=function(e){var t=[];var n=l.getVariant(e);if(n){t=n.controlChanges.filter(function(t){return e.includeDirtyChanges!==false||t.getState()===f.LifecycleState.PERSISTED})}return t};l.getVariantChangesForVariant=function(e){var t=l.getVariant(e);return t&&t.variantChanges||{}};l.getVariant=function(e){var t;var n=l.getContent(e.reference);e.vReference=e.vReference||n[e.vmReference].defaultVariant;var a=p(e);a.some(function(n){if(n.instance.getId()===e.vReference){t=n;return true}});return t};l.getCurrentVariantReference=function(e){var t=l.getContent(e.reference);var n=t[e.vmReference];return n.currentVariant||n.defaultVariant};l.getVariantManagementReferences=function(e){var t=l.getContent(e);return Object.keys(t)};l.addVariantToVariantManagement=function(e){var t=l.getContent(e.reference);var n=t[e.vmReference].variants.slice().splice(1);var a=o.getIndexToSortVariant(n,e.variantData);if(e.variantData.instance.getVariantReference()){var r=d(e);e.variantData.controlChanges=r.concat(e.variantData.controlChanges)}t[e.vmReference].variants.splice(a+1,0,e.variantData);return a+1};l.removeVariantFromVariantManagement=function(e){var t;var n=l.getContent(e.reference);var a=n[e.vmReference].variants.some(function(n,a){if(n.instance.getId()===e.variant.getId()){t=a;return true}});if(a){n[e.vmReference].variants.splice(t,1)}return t};l.setVariantData=function(e){var t=l.getContent(e.reference);var n=t[e.vmReference].variants;var a=n[e.previousIndex];if(a.instance.getId()!==e.vmReference){n.splice(e.previousIndex,1);var r=o.getIndexToSortVariant(n.slice(1),a);n.splice(r+1,0,a);return r+1}n.splice(e.previousIndex,1,a);return e.previousIndex};l.addChangeToVariant=function(e){var t=l.getControlChangesForVariant(e);var a=t.map(function(e){return e.getId()});if(!n(a,e.change.getId())){var r=l.getVariant(e);r.controlChanges=t.concat([e.change]);return true}return false};l.removeChangeFromVariant=function(e){var t=l.getControlChangesForVariant(e);var n=l.getVariant(e);var a=false;if(n){n.controlChanges=t.filter(function(t){if(!a&&t.getId()===e.change.getId()){a=true;return false}return true})}return a};l.getInitialChanges=function(e){var t=l.getContent(e.reference);return Object.keys(t).reduce(function(n,a){if(e.vmReference&&e.vmReference===a||!e.vmReference){var r=t[a].currentVariant?"currentVariant":"defaultVariant";var i=Object.assign({},e,{vmReference:a,vReference:t[a][r],includeDirtyChanges:false});return n.concat(l.getControlChangesForVariant(i))}return n},[])};l.fillVariantModel=function(e){var t=l.getContent(e.reference);return Object.keys(t).reduce(function(n,a){n[a]={defaultVariant:t[a].defaultVariant,variants:[]};if(t[a].currentVariant){n[a].currentVariant=t[a].currentVariant}p(Object.assign(e,{vmReference:a})).forEach(function(e,t){var r=e.instance;n[a].variants[t]=JSON.parse(JSON.stringify({key:r.getId(),title:r.getName(),layer:r.getLayer(),favorite:r.getFavorite(),executeOnSelect:r.getExecuteOnSelection(),visible:r.getVisible(),author:r.getSupportInformation().user,contexts:r.getContexts()}))});return n},{})};l.updateChangesForVariantManagementInMap=function(e){var t=l.getContent(e.reference);var n=t[e.vmReference];if(e.changeContent.fileType==="ctrl_variant_change"){n.variants.some(function(t){if(t.instance.getId()===e.changeContent.selector.id){C(t.variantChanges,e.changeContent,e.add)}})}else if(e.changeContent.fileType==="ctrl_variant_management_change"){C(n.variantManagementChanges,e.changeContent,e.add)}};l.setCurrentVariant=function(e){var t=l.getContent(e.reference);if(r.get([e.vmReference],t)){t[e.vmReference].currentVariant=e.newVReference}};l.updateVariantsState=function(e){var t=l.getContent(e.reference);if(a(t)){i.error("Variant state is not initialized yet");return}var n=s.getFlexObjectsFromStorageResponse(e.reference);if(e.changeToBeAddedOrDeleted){switch(e.changeToBeAddedOrDeleted.getState()){case f.LifecycleState.NEW:V(e.changeToBeAddedOrDeleted.convertToFileContent(),n);break;case f.LifecycleState.DELETE:h(e.changeToBeAddedOrDeleted.convertToFileContent(),n);break;default:}if(v[e.reference]){v[e.reference]()}}};l.waitForInitialVariantChanges=function(e){var t=l.getInitialChanges({vmReference:e.vmReference,reference:e.reference});var n=t.reduce(function(t,n){var a=n.getSelector();var r=c.bySelector(a,e.appComponent);if(r&&g.indexOfObject(t,{selector:r})===-1){t.push({selector:r})}return t},[]);return n.length?e.flexController.waitForChangesToBeApplied(n):Promise.resolve()};return l});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/flexState/controlVariants/prepareVariantsMap",["sap/base/util/each","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/util/values","sap/base/Log","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/LayerUtils","sap/ui/fl/registry/Settings"],function(e,n,t,a,r,i,s,c,o,f,u,l){"use strict";function g(e,n){var t=a({},e);n.forEach(function(e){t[e.fileName]={instance:o.createFromFileContent(e),controlChanges:[],variantChanges:{}}});return t}function v(e,n,t){var r=a({},e);n.forEach(function(e){var n=o.createFromFileContent(e);n.setState(f.LifecycleState.PERSISTED);var a=r[e.variantReference];a=a||x(e.variantReference,t);a.controlChanges.push(n);r[e.variantReference]=a});return r}function p(e,n,t){var r=a({},e);n.forEach(function(e){var n=r[e.selector.id];n=n||x(e.selector.id,t);var a=n.variantChanges[e.changeType]||[];a.push(e);n.variantChanges[e.changeType]=a;r[e.selector.id]=n});return r}function h(e){var n=a({},e);i(e).forEach(function(e){var t=r.get("variantChanges.setVisible",e);if(t&&t.length>0){var a=F(t);if(!a.getContent().visible&&a.getContent().createdByReset){delete n[e.instance.getId()]}}});return n}function C(e,n){var t=a({},e);i(t).forEach(function(e){var a=e.instance.getVariantReference();var r;if(a){r=b(t,a,e.instance.getVariantManagementReference(),n)}e.controlChanges=d(r,e.instance.getLayer()).concat(e.controlChanges)});return t}function d(e,n){if(!e){return[]}return i(a({},e.controlChanges)).filter(function(e){return u.compareAgainstCurrentLayer(e.getLayer(),n)===-1})}function b(e,n,t,a){var r=e[n];if(!r&&n===t){r=x(n,a);e[n]=r}return r}function m(e){var n=a({},e);i(n).forEach(function(e){var n=e.instance.getSupportInformation();if(!n.user){var t=l.getInstanceOrUndef()&&l.getInstanceOrUndef().getUserId();if(t){n.user=t;e.instance.setSupportInformation(n)}}});return n}function R(e,n){var t={};t=g(t,e.variants);t=v(t,e.variantDependentControlChanges,n);t=p(t,e.variantChanges,n);t=h(t);t=C(t,n);t=m(t);return t}function V(){return{variantManagementChanges:{},variants:[]}}function E(e,t,r){var s=a({},e);i(t).forEach(function(e){var t=e.instance.getVariantManagementReference();if(!s[t]){s[t]=V()}e=A(e);if(!s[t].currentVariant&&e.instance.getVisible()&&n(r,e.instance.getId())){s[t].currentVariant=e.instance.getId()}s[t].defaultVariant=t;var a=c.getIndexToSortVariant(s[t].variants,e);s[t].variants.splice(a,0,e)});return s}function y(e,n){var t=a({},e);n.forEach(function(e){var n=e.selector.id;if(!t[n]){t[n]=V()}var a=e.changeType;if(!t[n].variantManagementChanges[a]){t[n].variantManagementChanges[a]=[]}t[n].variantManagementChanges[a].push(e);t[n]=S(t[n])});return t}function T(n,t){var r=a({},n);e(r,function(e,n){var a=n.variants.findIndex(function(n){return n.instance.getId()===e});var r;if(a===-1){r=x(e,t)}else{r=n.variants[a];n.variants.splice(a,1)}n.variants.unshift(r)});return r}function I(e,n,t,a){var r={};r=E(r,e,t);r=y(r,n);r=T(r,a);return r}function x(e,n){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");return{instance:o.createFlVariant({id:e,variantManagementReference:e,variantName:t.getText("STANDARD_VARIANT_TITLE"),user:c.DEFAULT_AUTHOR,reference:n}),variantChanges:{},controlChanges:[]}}function S(e){var n=a({},e);var r=n.variantManagementChanges;var i;if(!t(r)){i=F(r["setDefault"]);if(i){n.defaultVariant=i.getContent().defaultVariant}}return n}function A(n){var t=a({},n);var r=t.variantChanges;var i;e(r,function(e,n){switch(e){case"setTitle":i=F(n);if(i){t.instance.setName(i.getText("title"),true)}break;case"setFavorite":i=F(n);if(i){t.instance.setFavorite(i.getContent().favorite)}break;case"setExecuteOnSelect":i=F(n);if(i){t.instance.setExecuteOnSelection(i.getContent().executeOnSelect)}break;case"setVisible":i=F(n);if(i){t.instance.setVisible(i.getContent().visible)}break;case"setContexts":i=F(n);if(i){t.instance.setContexts(i.getContent().contexts)}break;default:s.error("No valid changes on variant "+t.content.content.title+" available")}});return t}function F(e){if(e.length>0){return o.createFromFileContent(e[e.length-1])}return false}return function(e){if(t(e)||!r.get("storageResponse.changes.variants",e)){return{}}var n=r.get(["technicalParameters",c.VARIANT_TECHNICAL_PARAMETER],e.componentData)||[];var a=R(e.storageResponse.changes,e.reference);a=I(a,e.storageResponse.changes.variantManagementChanges,n,e.reference);return a}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/preprocessors/ControllerExtension",["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/Utils","sap/base/Log"],function(e,n,r,t,o){"use strict";var i=function(){};function s(e){return e.getChangeType()==="codeExt"}function a(e,n){var r=n.getSelector().controllerName;return e===r}function u(e){if(e.length===0){return Promise.resolve([])}return new Promise(function(n){sap.ui.require(e,function(){n(Array.prototype.slice.call(arguments))},function(e){o.error("Code Extension not found",e.message);n([])})})}i.prototype.getControllerExtensions=function(i,p,l){if(l){if(!p){o.warning("No component ID for determining the anchor of the code extensions was passed.");return Promise.resolve([])}var c=e.get(p);var f=t.getAppComponentForControl(c);if(!f){o.warning("No application component for determining the anchor of the code extensions was identified.");return Promise.resolve([])}if(!t.isApplication(f.getManifestObject())){return Promise.resolve([])}var g=n.getFlexReferenceForControl(f);var m=r.getChangePersistenceForComponent(g);return m.getChangesForComponent().then(function(e){var n=e.filter(function(e){return s(e)&&a(i,e)}).map(function(e){return e.getModuleName()});return u(n)})}o.warning("Synchronous extensions are not supported via UI5 Flexibility");return[]};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/preprocessors/EventHistory",["sap/ui/core/Core"],function(e){"use strict";var n=function(){};n._aEventIds=["ControlForPersonalizationRendered"];n._aUnsubscribedEventIds=[];n._oHistory={};n.start=function(){n._aEventIds.forEach(function(s){if(n._aUnsubscribedEventIds.indexOf(s)===-1){e.getEventBus().subscribe("sap.ui",s,n.saveEvent);n._oHistory[s]=[]}})};n.saveEvent=function(e,s,t){var r={channelId:e,eventId:s,parameters:t.getId()};if(n._oHistory[s]){var i=n._oHistory[s].some(function(e){return e.channelId===r.channelId&&e.eventId===r.eventId&&e.parameters===r.parameters});if(!i){n._oHistory[s].push(r)}}};n.getHistoryAndStop=function(s){e.getEventBus().unsubscribe("sap.ui",s,n.saveEvent);n._addUnsubscribedEvent(s);return n._oHistory[s]||[]};n._addUnsubscribedEvent=function(e){if(n._aUnsubscribedEventIds.indexOf(e)===-1){n._aUnsubscribedEventIds.push(e)}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/preprocessors/RegistrationDelegator",["sap/ui/core/mvc/Controller","sap/ui/core/mvc/XMLView","sap/ui/core/Component","sap/ui/core/ExtensionPoint","sap/ui/fl/apply/_internal/changes/descriptor/Preprocessor","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/_internal/preprocessors/EventHistory","sap/ui/fl/apply/_internal/DelegateMediator","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/FlexControllerFactory","sap/ui/core/Configuration","sap/ui/fl/apply/_internal/preprocessors/ControllerExtension","sap/ui/fl/apply/_internal/preprocessors/XmlPreprocessor"],function(e,n,r,i,t,a,s,o,l,p,f,u,c){"use strict";var d={};function g(){r._fnOnInstanceCreated=u.getChangesAndPropagate}function P(){p.registerPredefinedChangeHandlers();p.getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs()}function y(){r._fnLoadComponentCallback=f._onLoadComponent.bind(f)}function _(){e.registerExtensionProvider("sap/ui/fl/apply/_internal/preprocessors/ControllerExtension")}function C(){if(n.registerPreprocessor){n.registerPreprocessor("viewxml","sap.ui.fl.apply._internal.preprocessors.XmlPreprocessor",true)}}function x(){s.start()}function m(){r._fnPreprocessManifest=t.preprocessManifest}function D(e){if(a.isFlexExtensionPointHandlingEnabled(e)){return"sap/ui/fl/apply/_internal/extensionPoint/Processor"}if(c.getDesignMode()){return"sap/ui/fl/write/_internal/extensionPoint/Processor"}return undefined}function E(){i.registerExtensionProvider(D)}function v(){l.registerDefaultDelegate({modelType:"sap.ui.model.odata.v4.ODataModel",delegate:"sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate",delegateType:o.types.READONLY})}d.registerAll=function(){x();P();y();_();g();C();m();E();v()};return d});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/_internal/preprocessors/XmlPreprocessor",["sap/ui/core/Component","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Utils","sap/ui/fl/ChangePersistenceFactory","sap/base/Log"],function(e,r,n,t,o,i){"use strict";var s=function(){};s.process=function(o,s){try{if(!s||s.sync){i.warning("Flexibility feature for applying changes on an XML view is only available for "+"asynchronous views; merge is be done later on the JS controls.");return o}s.viewId=s.id;var a=e.get(s.componentId);if(!a){i.warning("View is generated without a component. Flexibility features are not possible.");return Promise.resolve(o)}var l=t.getAppComponentForControl(a);if(!t.isApplication(l.getManifestObject())){return Promise.resolve(o)}var p=r.getFlexReferenceForControl(l);var c=n.create(p);return c.processXmlView(o,s).then(function(){i.debug("flex processing view "+s.id+" finished");return o}).catch(function(){i.warning("Error happens when getting flex cache key! flexibility XML view preprocessing is skipped. "+"The processing will be done later on the JS controls.");return Promise.resolve(o)})}catch(e){var u="view "+s.id+": "+e;i.info(u);return Promise.resolve(o)}};s.getCacheKey=function(n){var i=e.get(n.componentId);var s=t.getAppComponentForControl(i);if(t.isVariantByStartupParameter(s)){return Promise.resolve()}var a=r.getFlexReferenceForControl(s);var l=o.getChangePersistenceForComponent(a);return l.getCacheKey(s)};return s},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/api/ControlVariantApplyAPI",["sap/base/Log","sap/ui/core/Component","sap/ui/core/Core","sap/ui/core/Element","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/Utils"],function(e,r,t,a,n,o){"use strict";var i="$FlexVariants";var l={getVariantModelName:function(){return i},clearVariantParameterInURL:function(r){var t;var a=o.getAppComponentForControl(r.control);var l=a&&a.getModel(i);if(!l){e.error("Variant model could not be found on the provided control");return}if(r.control.isA("sap.ui.fl.variants.VariantManagement")){var c=l.getLocalId(r.control.getId(),a);var p=n.removeURLParameterForVariantManagement({model:l,vmReference:c});t=p.parameters}n.update({parameters:t||[],updateURL:true,updateHashEntry:!!l,model:l||{},silent:!l})},activateVariant:function(n){function l(r){e.error(r);return Promise.reject(r)}var c;if(typeof n.element==="string"){c=r.get(n.element);if(!(c instanceof r)){c=t.byId(n.element);if(!(c instanceof a)){return l(Error("No valid component or control found for the provided ID"))}}}else if(n.element instanceof r||n.element instanceof a){c=n.element}var p=o.getAppComponentForControl(c);if(!p){return l(Error("A valid variant management control or component (instance or ID) should be passed as parameter"))}var d=p.getModel(i);if(!d){return l(Error("No variant management model found for the passed control or application component"))}var m=d.getVariantManagementReference(n.variantReference).variantManagementReference;if(!m){return l(Error("A valid control or component, and a valid variant/ID combination are required"))}return d.waitForVMControlInit(m).then(function(){return d.updateCurrentVariant({variantManagementReference:m,newVariantReference:n.variantReference,appComponent:p})}).catch(function(r){e.error(r);throw r})},attachVariantApplied:function(e){var r=e.selector.id&&sap.ui.getCore().byId(e.selector.id)||e.selector;var t=o.getAppComponentForControl(r);var a=t.getModel(i);a.attachVariantApplied({vmControlId:e.vmControlId,control:r,callback:e.callback,callAfterInitialVariant:e.callAfterInitialVariant})},detachVariantApplied:function(e){var r=e.selector.id&&sap.ui.getCore().byId(e.selector.id)||e.selector;var t=o.getAppComponentForControl(r);var a=t.getModel(i);a.detachVariantApplied(e.vmControlId,r.getId())}};return l});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/api/DelegateMediatorAPI",["sap/ui/fl/apply/_internal/DelegateMediator"],function(e){"use strict";var t={registerDefaultDelegate:function(t){e.registerDefaultDelegate(t)},getDelegateForControl:function(t){return e.getDelegateForControl(t.control,t.modifier,t.modelType,t.supportsDefault)},getKnownDefaultDelegateLibraries:function(){return e.getKnownDefaultDelegateLibraries()},getRequiredLibrariesForDefaultDelegate:function(t){return e.getRequiredLibrariesForDefaultDelegate(t.delegateName,t.control,t.modelType)}};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/apply/api/FlexRuntimeInfoAPI",["sap/base/util/includes","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/ManifestUtils","sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/FlexControllerFactory","sap/ui/fl/Layer","sap/ui/fl/Utils"],function(e,t,r,n,o,l,a,i,s){"use strict";var c={isPersonalized:function(n){function o(e){t.error(e);return Promise.reject(e)}function l(e){return e.getFileType()==="change"}function c(t,n,o){var l=n.map(function(e){return e.id||e.getId()});var a=o.getSelector();var i=r.getControlIdBySelector(a,t);return e(l,i)}function p(t,r){return Array.isArray(t)&&t.length>0?e(t,r.getChangeType()):true}if(!n.selectors||n.selectors.length===0){return o("At least one control ID has to be provided as a parameter")}var u=n.selectors[0].appComponent||s.getAppComponentForControl(n.selectors[0]);if(!u){return o("App Component could not be determined")}var f=a.createForControl(u);return f.getComponentChanges({currentLayer:i.USER,includeCtrlVariants:true}).then(function(e){return e.filter(c.bind(this,u,n.selectors)).filter(p.bind(this,n.changeTypes)).some(l)}.bind(this))},waitForChanges:function(e){var t;var r;if(e.element){t=[{selector:e.element}];r=e.element}else if(e.selectors){t=e.selectors.map(function(e){return{selector:e}});r=e.selectors[0]}else if(e.complexSelectors){t=e.complexSelectors;r=e.complexSelectors[0].selector}return l.getFlexControllerInstance(r).waitForChangesToBeApplied(t)},isFlexSupported:function(e){return!!s.getAppComponentForControl(e.element)},hasVariantManagement:function(e){return n.belongsToVariantManagement(e.element)},getFlexReference:function(e){return o.getFlexReferenceForControl(e.element)}};return c});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddIFrame",["sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/changeHandler/common/getTargetAggregationIndex","sap/ui/fl/changeHandler/common/createIFrame","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,n,r){"use strict";var a={};a.applyChange=function(e,r,a){var o=a.modifier;var i=e.getContent();var g=a.view;var c=i.targetAggregation;var s;var f;return Promise.resolve().then(o.findAggregation.bind(o,r,c)).then(function(n){if(!n){throw new Error("The given Aggregation is not available in the given control: "+o.getId(r))}return t(e,r,a)}).then(function(t){s=t;return n(e,a,i.selector)}).then(function(e){f=e;return o.insertAggregation(r,c,f,s,g)}).then(function(){e.setRevertData([o.getId(f)])})};a.revertChange=e;a.completeChangeContent=function(e,t,n){var r=n.modifier;var a=n.appComponent;["targetAggregation","baseId","url"].forEach(function(e){if(!Object.prototype.hasOwnProperty.call(t.content,e)){throw new Error("Attribute missing from the change specific content '"+e+"'")}});var o=Object.assign({},t.content);o.selector=r.getSelector(o.baseId,a);e.setContent(o)};a.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().selector]}};a.getCondenserInfo=function(e){var t=e.getContent();return{classification:r.Create,uniqueKey:"iFrame",affectedControl:t.selector,targetContainer:e.getSelector(),targetAggregation:t.targetAggregation,setTargetIndex:function(e,t){e.getContent().index=t},getTargetIndex:function(e){return e.getContent().index},update:function(e,t){Object.assign(e.getContent(),t)}}};return a},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddXML",["sap/ui/fl/changeHandler/BaseAddXml"],function(e){"use strict";var t={};t.applyChange=function(t,n,r){var g=t.getContent();var a={aggregationName:g.targetAggregation,index:g.index};return e.applyChange(t,n,r,a)};t.revertChange=e.revertChange;t.completeChangeContent=function(t,n){var r={};if(n.targetAggregation){r.targetAggregation=n.targetAggregation}else{e._throwMissingAttributeError("targetAggregation")}if(n.index!==undefined){r.index=n.index}else{e._throwMissingAttributeError("index")}e.completeChangeContent(t,n,r)};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/AddXMLAtExtensionPoint",["sap/ui/fl/changeHandler/BaseAddXml"],function(e){"use strict";var n={};function t(e){var n=e.index;if(e.referencedExtensionPoint){n+=t(e.referencedExtensionPoint)}return n}n.applyChange=function(n,i,r){var o=r.view;var a=r.modifier;var u=n.getSelector();var f;return Promise.resolve().then(function(){var e=n.getExtensionPointInfo&&n.getExtensionPointInfo();if(!e){return a.getExtensionPointInfo(u.name,o)}return e}).then(function(s){f=s;if(!f){throw new Error("AddXMLAtExtensionPoint-Error: Either no Extension-Point found by name '"+(u&&u.name)+"' or multiple Extension-Points available with the given name in the view (view.id='"+(o&&a.getId(o))+"'). Multiple Extension-points with the same name in one view are not supported!")}(f.defaultContent||[]).forEach(function(e){if(e){a.destroy(e)}});f.defaultContent=[];f.index=t(f);if(a.targets==="xmlTree"){f.skipAdjustIndex=true}return e.applyChange(n,i,r,f)}).then(function(e){if(f.ready){f.ready(e)}return true})};n.revertChange=e.revertChange;n.completeChangeContent=function(n,t){e.completeChangeContent(n,t)};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/Base",["sap/base/util/LoaderExtensions"],function(e){"use strict";var t={setTextInChange:function(e,t,n,r){if(!e.texts){e.texts={}}if(!e.texts[t]){e.texts[t]={}}e.texts[t].value=n;e.texts[t].type=r},instantiateFragment:function(t,n){var r=t.getFlexObjectMetadata();var a=r.moduleName;if(!a){return Promise.reject(new Error("The module name of the fragment is not set. This should happen in the backend"))}var i=n.viewId?n.viewId+"--":"";var o=r.projectId||"";var s=t.getExtensionPointInfo&&t.getExtensionPointInfo()&&t.getExtensionPointInfo().fragmentId||"";var u=o&&s?".":"";var f=i+o+u+s;var c=n.modifier;var d=n.view;return Promise.resolve().then(function(){var t=e.loadResource(a,{dataType:"text"});return c.instantiateFragment(t,f,d).catch(function(e){throw new Error("The following XML Fragment could not be instantiated: "+t+" Reason: "+e.message)})})},markAsNotApplicable:function(e,t){var n={message:e};if(!t){throw n}return Promise.reject(n)}};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseAddViaDelegate",["sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/base/util/merge","sap/base/util/ObjectPath"],function(e,t,n,r,o){"use strict";function a(e){return typeof e==="function"}function i(e){if(e.modelType){return e.modelType}else if(e.oDataServiceVersion){return"sap.ui.model.odata.v2.ODataModel"}}var l={createAddViaDelegateChangeHandler:function(l){function d(e){return e+l.fieldSuffix}function u(e,t){if(a(l[t])){return!!l[t](e)}return!!l[t]}function f(e){return u(e,"skipCreateLabel")}function c(e){return u(e,"skipCreateLayout")}function p(e,t){var r=t.modifier.bySelector(e.getSelector(),t.appComponent);var o=i(e.getContent());return n.getDelegateForControl({control:r,modifier:t.modifier,modelType:o,supportsDefault:l.supportsDefault}).then(function(t){var n=!a(t.instance.createLayout);return n||c(e.getSupportInformation().oDataInformation)})}function g(e,t,n){var o=r({},t);o.fieldSelector.id=d(o.fieldSelector.id);return n.createControlForProperty(o).then(function(r){if(f(e)){return r}var o=t.modifier.getId(r.control);t.labelFor=o;return n.createLabel(t).then(function(e){return{label:e,control:r.control,valueHelp:r.valueHelp}})})}function s(e,t,n,i){var d=r({aggregationName:l.aggregationName,payload:t.payload||{},parentSelector:e.parentId},n);var u=t.instance;return Promise.resolve().then(function(){if(a(u.createLayout)&&!c(i)){return u.createLayout(d)}}).then(function(e){if(o.get("control",e)){e.layoutControl=true;return e}return g(i,d,u)})}return{applyChange:function(e,o,a){var d=a.appComponent;var u=e.getContent();var f=e.getSupportInformation().oDataInformation;var c=u.newFieldSelector;var p={appComponent:a.appComponent,view:a.view,fieldSelector:c,bindingPath:u.bindingPath,modifier:a.modifier,element:o};if(a.modifier.bySelector(c,d,a.view)){return t.markAsNotApplicable("Control to be created already exists:"+(c.id||c),true)}var g={newFieldSelector:c};e.setRevertData(g);var v=i(u);return n.getDelegateForControl({control:o,modifier:a.modifier,modelType:v,supportsDefault:l.supportsDefault}).then(function(e){return s(u,e,p,f)}).then(function(t){var n=r({},{control:o,innerControls:t,change:e},a);return Promise.resolve().then(function(){return l.addProperty(n)}).then(function(){if(t.valueHelp){var n=a.modifier.getSelector(a.modifier.getId(t.valueHelp),d);var r=e.getRevertData();r.valueHelpSelector=n;e.setRevertData(r)}})})},revertChange:function(e,t,n){var o=n.appComponent;var i=n.modifier;var d=e.getRevertData().newFieldSelector;var u=e.getRevertData().valueHelpSelector;var f=i.bySelector(d,o);var c=e.getDependentControl(l.parentAlias,n)||t;return Promise.resolve().then(i.removeAggregation.bind(i,c,l.aggregationName,f)).then(i.destroy.bind(i,f)).then(function(){if(u){var e=i.bySelector(u,o);return Promise.resolve().then(i.removeAggregation.bind(i,c,"dependents",e)).then(i.destroy.bind(i,e))}}).then(function(){var o=r({},{control:t,change:e},n);if(a(l.revertAdditionalControls)){return Promise.resolve().then(function(){return l.revertAdditionalControls(o)}).then(function(){e.resetRevertData()})}})},completeChangeContent:function(e,t,n){var r=n.appComponent;var o={};if(t.parentId){if(a(l.mapParentIdIntoChange)){l.mapParentIdIntoChange(e,t,n)}else{e.addDependentControl(t.parentId,l.parentAlias,n)}try{o.parentId=n.modifier.getSelector(t.parentId,r)}catch(e){}}else{throw new Error("mSpecificChangeInfo.parentId attribute required")}if(t.bindingPath){o.bindingPath=t.bindingPath}else{throw new Error("mSpecificChangeInfo.bindingPath attribute required")}if(t.newControlId){o.newFieldSelector=n.modifier.getSelector(t.newControlId,r)}else{throw new Error("mSpecificChangeInfo.newControlId attribute required")}if(t.index===undefined){throw new Error("mSpecificChangeInfo.targetIndex attribute required")}else{o.newFieldIndex=t.index}if(t.oDataServiceVersion){o.oDataServiceVersion=t.oDataServiceVersion}if(t.modelType&&l.supportsDefault){o.modelType=t.modelType}e.setContent(o)},getChangeVisualizationInfo:function(e){var t=e.getRevertData();if(t&&t.labelSelector){return{affectedControls:[t.labelSelector]}}return{affectedControls:[e.getContent().newFieldSelector]}},getCondenserInfo:function(t,n){return p(t,n).then(function(n){if(!n){return undefined}if(!t.getContent().newFieldSelector||!t.getContent().parentId||!l.aggregationName){return undefined}return{affectedControl:t.getContent().newFieldSelector,classification:e.Create,targetContainer:t.getContent().parentId,targetAggregation:l.aggregationName,setTargetIndex:function(e,t){var n=e.getContent();n.newFieldIndex=t;e.setContent(n)},getTargetIndex:function(e){return e.getContent().newFieldIndex}}})}}}};return l});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseAddXml",["sap/ui/fl/changeHandler/Base","sap/base/util/LoaderExtensions","sap/ui/fl/changeHandler/common/revertAddedControls","sap/ui/fl/Utils"],function(e,t,r,n){"use strict";var a={};a.applyChange=function(r,o,i,u){var s=i.modifier;var c=i.view;var g=u.aggregationName;var f;var h=u.index;var l=[];var d=r.getFlexObjectMetadata().moduleName;var m;var v;var p=function(){var e=[];v.forEach(function(t,r){var n=function(){return Promise.resolve().then(s.insertAggregation.bind(s,o,g,t,h+r,c,u.skipAdjustIndex)).then(function(){l.push({id:s.getId(t),aggregationName:g})})};e.push(n)});return n.execPromiseQueueSequentially(e,true,true).then(function(){r.setRevertData(l);return v})};return Promise.resolve().then(s.findAggregation.bind(s,o,g)).then(function(e){f=e;if(!f){return Promise.reject(new Error("The given Aggregation is not available in the given control: "+s.getId(o)))}return t.loadResource(d,{dataType:"text"})}).then(function(t){m=t;return e.instantiateFragment(r,i)}).then(function(e){v=e;var t=[];v.forEach(function(e,r){var n=function(){return Promise.resolve().then(s.validateType.bind(s,e,f,o,m,r)).then(function(e){if(!e){a._destroyArrayOfControls(v);return Promise.reject(new Error("The content of the xml fragment does not match the type of the targetAggregation: "+f.type))}})};t.push(n)});return n.execPromiseQueueSequentially(t,true,true).then(p)})};a.revertChange=r;a._throwMissingAttributeError=function(e){throw new Error("Attribute missing from the change specific content '"+e+"'")};a._destroyArrayOfControls=function(e){e.forEach(function(e){if(e.destroy){e.destroy()}})};a.completeChangeContent=function(e,t,r){r=r||{};if(t.fragmentPath){r.fragmentPath=t.fragmentPath}else{a._throwMissingAttributeError("fragmentPath")}e.setContent(r);var n=e.getFlexObjectMetadata().reference.replace(/\.Component/g,"").replace(/\./g,"/");n+="/changes/";n+=r.fragmentPath;var o=e.getFlexObjectMetadata();o.moduleName=n;e.setFlexObjectMetadata(o)};return a},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseRename",["sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification"],function(e,r){"use strict";var t={createRenameChangeHandler:function(t){t.changePropertyName=t.changePropertyName||"newText";return{applyChange:function(e,r,n){var a=n.modifier;var o=t.propertyName;var i=e.getText(t.changePropertyName);return Promise.resolve().then(function(){if(i){return a.getPropertyBindingOrProperty(r,o).then(function(t){e.setRevertData(t);return a.setPropertyBindingOrProperty(r,o,i)})}return undefined})},revertChange:function(r,n,a){var o=a.modifier;var i=t.propertyName;var u=r.getRevertData();if(u||u===""){o.setPropertyBindingOrProperty(n,i,u);r.resetRevertData();return}e.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.")},completeChangeContent:function(e,r,n){var a=t.changePropertyName;var o=t.translationTextType;return Promise.resolve().then(function(){return n.modifier.bySelector(e.getSelector(),n.appComponent)}).then(function(t){e.setContent({originalControlType:n.modifier.getControlType(t)});if(typeof r.value==="string"){e.setText(a,r.value,o)}else{return Promise.reject(new Error("oSpecificChangeInfo.value attribute required"))}})},getCondenserInfo:function(e){return{affectedControl:e.getSelector(),classification:r.LastOneWins,uniqueKey:t.propertyName||t.changePropertyName}},getChangeVisualizationInfo:function(e){var r=e.getTexts()&&e.getTexts()[t.changePropertyName];return{descriptionPayload:{originalLabel:e.getRevertData(),newLabel:r&&r.value}}}}}};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/BaseTreeModifier",["sap/ui/core/util/reflection/BaseTreeModifier"],function(e){"use strict";return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/HideControl",["sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/changeHandler/JsControlTreeModifier"],function(e,t,n){"use strict";var r="visible";var i={};i.applyChange=function(e,t,n){var r=n.modifier;return Promise.resolve().then(r.getVisible.bind(r,t)).then(function(n){e.setRevertData({originalValue:n});r.setVisible(t,false)})};i.revertChange=function(t,n,r){var i=t.getRevertData();return Promise.resolve().then(function(){if(i){r.modifier.setVisible(n,i.originalValue);t.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}})};i.completeChangeContent=function(){};i.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:t.Reverse,uniqueKey:r}};i.getChangeVisualizationInfo=function(e,t){var r=e.getSelector();var i=n.bySelector(r,t);return{affectedControls:[r],displayControls:[i.getParent().getId()]}};return i},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/JsControlTreeModifier",["sap/ui/core/util/reflection/JsControlTreeModifier"],function(e){"use strict";return e},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/MoveControls",["sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/Utils"],function(e,r,t){"use strict";var n={};n.SOURCE_ALIAS="source";n.TARGET_ALIAS="target";n.MOVED_ELEMENTS_ALIAS="movedElements";function o(e,r,t,n){if(!e){return Promise.reject(new Error("No change instance"))}var o=e.getContent();if(!o||!o.movedElements||o.movedElements.length===0){return Promise.reject(new Error("Change format invalid"))}if(!o.source||!o.source.selector){return Promise.reject(new Error("No source supplied for move"))}if(!o.target||!o.target.selector){return Promise.reject(new Error("No target supplied for move"))}if(!r.bySelector(o.source.selector,n,t)){return Promise.reject(new Error("Move source parent not found"))}if(!r.bySelector(o.target.selector,n,t)){return Promise.reject(new Error("Move target parent not found"))}if(!o.source.selector.aggregation){return Promise.reject(new Error("No source aggregation supplied for move"))}if(!o.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"))}return Promise.resolve()}function a(e,r,t,n){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"))}if(typeof e.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+e.selector.id+"' in movedElements supplied"))}return Promise.resolve().then(r.bySelector.bind(r,e.selector||e.id,t,n)).then(function(r){if(!r){return Promise.reject(new Error("Control to move was not found. Id: '"+e.selector.id+"'"))}return r})}function i(e){if(!e.movedElements){return Promise.reject(new Error("mSpecificChangeInfo.movedElements attribute required"))}if(e.movedElements.length===0){return Promise.reject(new Error("MovedElements array is empty"))}e.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedControls element has no id attribute")}if(typeof e.sourceIndex!=="number"){throw new Error("SourceIndex attribute at MovedElements element is no number")}if(typeof e.targetIndex!=="number"){throw new Error("TargetIndex attribute at MovedElements element is no number")}});return Promise.resolve()}function s(e,r,t){delete r.source.publicAggregation;delete r.target.publicAggregation;var n;var o;return Promise.resolve().then(function(){return r.source.parent||e.bySelector(r.source.id,t)}).then(function(o){n=o;return r.target.parent||e.bySelector(r.target.id,t)}).then(function(a){o=a;var i=r.source.aggregation;var s=r.target.aggregation;var g={aggregation:r.source.aggregation,type:e.getControlType(n)};var u={aggregation:r.target.aggregation,type:e.getControlType(o)};var c={source:{id:n.getId(),aggregation:i,type:g.type,selector:e.getSelector(r.source.id,t,g)},target:{id:o.getId(),aggregation:s,type:u.type,selector:e.getSelector(r.target.id,t,u)},movedElements:r.movedElements};return c})}n.applyChange=function(e,r,n){var i=n.modifier;var s=n.view;var g=n.appComponent;var u;var c;var l;var d;var m;var v;var f;var h=false;var E=e.getContent();var p=[];var C=[];return o(e,i,s,g).then(function(){E.movedElements.forEach(function(e){var r=function(){return Promise.resolve().then(a.bind(null,e,i,g,s)).then(function(e){u=e;c=i.getParent(u);return n.sourceAggregation||i.getParentAggregationName(u,c)}).then(function(e){d=e;return i.bySelector(E.target.selector,g,s)}).then(function(e){l=e;m=n.targetAggregation||E.target.selector.aggregation;return i.findIndexInParentAggregation(u)}).then(function(r){v=r;f=e.targetIndex;if(v>-1){if(v===f&&d===m&&i.getParent(u)===l){v=e.sourceIndex;d=n.sourceAggregation||E.source.selector.aggregation;h=true;return i.bySelector(E.source.selector,g,s)}}return Promise.resolve()}).then(function(e){if(e){c=e}if(v>-1){p.unshift({index:v,aggregation:d,sourceParent:i.getSelector(c,g)})}if(!h){return Promise.resolve().then(i.removeAggregation.bind(i,c,d,u)).then(i.insertAggregation.bind(i,l,m,u,f,s))}return Promise.resolve()})};C.push(r)},this);return t.execPromiseQueueSequentially(C,true,true)}.bind(this)).then(function(){e.setRevertData(p)})};n.revertChange=function(r,n,i){var s=i.modifier;var g=i.view;var u=i.appComponent;var c=r.getContent();var l;var d;var m;var v;var f;var h;return o(r,s,g,u).then(s.bySelector.bind(s,c.source.selector,u,g)).then(function(e){l=e;m=c.source.selector.aggregation;v=c.target.selector.aggregation;return s.bySelector(c.target.selector,u,g)}).then(function(n){d=n;var o=r.getRevertData();c.movedElements.reverse();var i=[];c.movedElements.forEach(function(r,t){var n=function(){return Promise.resolve().then(a.bind(this,r,s,u,g)).then(function(n){f=n;if(!f){e.warning("Element to move not found");return Promise.reject()}h=r.sourceIndex;if(o){var a=o[t];m=a.aggregation;h=a.index;return s.bySelector(a.sourceParent,u,g)}return Promise.resolve()}).then(function(e){if(e){l=e}return s.removeAggregation(d,v,f)}).then(function(){return s.insertAggregation(l,m,f,h,g)})}.bind(this);i.push(n)},this);return t.execPromiseQueueSequentially(i,true,true)}.bind(this)).then(function(){r.resetRevertData()})};n.completeChangeContent=function(e,r,t){var o=t.modifier;var a=t.appComponent;return i(r).then(s.bind(this,o,r,a)).then(function(r){var i={movedElements:[],source:{selector:r.source.selector},target:{selector:r.target.selector}};var s=[];r.movedElements.forEach(function(g){var u=Promise.resolve().then(function(){return g.element||o.bySelector(g.id,a)}).then(function(s){i.movedElements.push({selector:o.getSelector(s,a),sourceIndex:g.sourceIndex,targetIndex:g.targetIndex});e.addDependentControl(r.source.id,n.SOURCE_ALIAS,t);e.addDependentControl(r.target.id,n.TARGET_ALIAS,t);e.addDependentControl(r.movedElements.map(function(e){return e.id}),n.MOVED_ELEMENTS_ALIAS,t)});s.push(u)});return Promise.all(s).then(function(){e.setContent(i)})})};n.getCondenserInfo=function(e){var t=e.getContent();var n=e.getRevertData()[0];return{affectedControl:t.movedElements[0].selector,classification:r.Move,sourceContainer:n.sourceParent,targetContainer:t.target.selector,sourceIndex:n.index,sourceAggregation:n.aggregation,targetAggregation:t.target.selector.aggregation,setTargetIndex:function(e,r){var t=e.getContent();t.movedElements[0].targetIndex=r;e.setContent(t)},getTargetIndex:function(e){return e.getContent().movedElements[0].targetIndex}}};n.getChangeVisualizationInfo=function(e){var r=e.getContent();var t=e.getRevertData()[0];return{affectedControls:[r.movedElements[0].selector],dependentControls:[r.source.selector],descriptionPayload:{sourceContainer:t.sourceParent,targetContainer:r.target.selector}}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/MoveElements",["sap/base/Log","sap/ui/fl/Utils"],function(e,r){"use strict";var t={};t.CHANGE_TYPE="moveElements";function n(e,r,t,n){if(!e){return Promise.reject(new Error("No change instance"))}var o=e.getContent();if(!o||!o.movedElements||o.movedElements.length===0){return Promise.reject(new Error("Change format invalid"))}if(!e.getSelector().aggregation){return Promise.reject(new Error("No source aggregation supplied via selector for move"))}if(!o.target||!o.target.selector){return Promise.reject(new Error("No target supplied for move"))}if(!r.bySelector(o.target.selector,n,t)){return Promise.reject(new Error("Move target parent not found"))}if(!o.target.selector.aggregation){return Promise.reject(new Error("No target aggregation supplied for move"))}return Promise.resolve()}function o(e,r,t,n){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveElements element has no id attribute"))}if(typeof e.targetIndex!=="number"){return Promise.reject(new Error("Missing targetIndex for element with id '"+e.selector.id+"' in movedElements supplied"))}return Promise.resolve().then(function(){return r.bySelector(e.selector||e.id,t,n)})}function i(r,t,n,i,a,g,s,u){var c;return o(r,t,n,i).then(function(n){c=n;if(!c){e.warning("Element to move not found");return Promise.reject()}return Promise.resolve().then(t.removeAggregation.bind(t,a,s,c)).then(t.insertAggregation.bind(t,g,u,c,r.targetIndex,i))})}t.applyChange=function(e,t,o){var a=o.modifier;var g=o.view;var s=o.appComponent;var u=e.getContent();var c;var l;var m;return n(e,a,g,s).then(function(){c=e.getSelector().aggregation;l=u.target.selector.aggregation;return a.bySelector(u.target.selector,s,g)}).then(function(e){m=e;var n=[];u.movedElements.forEach(function(e){n.push(i.bind(null,e,a,s,g,t,m,c,l))});return r.execPromiseQueueSequentially(n,true,true)})};t.completeChangeContent=function(){throw new Error("Using deprecated change handler. Please consider using 'MoveControls' instead")};t.getSpecificChangeInfo=function(e,r){var t=r.source.parent||e.bySelector(r.source.id);var n=r.target.parent||e.bySelector(r.target.id);var o=r.source.aggregation;var i=r.target.aggregation;var a={source:{id:t.getId(),aggregation:o,type:e.getControlType(t)},target:{id:n.getId(),aggregation:i,type:e.getControlType(n)},movedElements:r.movedElements};return a};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/PropertyBindingChange",["sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t){"use strict";var n={};n.applyChange=function(e,t,n){var r=e.getContent();var i=r.property;var a=r.newBinding;var o=n.modifier;return Promise.resolve().then(o.getPropertyBindingOrProperty.bind(o,t,i)).then(function(n){e.setRevertData({originalValue:n});o.setPropertyBinding(t,i,a)})};n.revertChange=function(t,n,r){var i=t.getRevertData();if(i){var a=t.getContent();var o=a.property;var p=i.originalValue;var g=r.modifier;g.setPropertyBindingOrProperty(n,o,p);t.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}};n.completeChangeContent=function(e,t){if(!t.content){throw new Error("oSpecificChangeInfo attribute required")}e.setContent(t.content)};n.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:t.LastOneWins,uniqueKey:e.getContent().property}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/PropertyChange",["sap/ui/fl/Utils","sap/ui/fl/changeHandler/condenser/Classification","sap/base/Log","sap/base/util/isPlainObject"],function(e,t,n,r){"use strict";var a={};function i(t){return e.isBinding(t)||r(t)}function o(e,t,n,r){try{if(i(n)){r.setPropertyBinding(e,t,n)}else{r.setProperty(e,t,n)}}catch(e){throw new Error("Applying property changes failed: "+e)}}a.applyChange=function(e,t,n){var r=e.getContent();var a=r.property;var i=r.newValue;var s=n.modifier;return Promise.resolve().then(s.getPropertyBindingOrProperty.bind(s,t,a)).then(function(n){e.setRevertData({originalValue:n});o(t,a,i,s)})};a.revertChange=function(e,t,r){var a=e.getRevertData();if(a){var i=e.getContent();var s=i.property;var p=a.originalValue;var c=r.modifier;o(t,s,p,c);e.resetRevertData()}else{n.error("Attempt to revert an unapplied change.")}};a.completeChangeContent=function(e,t){if(!t.content){throw new Error("oSpecificChangeInfo attribute required")}e.setContent(t.content)};a.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:t.LastOneWins,uniqueKey:e.getContent().property}};return a},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/StashControl",["sap/ui/fl/LayerUtils","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/changeHandler/JsControlTreeModifier"],function(e,n,t){"use strict";var r={};r.applyChange=function(n,t,r){var i;var a=r.modifier;return Promise.resolve().then(a.getStashed.bind(a,t)).then(function(e){i=e;return a.findIndexInParentAggregation(t)}).then(function(r){this.setChangeRevertData(n,i,r);if(e.isDeveloperLayer(n.getLayer())){return a.setStashed(t,true)}return a.setVisible(t,false)}.bind(this))};function i(e,n,t,r){var i;if(e!==n.originalIndex){var a=r.getParent(t);return Promise.return().then(r.getParentAggregationName.bind(r,t)).then(function(e){i=e;return r.removeAggregation(a,i,t)}).then(r.insertAggregation.bind(r,a,i,t,n.originalIndex))}return Promise.resolve()}r.revertChange=function(n,t,r){var a=n.getRevertData();var o=r.modifier;return Promise.resolve().then(function(){if(e.isDeveloperLayer(n.getLayer())){var s=o.setStashed(t,a.originalValue,r.appComponent);if(s){return Promise.resolve().then(o.findIndexInParentAggregation.bind(o,s)).then(function(e){return i(e,a,s,o)})}return Promise.resolve()}return o.setVisible(t,!a.originalValue)}).then(function(){n.resetRevertData()})};r.completeChangeContent=function(){};r.setChangeRevertData=function(e,n,t){e.setRevertData({originalValue:n,originalIndex:t})};r.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:n.Reverse,uniqueKey:"stashed"}};r.getChangeVisualizationInfo=function(e,n){var r=e.getSelector();var i=t.bySelector(r,n);return{affectedControls:[r],displayControls:[i.getParent().getId()]}};return r});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UnhideControl",["sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t){"use strict";var n="visible";var r={};r.applyChange=function(e,t,r){var i=r.modifier;return Promise.resolve().then(i.getProperty.bind(i,t,n)).then(function(n){e.setRevertData({originalValue:n});r.modifier.setVisible(t,true)})};r.revertChange=function(t,n,r){var i=t.getRevertData();if(i){r.modifier.setVisible(n,i.originalValue);t.resetRevertData()}else{e.error("Attempt to revert an unapplied change.")}};r.completeChangeContent=function(){};r.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:t.Reverse,uniqueKey:n}};return r},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UnstashControl",["sap/ui/fl/changeHandler/condenser/Classification"],function(e){"use strict";var n={};n.applyChange=function(e,n,t){var r=e.getContent();var a=t.modifier;var i=false;var o;return Promise.resolve().then(a.getStashed.bind(a,n)).then(function(s){e.setRevertData({originalValue:s});o=a.setStashed(n,i,t.appComponent)||n;if(r.parentAggregationName){var g=r.parentAggregationName;var u=a.getParent(o);return Promise.resolve().then(a.removeAggregation.bind(a,u,g,o)).then(a.insertAggregation.bind(a,u,g,o,r.index,t.view))}return undefined}).then(function(){return o})};n.revertChange=function(e,n,t){var r=e.getRevertData();t.modifier.setStashed(n,r.originalValue);e.resetRevertData()};n.completeChangeContent=function(e,n){if(n.content){e.setContent(n.content)}};n.getCondenserInfo=function(n){return{affectedControl:n.getSelector(),classification:e.Reverse,uniqueKey:"stashed"}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/UpdateIFrame",["sap/base/util/extend","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t){"use strict";var n={};var r=["width","height","url","_settings"];function i(e,t){var n={};var i=[];r.forEach(function(r){var o=Promise.resolve().then(e.getProperty.bind(e,t,r)).then(function(e){if(e!==undefined){n[r]=e}});i.push(o)});return Promise.all(i).then(function(){return n})}function o(t,n,r){var i=e({_settings:r},r);return Promise.resolve().then(t.applySettings.bind(t,n,i))}n.applyChange=function(e,t,n){var r=n.modifier;return r.getControlMetadata(t).then(function(e){if(e.getName()!=="sap.ui.fl.util.IFrame"){return Promise.reject(new Error("UpdateIFrame only for sap.ui.fl.util.IFrame"))}return i(r,t)}).then(function(n){e.setRevertData({originalSettings:n});return o(r,t,e.getContent())})};n.revertChange=function(e,t,n){var r=e.getRevertData();return Promise.resolve().then(function(){if(r){if(r.originalSettings._settings&&r.originalSettings._settings.url){r.originalSettings.url=r.originalSettings._settings.url}return o(n.modifier,t,r.originalSettings)}return Promise.reject(new Error("Attempt to revert an unapplied change."))}).then(function(){e.resetRevertData()})};n.completeChangeContent=function(e,t){if(!t.content||!Object.keys(t.content).some(function(e){return r.indexOf(e)!==-1})){throw new Error("oSpecificChangeInfo attribute required")}e.setContent(t.content)};n.getCondenserInfo=function(e){return{classification:t.Update,affectedControl:e.getSelector(),uniqueKey:"iFrame",updateContent:e.getContent()}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/XmlTreeModifier",["sap/ui/core/util/reflection/XmlTreeModifier"],function(e){"use strict";return e},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/ChangeCategories",[],function(){"use strict";return{ADD:"add",MOVE:"move",RENAME:"rename",COMBINESPLIT:"combinesplit",REMOVE:"remove",OTHER:"other"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/createIFrame",["sap/ui/fl/util/IFrame"],function(){"use strict";return function(e,r,t){var n=r.modifier;var a=e.getContent();var i=r.view;var o=r.appComponent;var u={_settings:{}};["url","width","height"].forEach(function(e){var r=a[e];u[e]=r;u._settings[e]=r});return Promise.resolve().then(function(){return n.createControl("sap.ui.fl.util.IFrame",o,i,t,u,false)})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/getTargetAggregationIndex",[],function(){"use strict";return function(e,n,r){var t=r.modifier;var i=e.getContent();var g=i.targetAggregation;var o=i.index;if(o===undefined){return Promise.resolve().then(t.getAggregation.bind(t,n,g)).then(function(e){return e.length})}return Promise.resolve(o)}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/common/revertAddedControls",["sap/ui/fl/Utils"],function(e){"use strict";return function(r,t,n){var a=n.modifier;var o=r.getContent();var i=o.targetAggregation;var u=n.view||e.getViewForControl(t);var c=n.appComponent;var s=r.getRevertData()||[];var v=s.map(function(e){var r;if(typeof e==="string"){r=e}else{r=e.id;i=i||e.aggregationName}return a.bySelector(r,c,u)||u&&u.createId&&a.bySelector(u.createId(r))});var f=[];v.forEach(function(e){var r=function(){return Promise.resolve().then(a.removeAggregation.bind(a,t,i,e)).then(function(){if(e.destroy){e.destroy()}})};f.push(r)});return e.execPromiseQueueSequentially(f,true,true).then(function(){r.resetRevertData();return true})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/changeHandler/condenser/Classification",[],function(){"use strict";return{LastOneWins:"lastOneWins",Reverse:"reverse",Move:"move",Create:"create",Destroy:"destroy",Update:"update"}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/Storage",["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/initial/_internal/StorageResultMerger","sap/ui/fl/initial/_internal/storageResultDisassemble","sap/ui/fl/write/api/Version","sap/ui/fl/Utils","sap/ui/fl/write/_internal/FlexInfoSession"],function(e,n,r,t,i,a){"use strict";function l(e,n,r){if(!n.layers||n.layers[0]!=="ALL"&&n.layers.indexOf("CUSTOMER")===-1){delete e.version;return e}if(o(r.reference)){e.allContexts=true}if(r.version!==undefined){e.version=r.version;return e}var a=i.getUrlParameter(t.UrlParameter);if(a===null){delete e.version}else{e.version=parseInt(a)}return e}function o(e){var n=a.getByReference(e);return n&&n.initialAllContexts}function s(n,r){var t=r.map(function(r){var t=Object.assign({},n,{url:r.url,path:r.path});t=l(t,r,n);return r.loadConnectorModule.loadFlexData(t).then(function(n){return n||e.getEmptyFlexDataResponse()}).catch(e.logAndResolveDefault.bind(undefined,e.getEmptyFlexDataResponse(),r,"loadFlexData"))});return Promise.all(t)}function u(e){var n=[];e.forEach(function(e){if(Array.isArray(e)){n=n.concat(e)}else{n.push(e)}});return n}function f(e){return e.map(function(e){return r(e)})}function c(e){return Promise.resolve(e).then(u).then(f).then(u).then(n.merge)}function p(n){return e.getStaticFileConnector().then(s.bind(this,n))}var d={};d.completeFlexData=function(e){if(!e||!e.reference){return Promise.reject("No reference was provided")}return Promise.all([p(e),e.partialFlexData]).then(c)};d.loadFlexData=function(n){if(!n||!n.reference){return Promise.reject("No reference was provided")}return e.getLoadConnectors().then(s.bind(this,n)).then(c)};return d});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/StorageResultMerger",["sap/base/util/merge","sap/base/util/ObjectPath"],function(n,e){"use strict";var a={};function r(n,a){var r=n.reduce(function(n,r){if(e.get(a,r)){return n.concat(e.get(a,r))}return n},[]);var t=[];return r.filter(function(n){var e=n.fileName;var a=t.indexOf(e)!==-1;if(a){return false}t.push(e);return true})}function t(e){return e.reduce(function(e,a){return n({},e,a.ui2personalization)},{})}function i(n){return n.reduce(function(n,e){return e.cacheKey?n+=e.cacheKey:n},"")||null}function s(n){for(var e=0;e<n.length;e++){if(n[e].info){return n[e].info.allContextsProvided}}}a.merge=function(n){var e={appDescriptorChanges:r(n,"appDescriptorChanges"),changes:r(n,"changes"),ui2personalization:t(n),comp:{variants:r(n,"comp.variants"),changes:r(n,"comp.changes"),defaultVariants:r(n,"comp.defaultVariants"),standardVariants:r(n,"comp.standardVariants")},variants:r(n,"variants"),variantChanges:r(n,"variantChanges"),variantDependentControlChanges:r(n,"variantDependentControlChanges"),variantManagementChanges:r(n,"variantManagementChanges"),cacheKey:i(n)};var a=s(n);if(a!==undefined){e.info={allContextsProvided:a}}return e};return a});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/StorageUtils",["sap/base/security/encodeURLParameters","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/base/util/isEmptyObject","sap/ui/core/Configuration"],function(n,e,t,r,a,o){"use strict";var i={load:{LrepConnector:"sap/ui/fl/initial/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/initial/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/initial/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/initial/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/initial/_internal/connectors/StaticFileConnector",ObjectStorageConnector:"sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"},write:{LrepConnector:"sap/ui/fl/write/_internal/connectors/LrepConnector",NeoLrepConnector:"sap/ui/fl/write/_internal/connectors/NeoLrepConnector",PersonalizationConnector:"sap/ui/fl/write/_internal/connectors/PersonalizationConnector",KeyUserConnector:"sap/ui/fl/write/_internal/connectors/KeyUserConnector",StaticFileConnector:"sap/ui/fl/write/_internal/connectors/StaticFileConnector",JsObjectConnector:"sap/ui/fl/write/_internal/connectors/JsObjectConnector",ObjectPathConnector:"sap/ui/fl/write/_internal/connectors/ObjectPathConnector",LocalStorageConnector:"sap/ui/fl/write/_internal/connectors/LocalStorageConnector",SessionStorageConnector:"sap/ui/fl/write/_internal/connectors/SessionStorageConnector"}};var c="sap/ui/fl/initial/_internal/connectors/";var s={connector:"StaticFileConnector"};function l(n,e){var t=[];if(!n){t=e}else{t=n.filter(function(n){return e.indexOf(n)!==-1||e[0]==="ALL"})}return t}function u(n,e,t){return t.map(function(n){var t=n.connector;var r;if(!n.loadConnector&&!n.applyConnector&&!n.loadConnector){r=e?i.load[t]:i.write[t]}else if(e){r=n.loadConnector||n.applyConnector}else{r=n.writeConnector||"sap/ui/fl/write/connectors/BaseConnector"}return r})}function p(n,e,t){var r=u(n,e,t);return new Promise(function(n){sap.ui.require(r,function(){Array.from(arguments).forEach(function(n,r){if(!t[r].layers){t[r].layers=n.layers}else{t[r].layers=l(t[r].layers,n.layers)}if(e){t[r].loadConnectorModule=n}else{t[r].writeConnectorModule=n}});n(t)})})}return{getConnectors:function(n,e){var t=o.getFlexibilityServices();var r=[];if(e){r=[s]}r=r.concat(t);return p(n,e,r)},getLoadConnectors:function(){return this.getConnectors(c,true)},getStaticFileConnector:function(){return p(c,true,[s])},logAndResolveDefault:function(n,t,r,a){e.error("Connector ("+t.connector+") failed call '"+r+"': "+a+"\nApplication startup continues without data from this storage.");return n},filterAndSortResponses:function(n){var e=[];Object.keys(n).forEach(function(t){e.push(n[t])});e=e.filter(function(n){return n.changes.length>0||n.variants.length>0||n.variantChanges.length>0||n.variantManagementChanges.length>0||n.variantDependentControlChanges.length>0||n.comp.variants.length>0||n.comp.changes.length>0||n.comp.defaultVariants.length>0||n.comp.standardVariants.length>0});e.sort(function(n,e){return n.index-e.index});return e},sortFlexObjects:function(n){n.sort(function(n,e){return new Date(n.creation)-new Date(e.creation)})},getGroupedFlexObjects:function(n){this.sortFlexObjects(n);var e={};Object.keys(t).forEach(function(n){e[n]=this.getEmptyFlexDataResponse();e[n].index=r.getLayerIndex(n)}.bind(this));n.forEach(function(n){var t=n.layer;if(n.fileType==="ctrl_variant"&&n.variantManagementReference){e[t].variants.push(n)}else if(n.fileType==="ctrl_variant_change"){e[t].variantChanges.push(n)}else if(n.fileType==="ctrl_variant_management_change"){e[t].variantManagementChanges.push(n)}else if(n.fileType==="variant"){e[t].comp.variants.push(n)}else if(n.fileType==="change"){if(n.variantReference){e[t].variantDependentControlChanges.push(n)}else{switch(n.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":e[t].comp.changes.push(n);break;case"defaultVariant":e[t].comp.defaultVariants.push(n);break;case"standardVariant":e[t].comp.standardVariants.push(n);break;default:e[t].changes.push(n)}}}});return e},getEmptyFlexDataResponse:function(){return Object.assign({},{appDescriptorChanges:[],changes:[],comp:{variants:[],changes:[],defaultVariants:[],standardVariants:[]},variants:[],variantChanges:[],variantDependentControlChanges:[],variantManagementChanges:[],ui2personalization:{}})},isStorageResponseFilled:function(n){return Object.keys(n||{}).some(function(e){if(Array.isArray(n[e])){return n[e].length!==0}return!a(n[e])})}}});
/*!
* OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerRegistration",["sap/ui/core/Core","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/changeHandler/AddXML","sap/ui/fl/changeHandler/AddXMLAtExtensionPoint","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/MoveControls","sap/ui/fl/changeHandler/MoveElements","sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/fl/changeHandler/PropertyChange","sap/ui/fl/changeHandler/StashControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/fl/changeHandler/UnstashControl"],function(e,n,a,r,t,i,o,s,l,d,g,h){"use strict";var f={hideControl:t,moveElements:o,moveControls:i,stashControl:d,unhideControl:g,unstashControl:h};var u={addXML:a,addXMLAtExtensionPoint:r,propertyBindingChange:s,propertyChange:l};var c={};function C(e,n){c[e]=n;n.catch(function(){}).then(function(){delete c[e]})}function p(e){return n.registerChangeHandlersForLibrary(e)}function H(e){if(e.getParameter("operation")==="add"){var n=e.getParameter("metadata");var a=n.sName;var r=n&&n.extensions&&n.extensions.flChangeHandlers;if(r){var t=p(r);C(a,t)}}}var v={getChangeHandlersOfLoadedLibsAndRegisterOnNewLoadedLibs:function(){var n=e.getLoadedLibraries();var a=[];Object.values(n).forEach(function(e){if(e.extensions&&e.extensions.flChangeHandlers){a.push(p(e.extensions.flChangeHandlers))}});e.attachLibraryChanged(H);return Promise.all(a)},waitForChangeHandlerRegistration:function(e){if(c[e]){return c[e].catch(function(){})}return Promise.resolve()},registerPredefinedChangeHandlers:function(){n.registerPredefinedChangeHandlers(f,u)}};return v});
/*!
* OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage",["sap/base/util/each","sap/base/Log","sap/ui/fl/Layer","sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem","sap/ui/fl/registry/Settings","sap/ui/fl/requireAsync"],function(e,r,n,a,t,i){"use strict";var o={};var l={};var s={};var u={};function f(e,r){var n={};if(!r||!r.changeHandler){n.changeHandler=r}else{n=r}if(n.changeHandler==="default"){n.changeHandler=u.defaultChangeHandlers[e]}else if(Object.keys(u.developerChangeHandlers||{}).includes(e)){throw Error("You can't use a custom change handler for the following Developer Mode change type: "+e+". Please use 'default' instead.")}return n}function g(r){s={};e(r,function(e,r){var n=new a({controlType:"defaultActiveForAll",changeHandler:r,layers:t.getDeveloperModeLayerPermissions(),changeType:e});s[e]=n})}function c(r,n,i){i=f(n,i);var o=Object.assign({},t.getDefaultLayerPermissions());if(i.layers){e(i.layers,function(e,r){if(o[e]===undefined){throw Error("The Layer '"+e+"' is not supported. Please only use supported layers")}o[e]=r})}var l={controlType:r,changeHandler:i.changeHandler,layers:o,changeType:n};return new a(l)}function d(e,r,n){var a=c(e,r,n);l[e]=l[e]||{};l[e][r]=a}function h(n,a){var t=Promise.resolve(a);var o="ChangeHandlerStorage.registerChangeHandlersForControl.skip_next_then";if(typeof a==="string"){t=i(a+".flexibility").catch(function(e){r.error("Flexibility change handler registration failed.\nControlType: "+n+"\n"+e.message);return Promise.resolve(o)})}return t.then(function(r){if(r!==o){e(r,function(e,r){d(n,e,r)})}}).catch(function(e){r.error(e.message)})}function y(e,r,a){var t=l[e]&&l[e][r]||s[r];if(!t){throw Error("No Change handler registered for the Control and Change type")}a=a===n.PUBLIC?n.USER:a;if(!t.getLayers()[a]){throw Error("Change type "+r+" not enabled for layer "+a)}return t}function p(e,n,a,t){var o=t.getChangeHandlerModulePath(a);if(typeof o!=="string"){return Promise.resolve(undefined)}return i(o).then(function(r){var a=r[e];if(a){return c(n,e,a)}}).catch(function(e){r.error("Flexibility registration for control "+t.getId(a)+" failed to load module "+o+"\n"+e.message)})}o.getChangeHandler=function(e,r,n,a,t){return p(e,r,n,a).then(function(n){var a=n||y(r,e,t);return a.getChangeHandler()})};o.registerPredefinedChangeHandlers=function(e,r){u.defaultChangeHandlers=e;u.developerChangeHandlers=r;g(r)};o.registerChangeHandlersForLibrary=function(r){var n=[];e(r,function(e,r){n.push(h(e,r))});return Promise.all(n)};o.clearAll=function(){l={};s={};u={}};o.registerChangeHandlersForControl=function(e,r){return h(e,r)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/changeHandlers/ChangeRegistryItem",["sap/base/Log","sap/ui/fl/requireAsync","sap/ui/fl/Utils"],function(e,r,n){"use strict";var t=function(r){if(!r.changeHandler){e.error("sap.ui.fl.registry.ChangeRegistryItem: changeHandler required")}if(!r.changeType){e.error("sap.ui.fl.registry.ChangeRegistryItem: changeType required")}if(!r.layers){e.error("sap.ui.fl.registry.ChangeRegistryItem: layers required")}if(!r.controlType){e.error("sap.ui.fl.registry.ChangeRegistryItem: ControlType required")}this._controlType=r.controlType;this._changeType=r.changeType;this._changeHandler=r.changeHandler;this._layers=r.layers};t.prototype.getChangeTypeName=function(){return this._changeType};t.prototype.getControlType=function(){return this._controlType};t.prototype.getLayers=function(){return this._layers};t.prototype.getChangeHandler=function(){var e=new n.FakePromise;if(typeof this._changeHandler==="string"){e=r(this._changeHandler.replace(/\./g,"/")).then(function(e){this._changeHandler=e}.bind(this))}return e.then(function(){if(!this._changeHandler||typeof this._changeHandler.completeChangeContent!=="function"||typeof this._changeHandler.applyChange!=="function"||typeof this._changeHandler.revertChange!=="function"){return Promise.reject(new Error("The ChangeHandler is either not available or does not have all required functions"))}return this._changeHandler}.bind(this))};return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/BackendConnector",["sap/ui/fl/initial/_internal/connectors/Utils","sap/base/util/restricted/_pick"],function(n,e){"use strict";return{xsrfToken:undefined,settings:undefined,sendRequest:function(t){var i=e(t,["version","allContexts"]);if(this.isLanguageInfoRequired){n.addLanguageInfo(i)}var s=n.getUrl(this.ROUTES.DATA,t,i);return n.sendRequest(s,"GET",{initialConnector:this,xsrfToken:this.xsrfToken}).then(function(n){var e=n.response;if(n.etag){e.cacheKey=n.etag}if(e.settings){this.settings=e.settings}return e}.bind(this))},loadFlexData:function(n){return this.sendRequest(n).then(function(n){n.changes=n.changes.concat(n.compVariants||[]);return n})}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/KeyUserConnector",["sap/base/util/merge","sap/ui/fl/initial/_internal/connectors/BackendConnector","sap/ui/fl/Layer"],function(e,n,a){"use strict";var t="/flex/keyuser";var c="/v2";var r=e({},n,{layers:[a.CUSTOMER,a.PUBLIC],API_VERSION:c,ROUTES:{DATA:t+c+"/data/"},isLanguageInfoRequired:true,loadFlexData:function(e){return n.sendRequest.call(r,e).then(function(e){e.contents.map(function(e,n,a){a[n].changes=(e.changes||[]).concat(e.compVariants)});e.contents.cacheKey=e.cacheKey;return e.contents})}});return r});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/LrepConnector",["sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/Utils","sap/ui/dom/includeScript","sap/base/util/restricted/_pick"],function(e,t,i,n){"use strict";var s={DATA:"/flex/data/",MODULES:"/flex/modules/"};return{layers:["ALL"],xsrfToken:undefined,settings:undefined,_loadModules:function(e){return new Promise(function(t,n){i(e,undefined,t,n)})},_addClientInfo:function(e){var i=t.getUrlParameter("sap-client");if(!e&&i){e={}}if(i){e["sap-client"]=i}},loadFlexData:function(t){if(t.cacheKey==="<NO CHANGES>"){return Promise.resolve()}var i=n(t,["version","allContexts"]);this._addClientInfo(i);e.addSAPLogonLanguageInfo(i);var a;if(t.appDescriptor&&t.appDescriptor["sap.app"]){a=t.appDescriptor["sap.app"].id}if(t.preview){t.reference=t.preview.reference;i.upToLayerType=t.preview.maxLayer}var r=e.getUrl(s.DATA,t,i);return e.sendRequest(r,"GET",{initialConnector:this,xsrfToken:this.xsrfToken,siteId:t.siteId,sAppDescriptorId:a}).then(function(n){var a=n.response;if(n.etag){a.cacheKey=n.etag}else if(t.cacheKey){a.cacheKey=t.cacheKey}a.changes=a.changes.concat(a.compVariants||[]);if(a.settings){this.settings=a.settings;this.settings.isVariantAdaptationEnabled=!!this.settings.isPublicLayerAvailable;this.settings.isContextSharingEnabled=true;this.settings.isContextSharingEnabledForComp=true;this.settings.isLocalResetEnabled=true}if(!a.loadModules){return a}var r=e.getUrl(s.MODULES,t,i);return this._loadModules(r).then(function(){return a})}.bind(this))}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/NeoLrepConnector",["sap/base/util/merge","sap/ui/fl/initial/_internal/connectors/LrepConnector"],function(n,e){"use strict";return n({},e,{})});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/PersonalizationConnector",["sap/base/util/merge","sap/ui/fl/initial/_internal/connectors/BackendConnector","sap/ui/fl/Layer"],function(n,a,e){"use strict";var i="/flex/personalization";var r="/v1";var t=n({},a,{layers:[e.USER],ROUTES:{DATA:i+r+"/data/"}});return t});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/StaticFileConnector",["sap/base/Log","sap/base/util/LoaderExtensions","sap/ui/core/Configuration"],function(e,n,r){"use strict";function a(a,o){var i=a.replace(/\./g,"/")+"/changes/"+o+".json";var t=!!sap.ui.loader._.getModuleState(i);var s=r;if(t||s.getDebug()||s.getComponentPreload()==="off"){try{return n.loadResource(i)}catch(n){if(n.name.includes("SyntaxError")){e.error(n)}e.warning("flexibility did not find a "+o+".json for the application: "+a)}}}return{loadFlexData:function(e){var n=e.componentName;if(!n){n=e.reference.replace(/.Component/g,"")}var r=a(n,"flexibility-bundle");if(r){r.changes=r.changes.concat(r.compVariants);delete r.compVariants;return Promise.resolve(r)}var o=a(n,"changes-bundle");if(o){return Promise.resolve({changes:o})}return Promise.resolve()}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/connectors/Utils",["sap/base/security/encodeURLParameters","sap/ui/core/Configuration"],function(e,t){"use strict";var s=0;var n=function(e,t){var s=new Error(e.statusText);s.status=e.status;s.userMessage=t;return s};var r=function(e){return sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl").getText(e)};return{addLanguageInfo:function(e){if(!e){throw new Error("No parameters map were passed")}e["sap-language"]=t.getLanguage()},addSAPLogonLanguageInfo:function(e){if(!e){throw new Error("No parameters map were passed")}e["sap-language"]=t.getSAPLogonLanguage()},getUrl:function(t,s,n){if(!t||!s.url){throw new Error("Not all necessary parameters were passed")}var r=s.url+t;if(s.cacheKey){r+="~"+s.cacheKey+"~/"}if(s.reference){r+=s.reference}else if(s.fileName){r+=s.fileName}if(n){Object.keys(n).forEach(function(e){if(n[e]===undefined){delete n[e]}});var a=e(n);if(a.length>0){r+="?"+a}}return r},sendRequest:function(e,t,a){t=t||"GET";t=t.toUpperCase();return new Promise(function(o,i){var p=new XMLHttpRequest;p.open(t,e);p.timeout=s;if((t==="GET"||t==="HEAD")&&(!a||!a.initialConnector||!a.initialConnector.xsrfToken)){p.setRequestHeader("X-CSRF-Token","fetch")}if((t==="POST"||t==="PUT"||t==="DELETE")&&a&&a.initialConnector&&a.initialConnector.xsrfToken){p.setRequestHeader("X-CSRF-Token",a.initialConnector.xsrfToken)}if(a&&a.contentType){p.setRequestHeader("Content-Type",a.contentType)}if(a&&a.siteId){p.setRequestHeader("X-LRep-Site-Id",a.siteId)}if(a&&a.sAppDescriptorId){p.setRequestHeader("X-LRep-AppDescriptor-Id",a.sAppDescriptorId)}if(a&&a.dataType){p.responseType=a.dataType}p.onload=function(){if(p.status>=200&&p.status<400){try{var t={};if(p.status!==204&&p.status!==205){if(!p.response&&p.responseText){p.response=p.responseText}t.response=p.response;if(t.response&&typeof t.response==="string"&&p.getResponseHeader("content-type")&&p.getResponseHeader("content-type").indexOf("json")>0){t.response=JSON.parse(t.response)}}t.status=p.status;if(p.getResponseHeader("X-CSRF-Token")){if(!e.match(/\/~.*~/g)){t.xsrfToken=p.getResponseHeader("X-CSRF-Token");if(a&&a.initialConnector){a.initialConnector.xsrfToken=t.xsrfToken}}}if(p.getResponseHeader("Etag")){t.etag=p.getResponseHeader("Etag")}o(t)}catch(e){e.userMessage=r("MSG_LOADING_SERVER_RESPONSE_ERROR");i(e)}}else{var s="";try{var f=typeof p.response==="string"?JSON.parse(p.response):p.response;if(Array.isArray(f.messages)&&f.messages.length){s=f.messages.reduce(function(e,t){return e.concat(t.severity==="Error"?t.text+"\n":"")},s)}}catch(e){}i(n(p,s))}};p.ontimeout=function(){i(n(p,r("MSG_CONNECTION_TIMEOUT_ERROR")))};p.onerror=function(){i(n(p,r("MSG_NETWORK_ERROR")))};if(a&&a.payload){p.send(a.payload)}else{p.send()}})}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/initial/_internal/storageResultDisassemble",["sap/ui/fl/initial/_internal/StorageUtils","sap/base/util/merge","sap/base/util/isEmptyObject"],function(a,e,n){"use strict";function t(a,e){if(e.content.fileName!==e.content.variantManagementReference){a.push(e.content)}e.controlChanges.forEach(function(e){a.push(e)});for(var n in e.variantChanges){a=a.concat(e.variantChanges[n])}return a}function r(a){var e=true;if(a){Object.keys(a).some(function(n){if(a[n].length){e=false;return true}})}return e}return function(i){var s;if(!n(i.variantSection)){s=i.changes||[];for(var c in i.variantSection){var u=i.variantSection[c];for(var o in u.variantManagementChanges){s=s.concat(u.variantManagementChanges[o])}s=u.variants.reduce(t,s)}var f=a.getGroupedFlexObjects(s);var l=a.filterAndSortResponses(f);delete i.changes;delete i.variantSection;e(l[0]||{},i);return l}if(r(i.comp)){s=i.changes||[];i.comp={variants:[],changes:[],defaultVariants:[],standardVariants:[]};s.slice().reverse().forEach(function(a,e,n){var t=false;if(a.fileType==="variant"){i.comp.variants.unshift(a);t=true}else{switch(a.changeType){case"addFavorite":case"removeFavorite":case"updateVariant":i.comp.changes.unshift(a);t=true;break;case"defaultVariant":i.comp.defaultVariants.unshift(a);t=true;break;case"standardVariant":i.comp.standardVariants.unshift(a);t=true;break;default:break}}if(t){var r=n.length-1-e;i.changes.splice(r,1)}})}return[i]}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/interfaces/BaseLoadConnector",[],function(){"use strict";var e={loadFlexData:function(){return Promise.reject("loadFlexData is not implemented")}};return e});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/interfaces/Delegate",[],function(){"use strict";return{getPropertyInfo:function(){return Promise.reject("not implemented")},getRepresentedProperties:function(){return Promise.reject("not implemented")},createLabel:function(){return Promise.reject("not implemented")},createControlForProperty:function(){return Promise.reject("not implemented")},createLayout:function(){return Promise.reject("not implemented")}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/library",["sap/ui/fl/apply/_internal/preprocessors/RegistrationDelegator","sap/ui/fl/Utils","sap/ui/fl/Layer","sap/ui/fl/Scenario","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/core/Configuration","sap/ui/core/library","sap/m/library"],function(e,i,r,a,s,n){"use strict";var l=sap.ui.getCore().initLibrary({name:"sap.ui.fl",version:"1.109.0",controls:["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],dependencies:["sap.ui.core","sap.m"],designtime:"sap/ui/fl/designtime/library.designtime",extensions:{flChangeHandlers:{"sap.ui.fl.util.IFrame":"sap/ui/fl/util/IFrame"},"sap.ui.support":{publicRules:true}}});l.condenser={Classification:s};l.Scenario=a;e.registerAll();function t(){var e=i.getUshellContainer();if(e){return e.getLogonSystem().isTrial()}return false}if(t()){n.setFlexibilityServices([{connector:"LrepConnector",url:"/sap/bc/lrep",layers:[]},{connector:"LocalStorageConnector",layers:[r.CUSTOMER,r.PUBLIC,r.USER]}])}return l});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/registry/Settings",["sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/base/Log","sap/base/util/UriParameters"],function(t,e,n,r){"use strict";function o(t){if(t&&t.logonUser){return Promise.resolve(t.logonUser)}var r=e.getUshellContainer();if(r){return e.getUShellService("UserInfo").then(function(t){var e=t.getUser();return e&&e.getId()}).catch(function(t){n.error("Error getting service from Unified Shell: "+t.message)})}return Promise.resolve()}var i=function(t){if(!t){throw new Error("no flex settings provided")}this._oSettings=t};i.attachEvent=function(t,e){i._oEventProvider.attachEvent(t,e)};i.detachEvent=function(t,e){i._oEventProvider.detachEvent(t,e)};i.getInstance=function(){if(i._instance){return Promise.resolve(i._instance)}if(i._oLoadSettingsPromise){return i._oLoadSettingsPromise}return i._loadSettings()};i._loadSettings=function(){var e;var r=t.loadFeatures().then(function(t){e=t;return o(e)}).then(function(t){if(!e){n.error("The request for flexibility settings failed; A default response is generated and returned to consuming APIs");e={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isVariantPersonalizationEnabled:true,isAtoAvailable:false,isAtoEnabled:false,isAppVariantSaveAsEnabled:false,isContextSharingEnabled:true,isContextSharingEnabledForComp:true,isContextBasedAdaptationEnabled:false,isCondensingEnabled:false,isProductiveSystem:true,isPublicLayerAvailable:false,isLocalResetEnabled:false,isVariantAdaptationEnabled:false,versioning:{},_bFlexChangeMode:false,_bFlexibilityAdaptationButtonAllowed:false}}e.userId=t;return i._storeInstance(e)});i._oLoadSettingsPromise=r;return r};i._storeInstance=function(t){if(!i._instance){i._instance=new i(t)}return i._instance};i.getInstanceOrUndef=function(){return i._instance};i.getDefaultLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:true,PUBLIC:false,USER:false}};i.getDeveloperModeLayerPermissions=function(){return{VENDOR:true,CUSTOMER_BASE:true,CUSTOMER:false,PUBLIC:false,USER:false}};i.prototype._getBooleanProperty=function(t){return this._oSettings[t]||false};i.prototype.isKeyUser=function(){return this._getBooleanProperty("isKeyUser")};i.prototype.isKeyUserTranslationEnabled=function(){return this._getBooleanProperty("isKeyUserTranslationEnabled")};i.prototype.isPublicLayerAvailable=function(){return this._getBooleanProperty("isPublicLayerAvailable")};i.prototype.isVariantAdaptationEnabled=function(){return this._getBooleanProperty("isVariantAdaptationEnabled")};i.prototype.isAppVariantSaveAsEnabled=function(){return!this.isContextBasedAdaptationEnabled()&&this._getBooleanProperty("isAppVariantSaveAsEnabled")};i.prototype.isContextBasedAdaptationEnabled=function(){var t=r.fromQuery(window.location.search);var e=t.get("sap-ui-xx-rta-adaptations");return e==="true"||this._getBooleanProperty("isContextBasedAdaptationEnabled")};i.prototype.isVersioningEnabled=function(t){return!!(this._oSettings.versioning[t]||this._oSettings.versioning["ALL"])};i.prototype.isModelS=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isAtoEnabled=function(){return this._getBooleanProperty("isAtoEnabled")};i.prototype.isAtoAvailable=function(){return this._getBooleanProperty("isAtoAvailable")};i.prototype.isProductiveSystem=function(){return this._getBooleanProperty("isProductiveSystem")};i.prototype.isVariantSharingEnabled=function(){return this._getBooleanProperty("isVariantSharingEnabled")};i.prototype.isPublicFlVariantEnabled=function(){return this._getBooleanProperty("isPublicFlVariantEnabled")};i.prototype.isContextSharingEnabled=function(){return this._getBooleanProperty("isContextSharingEnabled")};i.prototype.isContextSharingEnabledForComp=function(){return this._getBooleanProperty("isContextSharingEnabledForComp")};i.prototype.isVariantPersonalizationEnabled=function(){return this._getBooleanProperty("isVariantPersonalizationEnabled")};i.prototype.isCondensingEnabled=function(){return this._getBooleanProperty("isCondensingEnabled")};i.prototype.isSystemWithTransports=function(){return!!(this._oSettings.system&&this._oSettings.client)};i.prototype.isProductiveSystemWithTransports=function(){return this.isProductiveSystem()&&this.isSystemWithTransports()};i.prototype.isLocalResetEnabled=function(){return this._getBooleanProperty("isLocalResetEnabled")};i.prototype.getSystem=function(){return this._oSettings.system};i.prototype.getClient=function(){return this._oSettings.client};i.prototype._getHostname=function(){return document.location.hostname};i.prototype.isCustomerSystem=function(){var t=this._oSettings.systemType;var e={CUSTOMER:true,SAP:false}[t];var n=this._getHostname();return e!==undefined?e:!(n.endsWith(".sap"+".corp")||n==="localhost"||n==="127.0.0.1")};i.prototype.getUserId=function(){return this._oSettings.userId};return i},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/requireAsync",[],function(){"use strict";return function(n){return new Promise(function(i,u){sap.ui.require([n],function(n){i(n)},function(n){u(n)})})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/IFrame",["../library","sap/ui/core/Control","sap/ui/model/json/JSONModel","./getContainerUserInfo","sap/base/util/extend","sap/base/util/restricted/_CancelablePromise","sap/base/security/URLListValidator","sap/base/Log","./IFrameRenderer","sap/ui/core/library"],function(e,t,i,r,s,o,n,a,l){"use strict";function u(e){if(e.parts&&e.formatter){return e.formatter.apply(null,e.parts.map(function(e){if(e.model){return"{"+e.model+">"+e.path+"}"}return"{"+e.path+"}"}))}return e}var p=t.extend("sap.ui.fl.util.IFrame",{metadata:{library:"sap.ui.fl",properties:{url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},title:{type:"string",group:"Misc",defaultValue:undefined},_settings:{type:"object",group:"Data",defaultValue:null}},designtime:"sap/ui/fl/designtime/util/IFrame.designtime"},init:function(){if(t.prototype.init){t.prototype.init.apply(this,arguments)}this._oInitializePromise=r().then(function(e){this._oUserModel=new i(e);this.setModel(this._oUserModel,"$user")}.bind(this))},waitForInit:function(){return this._oInitializePromise?this._oInitializePromise:Promise.reject()},setUrl:function(e){var t=decodeURI(e)===e?encodeURI(e):e;if(p.isValidUrl(t)){if(this._oSetUrlPromise){this._oSetUrlPromise.cancel();delete this._oSetUrlPromise}this.setProperty("url","");this._oSetUrlPromise=new o(function(e,t,i){i.shouldReject=false;setTimeout(e,0)});this._oSetUrlPromise.then(function(){this.setProperty("url",t)}.bind(this))}else{a.error("Provided URL is not valid as an IFrame src")}return this},applySettings:function(e){t.prototype.applySettings.apply(this,arguments);if(e){var i=this.getProperty("_settings")||{};if(e._settings){s(i,e._settings)}else{Object.keys(e).filter(function(t){return!!e[t]}).forEach(function(t){i[t]=u(e[t])})}this.setProperty("_settings",i)}},exit:function(){if(this._oUserModel){this._oUserModel.destroy();delete this._oUserModel}},renderer:l});p.isValidUrl=function(e){return!n.entries().some(function(e){return/javascript/i.test(e.protocol)})&&n.validate(e)};return p});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/IFrameRenderer",[],function(){"use strict";function e(e,t,r){if(r!==""||r.toLowerCase()==="auto"){e.style(t,r)}}var t={apiVersion:2};t.render=function(t,r){t.openStart("iframe",r);e(t,"width",r.getWidth());e(t,"height",r.getHeight());t.style("display","block");t.style("border","none");t.attr("sandbox","allow-forms allow-popups allow-scripts allow-same-origin allow-modals");t.attr("src",r.getUrl());var i=r.getTitle();if(i){t.attr("title",i)}t.openEnd();t.close("iframe")};return t},true);
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/ManagedObjectModel",["sap/ui/core/Element","sap/ui/model/base/ManagedObjectModel"],function(e,t){"use strict";function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}var i=e.extend("sap.ui.fl.util.ManagedObjectModel",{metadata:{library:"sap.ui.fl",properties:{data:{type:"object"},name:{type:"string",defaultValue:"$sap.ui.fl.ManagedObjectModel"}},associations:{object:{type:"sap.ui.core.Element"}}},constructor:function(){e.apply(this,arguments);this._oManagedObjectModel=new t(sap.ui.getCore().byId(this.getObject()),this.getData());["data","name","object"].forEach(function(e){this["set"+a(e)]=function(){throw new Error("sap.ui.fl.util.ManagedObjectModel: Can't change the value of `"+e+"` after the object is initialized. Please recreate the object with correct values in the constructor.")}},this)}});i.prototype.setParent=function(t){var a=this.getParent();if(a){a.setModel(null,this.getName())}if(t){t.setModel(this._oManagedObjectModel,this.getName())}e.prototype.setParent.apply(this,arguments)};i.prototype.exit=function(){this._oManagedObjectModel.destroy()};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/util/getContainerUserInfo",["sap/ui/fl/Utils","sap/base/Log"],function(e,r){"use strict";function t(e){if(!e){return""}return e}return function(){var n=e.getUshellContainer();if(n){return e.getUShellService("UserInfo").then(function(e){if(!e){return{}}var r=e.getUser();if(!r){return{}}var n=t(r.getEmail());var i;if(n){i=t(/@(.*)/.exec(n)[1])}else{i=""}return{fullName:t(r.getFullName()),firstName:t(r.getFirstName()),lastName:t(r.getLastName()),email:n,domain:i}}).catch(function(e){r.error("Unexpected exception when reading shell user info: "+e.toString());return{}})}return Promise.resolve({})}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/variants/VariantManagement",["sap/ui/model/Context","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/VariantItem","sap/m/VariantManagement","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/registry/Settings","sap/ui/core/Control","sap/ui/core/library","sap/base/Log"],function(t,e,a,n,i,o,r,s,l,h){"use strict";var p=l.TitleLevel;var c=s.extend("sap.ui.fl.variants.VariantManagement",{metadata:{interfaces:["sap.ui.core.IShrinkable","sap.m.IOverflowToolbarContent"],library:"sap.ui.fl",designtime:"sap/ui/fl/designtime/variants/VariantManagement.designtime",properties:{updateVariantInURL:{type:"boolean",group:"Misc",defaultValue:false},resetOnContextChange:{type:"boolean",group:"Misc",defaultValue:true},modelName:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},manualVariantKey:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},executeOnSelectionForStandardDefault:{type:"boolean",group:"Misc",defaultValue:false},displayTextForExecuteOnSelectionForStandardVariant:{type:"string",group:"Misc",defaultValue:""},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:p.Auto},titleStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:p.Auto},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"}},events:{initialized:{},save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},execute:{type:"boolean"},public:{type:"boolean"},def:{type:"boolean"},tile:{type:"boolean"}}},cancel:{},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}},associations:{for:{type:"sap.ui.core.Control",multiple:true}},aggregations:{_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("max-width",e.getMaxWidth());t.openEnd();t.renderControl(e._oVM);t.close("div")}}});c.prototype.init=function(){s.prototype.init.apply(this);this.addStyleClass("sapUiFlVarMngmt");this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");this.setModelName(o.getVariantModelName());this.attachModelContextChange(this._setModel,this);this._oVM=new i(this.getId()+"-vm");this.setAggregation("_embeddedVM",this._oVM,true);this._aCancelEventHandlers=[];this._aSaveEventHandlers=[];this._aManageEventHandlers=[];this._aSelectEventHandlers=[];this._oVM.attachManage(this._fireManage,this);this._oVM.attachCancel(this._fireCancel,this);this._oVM.attachSave(this._fireSave,this);this._oVM.attachSelect(this._fireSelect,this);this._updateWithSettingsInfo()};c.prototype.getOverflowToolbarConfig=function(){return{canOverflow:false,invalidationEvents:["save","manage","select"]}};c.prototype.attachCancel=function(t,e,a){this.attachEvent("cancel",t,e,a);return this};c.prototype._findCallback=function(t,e,a){var n=-1;t.some(function(t,i){if(t.fCallback===e&&t.oObj===a){n=i}return n>=0});return n};c.prototype.detachCancel=function(t,e){var a=this._findCallback(this._aCancelEventHandlers,t,e);if(a>=0){this.detachEvent("cancel",t,e);this._aCancelEventHandlers.splice(a,1)}return this};c.prototype.fireManage=function(t){this._oVM.fireManage(t)};c.prototype.fireSave=function(t){this._oVM.fireSave(t)};c.prototype._fireCancel=function(t){for(var e=0;e<this._aCancelEventHandlers.length;e++){t.oSource=this;this._aCancelEventHandlers[e].fCallbackBound(t,this._aCancelEventHandlers[e].mProps)}};c.prototype.attachSave=function(t,e,a){this.attachEvent("save",t,e,a);return this};c.prototype.detachSave=function(t,e){var a=this._findCallback(this._aSaveEventHandlers,t,e);if(a>-1){this.detachEvent("save",t,e);this._aSaveEventHandlers.splice(a,1)}return this};c.prototype._fireSave=function(t){this._handleAllListeners(t,this._aSaveEventHandlers)};c.prototype.hasListeners=function(t){var e=["save","select","cancel","manage"];if(e.indexOf(t)>-1){var a=null;if(t==="select"){a=this._aSelectEventHandlers}else if(t==="save"){a=this._aSaveEventHandlers}else if(t==="manage"){a=this._aManageEventHandlers}else if(t==="cancel"){a=this._aCancelEventHandlers}return a.length>0}return s.prototype.hasListeners.apply(this,arguments)};c.prototype.attachEvent=function(t,e,a,n){var i=["save","select","cancel","manage"];if(i.indexOf(t)>-1){var o=null;var r=a;if(typeof e==="function"){r=e;n=a;e=undefined}n=n===this?undefined:n;if(t==="select"){o=this._aSelectEventHandlers}else if(t==="save"){o=this._aSaveEventHandlers}else if(t==="manage"){o=this._aManageEventHandlers}else if(t==="cancel"){o=this._aCancelEventHandlers}o.push({fCallback:r,fCallbackBound:n?r.bind(n):r,oObj:n,mProps:e})}else{s.prototype.attachEvent.apply(this,arguments)}};c.prototype.attachEventOnce=function(t,e,a,n){var i;if(t==="manage"){i=this._findCallback(this._aManageEventHandlers,a,n);if(i>-1&&this._aManageEventHandlers[i].bOnce){this._aManageEventHandlers.splice(i,1)}this.attachManage(e,a,n);i=this._findCallback(this._aManageEventHandlers,a,n);if(i>-1){this._aManageEventHandlers[i].bOnce=true}}else if(t==="save"){i=this._findCallback(this._aSaveEventHandlers,a,n);if(i>-1&&this._aSaveEventHandlers[i].bOnce){this._aSaveEventHandlers.splice(i,1)}this.attachSave(e,a,n);i=this._findCallback(this._aSaveEventHandlers,a,n);if(i>-1){this._aSaveEventHandlers[i].bOnce=true}}else if(t==="select"){i=this._findCallback(this._aSelectEventHandlers,a,n);if(i>-1&&this._aSelectEventHandlers[i].bOnce){this._aSelectEventHandlers.splice(i,1)}this.attachSelect(e,a,n);i=this._findCallback(this._aSelectEventHandlers,a,n);if(i>-1){this._aSelectEventHandlers[i].bOnce=true}}else{s.prototype.attachEventOnce.apply(this,arguments)}};c.prototype.attachManage=function(t,e,a){this.attachEvent("manage",t,e,a);return this};c.prototype._handleAllListeners=function(t,e){var a=0;var n=[];while(a<e.length){t.oSource=this;e[a].fCallbackBound(t,e[a].mProps);if(e[a]){if(e[a].hasOwnProperty("bOnce")&&e[a].bOnce){n.push(a)}a+=1}}for(a=n.length-1;a>-1;a--){e.splice(n[a],1)}};c.prototype._fireManage=function(t){this._handleAllListeners(t,this._aManageEventHandlers)};c.prototype.detachManage=function(t,e){var a=this._findCallback(this._aManageEventHandlers,t,e);if(a>-1){this.detachEvent("manage",t,e);this._aManageEventHandlers.splice(a,1)}return this};c.prototype.attachSelect=function(t,e,a){this.attachEvent("select",t,e,a);return this};c.prototype._fireSelect=function(t){this._handleAllListeners(t,this._aSelectEventHandlers)};c.prototype.detachSelect=function(t,e){var a=this._findCallback(this._aSelectEventHandlers,t,e);if(a>-1){this.detachEvent("select",t,e);this._aSelectEventHandlers.splice(a,1)}return this};c.prototype._createSaveAsDialog=function(){this._oVM._createSaveAsDialog()};c.prototype._handleVariantSaveAs=function(t){this._oVM._handleVariantSaveAs(t)};c.prototype.getFocusDomRef=function(){if(this._oVM){return this._oVM.oVariantPopoverTrigger.getFocusDomRef()}return null};c.prototype.getManageDialog=function(){if(this._oVM){return this._oVM.oManagementDialog}return null};c.prototype.getVariants=function(){var t=[];if(this.oContext&&this.oContext.getObject()){t=this.oContext.getObject().variants.filter(function(t){if(!t.hasOwnProperty("visible")){return true}return t.visible})}return t};c.prototype.getTitle=function(){return this._oVM.getTitle()};c.prototype.refreshTitle=function(){this._oVM.refreshTitle()};c.prototype.setPopoverTitle=function(t){this._oVM.setPopoverTitle(t);return this};c.prototype.setHeaderLevel=function(t){this.setProperty("headerLevel",t);this._oVM.setLevel(t);return this};c.prototype.setTitleStyle=function(t){this.setProperty("titleStyle",t);this._oVM.setTitleStyle(t);return this};c.prototype.setEditable=function(t){this.setProperty("editable",t);this._oVM.setShowFooter(t);return this};c.prototype.setShowExecuteOnSelection=function(t){this._oVM.setSupportApplyAutomatically(t);return this};c.prototype.setShowSetAsDefault=function(t){this.setProperty("showSetAsDefault",t);this._oVM.setSupportDefault(t);return this};c.prototype.setExecuteOnSelectionForStandardDefault=function(t){this.setProperty("executeOnSelectionForStandardDefault",t);this._oVM.setExecuteOnSelectionForStandardDefault(t);return this};c.prototype.setDisplayTextForExecuteOnSelectionForStandardVariant=function(t){this.setProperty("displayTextForExecuteOnSelectionForStandardVariant",t);this._oVM.setDisplayTextForExecuteOnSelectionForStandardVariant(t);return this};c.prototype.setManualVariantKey=function(t){this.setProperty("manualVariantKey",t);this._oVM._setShowManualVariantKey(t);return this};c.prototype.setInErrorState=function(t){this.setProperty("inErrorState",t);this._oVM.setInErrorState(t);return this};c.prototype.openManagementDialog=function(t,e,a){this._oVM.openManagementDialog(t,e,a)};c.prototype.openSaveAsDialogForKeyUser=function(t,e){this._oVM.openSaveAsDialog(t,e)};c.prototype.setEditable=function(t){this._oVM.setProperty("showFooter",t);return this};c.prototype.setCurrentVariantKey=function(t){this._oVM.setSelectedKey(t)};c.prototype.getCurrentVariantKey=function(){return this._oVM.getSelectedKey()};c.prototype.setDefaultVariantKey=function(t){this._oVM.setDefaultKey(t)};c.prototype.getDefaultVariantKey=function(){return this._oVM.getDefaultKey()};c.prototype.getModified=function(){return this._oVM.getModified()};c.prototype.setModified=function(t){this._oVM.setModified(t)};c.prototype.getStandardVariantKey=function(){return this._oVM.getStandardVariantKey()};c.prototype._getEmbeddedVM=function(){return this._oVM};c.prototype._updateWithSettingsInfo=function(){r.getInstance().then(function(t){if(this._oVM){this._oVM.setShowSaveAs(t.isVariantPersonalizationEnabled());this._oVM.setSupportPublic(t.isPublicFlVariantEnabled())}}.bind(this)).catch(function(t){h.error(t)})};c.prototype.getModelName=function(){return this.getProperty("modelName")};c.prototype.setModelName=function(t){if(this.getModelName()){this.oContext=null;this._aCancelEventHandlers=[];this._aSaveEventHandlers=[];this._aManageEventHandlers=[];this._aSelectEventHandlers=[]}this.setProperty("modelName",t);return this};c.prototype._setModel=function(){this._setBindingContext()};c.prototype._setBindingContext=function(){var e;var a;var n=this.getModelName();if(!this.oContext){e=this.getModel(n);if(e){a=this._getLocalId(e);if(a){this.oContext=new t(e,"/"+a);this.setBindingContext(this.oContext,n);if(e.registerToModel){e.registerToModel(this)}this.fireInitialized();this._oVM.setModel(e,n);this._oVM.setSupportDefault(true);this._createItemsModel(n);this._oVM.bindProperty("selectedKey",{path:this.oContext+"/currentVariant",model:n});this._oVM.bindProperty("defaultKey",{path:this.oContext+"/defaultVariant",model:n});this._oVM.bindProperty("modified",{path:this.oContext+"/modified",model:n});this._oVM.bindProperty("supportFavorites",{path:this.oContext+"/showFavorites",model:n});this._oVM.bindProperty("supportApplyAutomatically",{path:this.oContext+"/showExecuteOnSelection",model:n});this._oVM.bindProperty("showFooter",{path:this.oContext+"/variantsEditable",model:n});this._oVM.setPopoverTitle(this._oRb.getText("VARIANT_MANAGEMENT_VARIANTS"))}}}};c.prototype._createItemsModel=function(t){var i=new n({key:"{"+t+">key}",title:"{"+t+">title}",sharing:"{"+t+">sharing}",remove:"{"+t+">remove}",favorite:"{"+t+">favorite}",originalFavorite:"{"+t+">originalFavorite}",executeOnSelect:"{"+t+">executeOnSelect}",originalExecuteOnSelect:"{"+t+">originalExecuteOnSelect}",rename:"{"+t+">rename}",originalTitle:"{"+t+">originalTitle}",visible:"{"+t+">visible}",changeable:"{"+t+">change}",author:"{"+t+">author}",contexts:"{"+t+">contexts}",originalContexts:"{"+t+">originalContexts}"});this._oVM.bindAggregation("items",{path:this.oContext+"/variants",model:t,template:i,filters:new e({path:"visible",operator:a.EQ,value1:true})})};c.prototype._getLocalId=function(t){var e=this.getModelName();if(!e){return null}if(e!==o.getVariantModelName()){return this.getId()}return t.getVariantManagementReferenceForControl(this)};c.prototype._getInnerItems=function(){var t=[];if(this.oContext&&this.oContext.getObject()){t=this.oContext.getObject().variants.filter(function(t){if(!t.hasOwnProperty("visible")){return true}return t.visible})}return t};c.prototype._getInnerItemByKey=function(t){var e=null;var a=this._getInnerItems();a.some(function(a){if(a.key===t){e=a}return e!==null});return e};c.prototype.registerApplyAutomaticallyOnStandardVariant=function(t){this._fRegisteredApplyAutomaticallyOnStandardVariant=t;return this};c.prototype.getApplyAutomaticallyOnVariant=function(t){var e=false;if(t){e=t.executeOnSelect;if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()&&t.key===this._oVM.getStandardVariantKey()){try{e=this._fRegisteredApplyAutomaticallyOnStandardVariant(t)}catch(t){h.error("callback for determination of apply automatically on standard variant failed")}}}return e};c.prototype.exit=function(){this._oVM.detachManage(this._fireManage,this);this._oVM.detachCancel(this._fireCancel,this);this._oVM.detachSelect(this._fireSelect,this);this._oVM.detachSave(this._fireSave,this);s.prototype.exit.apply(this,arguments);this._oVM=undefined;this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this.oContext=undefined;this._oRb=undefined;this._aCancelEventHandlers=undefined;this._aSaveEventHandlers=undefined;this._aManageEventHandlers=undefined;this._aSelectEventHandlers=undefined};c.prototype.addFor=function(t){this.addAssociation("for",t);return this};return c});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/variants/VariantModel",["sap/base/util/restricted/_omit","sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/includes","sap/base/util/isEmptyObject","sap/base/util/merge","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/BusyIndicator","sap/ui/core/Core","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/URLHandler","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/controlVariants/Switcher","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/registry/Settings","sap/ui/model/json/JSONModel"],function(e,t,n,a,r,i,o,s,c,l,f,h,u,p,g,v,d,m,V,C,R,y,x){"use strict";var D={};function F(e,t){return M(function(e,t){var n=t.model;var a=t.vmReference;var r=false;var i=e.key;var s=e.key;return Promise.resolve().then(function(){if(o.get([a,"currentVariant"],n.oData)&&n.oData[a].currentVariant!==n.oData[a].originalCurrentVariant){s=n.oData[a].originalCurrentVariant;r=true;return n.updateCurrentVariant({variantManagementReference:a,newVariantReference:i,appComponent:n.oAppComponent,internallyCalled:true})}}).then(function(){if(o.get([a,"modified"],n.oData)===true){var e=d.getControlChangesForVariant({reference:n.sFlexReference,vmReference:a,vReference:s});return b({changes:e,vmReference:a,vReference:s,revert:!r,model:n}).then(function(){n.oData[a].originalCurrentVariant=i;n.oData[a].modified=false;n.checkUpdate(true)})}}).then(function(){if(!r){n.callVariantSwitchListeners(a,n.oData[a].currentVariant)}})}.bind(null,e.getParameters(),t),t.model,t.vmReference)}function S(e,t,n){if(n||e.oData[t]){e.oData[t].variantBusy=n}e.checkUpdate()}function b(e){var t=e.model._getDirtyChangesFromVariantChanges(e.changes);t=t.reverse();return Promise.resolve().then(function(){if(e.revert){return h.revertMultipleChanges(t,{appComponent:e.model.oAppComponent,modifier:c,flexController:e.model.oFlexController})}return undefined}).then(function(){t.forEach(function(t){d.removeChangeFromVariant({reference:e.model.sFlexReference,change:t,vmReference:e.vmReference,vReference:e.vReference});e.model.oFlexController.deleteChange(t,e.model.oAppComponent)})})}function M(e,t,n){t._oVariantSwitchPromise=t._oVariantSwitchPromise.catch(function(){}).then(S.bind(null,t,n,true)).then(e).then(S.bind(null,t,n,false)).catch(function(e){S(t,n,false);throw e});t.oFlexController.setVariantSwitchPromise(t._oVariantSwitchPromise);return t._oVariantSwitchPromise}function E(e,t){D[e]=t}function I(e,t){return v.switchVariant(e).then(function(){this.oData[e.vmReference].originalCurrentVariant=e.newVReference;this.oData[e.vmReference].currentVariant=e.newVReference;if(this.oData[e.vmReference].updateVariantInURL){u.updateVariantInURL({vmReference:e.vmReference,newVReference:e.newVReference,model:this})}this.checkUpdate();this.callVariantSwitchListeners(e.vmReference,e.newVReference,undefined,t)}.bind(this))}function T(e){y.getInstance().then(function(t){if(!t.isVariantPersonalizationEnabled()){e.remove=false;e.rename=false;e.change=false}})}function _(e,t,n){var a=n?C.getCurrentLayer():V.USER;if(e.layer===a&&e.key!==t){return true}return false}function P(e){return new Promise(function(t){if(e.getDomRef()){t()}else{e.addEventDelegate({onAfterRendering:function(){t()}})}})}var U=x.extend("sap.ui.fl.variants.VariantModel",{constructor:function(e,t){this.pSequentialImportCompleted=Promise.resolve();x.apply(this,[e]);this.sharing={PRIVATE:"private",PUBLIC:"public"};this.oFlexController=t.flexController;this.oChangePersistence=this.oFlexController._oChangePersistence;this.sFlexReference=this.oChangePersistence.getComponentName();this.oAppComponent=t.appComponent;this._oResourceBundle=f.getLibraryResourceBundle("sap.ui.fl");this._oVariantSwitchPromise=Promise.resolve();this._oVariantAppliedListeners={};if(r(e)){try{e=d.fillVariantModel({reference:this.sFlexReference})}catch(e){s.error("Variants Map was not found: "+e.message)}}if(e&&typeof e==="object"){Object.keys(e).forEach(function(t){e[t].variants.forEach(function(n){if(!e[t].currentVariant&&n.key===e[t].defaultVariant){e[t].currentVariant=n.key}n.originalTitle=n.title;n.originalFavorite=n.favorite;n.originalExecuteOnSelect=n.executeOnSelect;n.originalVisible=n.visible;n.originalContexts=n.contexts});e[t].originalCurrentVariant=e[t].currentVariant;e[t].originalDefaultVariant=e[t].defaultVariant});this.setData(e)}d.addUpdateStateListener(this.sFlexReference,A.bind(this))}});function A(){this.checkDirtyStateForControlModels(Object.keys(this.oData||{}))}U.prototype.initialize=function(){return Promise.resolve().then(function(){var e=R.getUshellContainer();if(e){var t=[R.getUShellService("UserInfo"),R.getUShellService("URLParsing"),R.getUShellService("CrossApplicationNavigation"),R.getUShellService("ShellNavigation")];return Promise.all(t).then(function(e){E("UserInfo",e[0]);E("URLParsing",e[1]);E("CrossApplicationNavigation",e[2]);E("ShellNavigation",e[3])}).catch(function(e){throw new Error("Error getting service from Unified Shell: "+e)})}return undefined}).then(function(){u.initialize({model:this})}.bind(this))};U.prototype.updateCurrentVariant=function(e){var t={vmReference:e.variantManagementReference,currentVReference:this.oData[e.variantManagementReference].originalCurrentVariant,newVReference:e.newVariantReference,flexController:this.oFlexController,appComponent:e.appComponent||this.oAppComponent,modifier:c,reference:this.sFlexReference};if(e.internallyCalled){return I.call(this,t,e.scenario)}return M(I.bind(this,t,e.scenario),this,e.variantManagementReference)};U.prototype.getCurrentVariantReference=function(e){return this.oData[e].currentVariant};U.prototype.getVariantManagementReference=function(e){var t="";var n=-1;Object.keys(this.oData).some(function(a){return this.oData[a].variants.some(function(r,i){if(r.key===e){t=a;n=i;return true}})}.bind(this));return{variantManagementReference:t,variantIndex:n}};U.prototype.getVariant=function(e,t){return d.getVariant({reference:this.sFlexReference,vmReference:t||this.getVariantManagementReference(e).variantManagementReference,vReference:e})};U.prototype.getVariantTitle=function(e,t){var n="";this.oData[t].variants.some(function(t){if(t.key===e){n=t.title;return true}});return n};function O(e,t){var n=d.getVariantChangesForVariant({vmReference:e,reference:this.sFlexReference});var a=this.oData[e].currentVariant;var r=this.oData[e].defaultVariant;if(t.getExecuteOnSelectionForStandardDefault()&&a===r&&a===e&&!n.setExecuteOnSelect){var i=d.getVariant({reference:this.sFlexReference,vmReference:e,vReference:e});i.instance.setExecuteOnSelection(true);this.oData[e].variants[0].originalExecuteOnSelect=true;this.oData[e].variants[0].executeOnSelect=true;return true}return false}U.prototype.attachVariantApplied=function(e){var t=f.byId(e.vmControlId);var n=this.getVariantManagementReferenceForControl(t);return this.waitForVMControlInit(n).then(function(e,n){if(!this._oVariantAppliedListeners[e]){this._oVariantAppliedListeners[e]={}}var a=O.call(this,e,t);if(n.callAfterInitialVariant||a){var r={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:e,flexController:this.oFlexController};d.waitForInitialVariantChanges(r).then(function(){var t=d.getCurrentVariantReference({vmReference:e,reference:this.sFlexReference});this.callVariantSwitchListeners(e,t,n.callback)}.bind(this))}return P(n.control).then(function(){if(m.getRelevantVariantManagementControlId(n.control,this.getVariantManagementControlIds())===n.vmControlId){this.oData[e].showExecuteOnSelection=true;this.checkUpdate(true);this._oVariantAppliedListeners[e][n.control.getId()]=n.callback}else{s.error("Error in attachVariantApplied: The passed VariantManagement ID does not match the responsible VariantManagement control")}}.bind(this))}.bind(this,n,e))};U.prototype.callVariantSwitchListeners=function(e,t,a,r){if(this._oVariantAppliedListeners[e]){var o;this.oData[e].variants.some(function(e){if(e.key===t){o=i({},e);return true}});if(r){o.createScenario=r}if(a){a(o)}else{n(this._oVariantAppliedListeners[e],function(e,t){t(o)})}}};U.prototype.detachVariantApplied=function(e,t){var n=this.getVariantManagementReferenceForControl(f.byId(e));if(this._oVariantAppliedListeners[n]){delete this._oVariantAppliedListeners[n][t]}};U.prototype.addChange=function(e){var t=e.getVariantReference();var n=this.getVariantManagementReference(t).variantManagementReference;if(e.getState()===g.LifecycleState.NEW){this.oData[n].modified=true}this.checkUpdate(true);return d.addChangeToVariant({reference:this.sFlexReference,change:e,vmReference:n,vReference:t})};U.prototype.removeChange=function(e){var t=e.getVariantReference();var n=this.getVariantManagementReference(t).variantManagementReference;var a=d.removeChangeFromVariant({reference:this.sFlexReference,change:e,vmReference:n,vReference:t});this.checkDirtyStateForControlModels([n]);return a};U.prototype.eraseDirtyChangesOnVariant=function(e,t){var n=d.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:t});var a=this._getDirtyChangesFromVariantChanges(n);return b({changes:n,vmReference:e,vReference:t,model:this,revert:true}).then(function(){return a})};U.prototype.addAndApplyChangesOnVariant=function(e){return e.reduce(function(e,t){return e.then(function(){this.oFlexController.addPreparedChange(t,this.oAppComponent);var e=f.byId(c.getControlIdBySelector(t.getSelector(),this.oAppComponent));return this.oFlexController.applyChange(t,e)}.bind(this))}.bind(this),Promise.resolve())};U.prototype._getVariantTitleCount=function(e,t){var n=this.getData();return n[t].variants.reduce(function(t,n){if(e.toLowerCase()===n.title.toLowerCase()&&n.visible){t++}return t},0)};function k(e,t){var n={id:t.newVariantReference,variantName:t.title,contexts:t.contexts,layer:t.layer,reference:e.getFlexObjectMetadata().reference,generator:t.generator,variantManagementReference:t.variantManagementReference};if(t.currentVariantComparison===1){if(t.sourceVariantSource.instance.getLayer()===t.layer){n.variantReference=t.sourceVariantSource.instance.getVariantReference()}else{n.variantReference=e.getVariantReference()}}else if(t.currentVariantComparison===0){n.variantReference=e.getVariantReference()}else if(t.currentVariantComparison===-1){n.variantReference=t.sourceVariantReference}return p.createFlVariant(n)}U.prototype._duplicateVariant=function(e){var t=e.sourceVariantReference;var n=e.variantManagementReference;var a=this.getVariant(t);var r=d.getControlChangesForVariant({vmReference:n,vReference:t,reference:this.sFlexReference}).map(function(e){return e.convertToFileContent()});e.currentVariantComparison=C.compareAgainstCurrentLayer(a.instance.getLayer(),e.layer);if(e.currentVariantComparison===1){e.sourceVariantSource=this.getVariant(a.instance.getVariantReference())}var o={instance:k(a.instance,e),controlChanges:r,variantChanges:{}};r=o.controlChanges.slice();var s={};o.controlChanges=r.reduce(function(t,n){if(C.compareAgainstCurrentLayer(n.layer,e.layer)>=0){s=i({},n);s.layer=e.layer;s.variantReference=o.instance.getId();if(!s.support){s.support={}}s.support.sourceChangeFileName=n.fileName;s.packageName="$TMP";s.fileName=R.createDefaultFileName(s.changeType);t.push(p.createFromFileContent(s))}return t},[]);return o};U.prototype.copyVariant=function(e){var t=this._duplicateVariant(e);t.generator=e.generator;var n={key:t.instance.getId(),layer:e.layer,title:t.instance.getName(),originalTitle:t.instance.getName(),originalExecuteOnSelect:t.instance.getExecuteOnSelection(),executeOnSelect:false,favorite:true,originalFavorite:true,rename:true,change:true,remove:true,visible:true,originalVisible:true,sharing:e.layer===V.USER?this.sharing.PRIVATE:this.sharing.PUBLIC,originalContexts:t.instance.getContexts(),contexts:t.instance.getContexts()};var a=[];[t.instance].concat(t.controlChanges).forEach(function(e){a.push(this.oChangePersistence.addDirtyChange(e))}.bind(this));var r=d.addVariantToVariantManagement({variantData:t,reference:this.sFlexReference,vmReference:e.variantManagementReference});this.oData[e.variantManagementReference].variants.splice(r,0,n);return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:t.instance.getId(),appComponent:e.appComponent,internallyCalled:true,scenario:"saveAs"}).then(function(){return a})};U.prototype.removeVariant=function(e){var t=this.oChangePersistence.getDirtyChanges().filter(function(t){return t.getVariantReference&&t.getVariantReference()===e.variant.getId()||t.getId()===e.variant.getId()});return this.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:e.sourceVariantReference,appComponent:e.component}).then(function(){var n=d.removeVariantFromVariantManagement({reference:this.sFlexReference,variant:e.variant,vmReference:e.variantManagementReference});this.oData[e.variantManagementReference].variants.splice(n,1);this.checkUpdate();t.forEach(function(e){this.oChangePersistence.deleteChange(e)}.bind(this))}.bind(this))};U.prototype.collectModelChanges=function(e,n){var a=this.getData()[e];var r=a.variants;var i=[];var o={};r.forEach(function(e){if(e.originalTitle!==e.title){o={variantReference:e.key,changeType:"setTitle",title:e.title,originalTitle:e.originalTitle,layer:n};i.push(o)}if(e.originalFavorite!==e.favorite){o={variantReference:e.key,changeType:"setFavorite",favorite:e.favorite,originalFavorite:e.originalFavorite,layer:n};i.push(o)}if(e.originalExecuteOnSelect!==e.executeOnSelect){o={variantReference:e.key,changeType:"setExecuteOnSelect",executeOnSelect:e.executeOnSelect,originalExecuteOnSelect:e.originalExecuteOnSelect,layer:n};i.push(o)}if(!e.visible&&e.originalVisible){o={variantReference:e.key,changeType:"setVisible",visible:false,layer:n};i.push(o)}if(!t(e.originalContexts,e.contexts)){o={variantReference:e.key,changeType:"setContexts",layer:n,contexts:e.contexts,originalContexts:e.originalContexts};i.push(o)}});if(a.originalDefaultVariant!==a.defaultVariant){o={variantManagementReference:e,changeType:"setDefault",defaultVariant:a.defaultVariant,originalDefaultVariant:a.originalDefaultVariant,layer:n};i.push(o)}return i};U.prototype.manageVariants=function(e,t,n,a,r){return new Promise(function(i){e.attachEventOnce("manage",{resolve:i,variantManagementReference:t,layer:n},this.fnManageClickRta,this);e.openManagementDialog(true,a,r)}.bind(this))};U.prototype.addVariantChange=function(e,t){var n=this.setVariantProperties(e,t);var a={};var r={vmReference:e,add:true,reference:this.sFlexReference};a.changeType=t.changeType;a.layer=t.layer;a.generator=t.generator;if(t.changeType==="setDefault"){a.fileType="ctrl_variant_management_change";a.selector=c.getSelector(e,t.appComponent)}else{a.fileType="ctrl_variant_change";a.selector=c.getSelector(t.variantReference,t.appComponent)}var i=this.oFlexController.createBaseChange(a,t.appComponent);i.setContent(n);if(t.changeType==="setTitle"){i.setText("title",t.title,"XFLD")}r.changeContent=i.convertToFileContent();d.updateChangesForVariantManagementInMap(r);this.oChangePersistence.addDirtyChange(i);return i};U.prototype.deleteVariantChange=function(e,t,n){var a={vmReference:e,add:false,reference:this.sFlexReference,changeContent:undefined};this.setVariantProperties(e,t,true);a.changeContent=n.convertToFileContent();d.updateChangesForVariantManagementInMap(a);this.oChangePersistence.deleteChange(n)};U.prototype.setVariantProperties=function(e,t,n){var a=-1;var r;var i=this.getData();var o=this.getVariant(t.variantReference,e).instance;if(t.variantReference){a=this.getVariantManagementReference(t.variantReference).variantIndex;r=i[e].variants[a]}var s={};switch(t.changeType){case"setTitle":s.title=t.title;r.title=t.title;r.originalTitle=r.title;o.setName(t.title,true);break;case"setFavorite":s.favorite=t.favorite;r.favorite=t.favorite;r.originalFavorite=r.favorite;o.setFavorite(t.favorite);break;case"setExecuteOnSelect":s.executeOnSelect=t.executeOnSelect;r.executeOnSelect=t.executeOnSelect;r.originalExecuteOnSelect=r.executeOnSelect;o.setExecuteOnSelection(t.executeOnSelect);break;case"setVisible":s.visible=t.visible;s.createdByReset=false;r.visible=t.visible;r.originalVisible=r.visible;o.setVisible(t.visible);break;case"setContexts":s.contexts=t.contexts;r.contexts=t.contexts;r.originalContexts=t.contexts;o.setContexts(t.contexts);break;case"setDefault":s.defaultVariant=t.defaultVariant;i[e].defaultVariant=t.defaultVariant;i[e].originalDefaultVariant=i[e].defaultVariant;var c=u.getStoredHashParams({model:this});if(c){if(i[e].defaultVariant!==i[e].currentVariant&&c.indexOf(i[e].currentVariant)===-1){u.update({parameters:c.concat(i[e].currentVariant),updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}else if(i[e].defaultVariant===i[e].currentVariant&&c.indexOf(i[e].currentVariant)>-1){c.splice(c.indexOf(i[e].currentVariant),1);u.update({parameters:c,updateURL:!this._bDesignTimeMode,updateHashEntry:true,model:this})}}if(n&&i[e].currentVariant!==t.defaultVariant){this.updateCurrentVariant({variantManagementReference:e,newVariantReference:t.defaultVariant,appComponent:t.appComponent})}break;default:break}var l=d.getContent(this.sFlexReference);if(a>-1){var f=d.setVariantData({variantData:s,vmReference:e,previousIndex:a,reference:this.sFlexReference});i[e].variants.splice(a,1);i[e].variants.splice(f,0,r)}else if(l[e]){l[e].defaultVariant=t.defaultVariant}this.setData(i);this.checkUpdate(true);return s};U.prototype._ensureStandardVariantExists=function(t){var n=this.getData();var a=n[t]||{};var o=e(a,["initPromise"]);if(!n[t]||r(o)){n[t]=i(a,{currentVariant:t,originalCurrentVariant:t,defaultVariant:t,originalDefaultVariant:t,variants:[{key:t,title:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),originalTitle:this._oResourceBundle.getText("STANDARD_VARIANT_ORIGINAL_TITLE"),favorite:true,originalFavorite:true,executeOnSelect:false,originalExecuteOnSelect:false,visible:true,originalVisible:true,contexts:{},originalContexts:{},author:m.DEFAULT_AUTHOR}]});this.setData(n);var c={};c[t]={defaultVariant:t,variantManagementChanges:{},variants:[{instance:p.createFlVariant({id:t,variantManagementReference:t,variantName:this._oResourceBundle.getText("STANDARD_VARIANT_TITLE"),user:m.DEFAULT_AUTHOR,reference:this.sFlexReference}),controlChanges:[],variantChanges:{}}]};try{d.addFakeStandardVariant(this.sFlexReference,this.oAppComponent.getId(),c)}catch(e){s.error("Variants Map was not found: "+e.message)}}};U.prototype.setModelPropertiesForControl=function(e,t,n){this.oData[e].modified=false;this.oData[e].showFavorites=true;var a=this._bDesignTimeMode;if(a!==t){this._bDesignTimeMode=t;if(t){u.clearAllVariantURLParameters({model:this})}else if(a){u.update({parameters:u.getStoredHashParams({model:this}),updateURL:true,updateHashEntry:false,model:this})}}if(!(typeof this.fnManageClick==="function"&&typeof this.fnManageClickRta==="function")){this._initializeManageVariantsEvents()}n.detachManage(this.fnManageClick,this);if(t&&this.oData[e]._isEditable){this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(n){n.rename=true;n.change=true;n.sharing=this.sharing.PUBLIC;n.remove=_(n,e,t)}.bind(this))}else if(this.oData[e]._isEditable){n.attachManage({variantManagementReference:e},this.fnManageClick,this);this.oData[e].variantsEditable=true;this.oData[e].variants.forEach(function(n){n.remove=_(n,e,t);switch(n.layer){case V.USER:n.rename=true;n.change=true;n.sharing=this.sharing.PRIVATE;T(n);break;case V.PUBLIC:var a=this._oUserInfoService&&this._oUserInfoService.getUser();var r=!a||a.getId().toUpperCase()===n.author.toUpperCase()||y.getInstanceOrUndef().isKeyUser();n.remove=r;n.rename=r;n.change=r;n.sharing=this.sharing.PUBLIC;break;default:n.rename=false;n.change=false;n.sharing=this.sharing.PUBLIC}}.bind(this))}else{this.oData[e].variantsEditable=false;this.oData[e].variants.forEach(function(e){e.remove=false;e.rename=false;e.change=false})}};U.prototype._initializeManageVariantsEvents=function(){this.fnManageClickRta=function(e,t){var n=this.collectModelChanges(t.variantManagementReference,t.layer);t.resolve(n)};this.fnManageClick=function(e,t){if(!this.oFlexController||!d.getContent(this.sFlexReference)){return}var n=this.collectModelChanges(t.variantManagementReference,V.USER);var a=[];n.forEach(function(e){e.appComponent=this.oAppComponent;a.push(this.addVariantChange(t.variantManagementReference,e))}.bind(this));this.oChangePersistence.saveDirtyChanges(this.oAppComponent,false,a)}};function L(e,t,n,a){if(!this._bDesignTimeMode){return e.saveSequenceOfDirtyChanges(t,a).then(function(e){if(e){var t=e.response[0];this.oData[n].variants.forEach(function(e){if(e.key===t.fileName){e.author=t.support.user}})}}.bind(this))}return Promise.resolve()}U.prototype._handleSaveEvent=function(e){if(!this._bDesignTimeMode){var t=e.getSource();var n=e.getParameters();return this._handleSave(t,n)}return Promise.resolve()};U.prototype._handleSave=function(e,t){var n=R.getAppComponentForControl(e);var a=this.getLocalId(e.getId(),n);var r;return M(function(e,t,n){var a=n.def;var i=n.execute;var o=this.getCurrentVariantReference(e);var s=d.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:o});if(n.overwrite){return this.oFlexController.saveSequenceOfDirtyChanges(this._getDirtyChangesFromVariantChanges(s),t)}var c=n.layer||(n.public?V.PUBLIC:V.USER);var l=n.layer||V.USER;var f=n.newVariantReference||R.createDefaultFileName("flVariant");var h={variantManagementReference:e,appComponent:t,layer:c,title:n.name,contexts:n.contexts,sourceVariantReference:o,newVariantReference:f,generator:n.generator};return this.copyVariant(h).then(function(n){if(a){var c={changeType:"setDefault",defaultVariant:f,originalDefaultVariant:this.oData[e].defaultVariant,appComponent:t,layer:l,variantManagementReference:e};var h=this.addVariantChange(e,c);n.push(h)}if(i){var u={changeType:"setExecuteOnSelect",executeOnSelect:true,variantReference:f,appComponent:t,layer:l,variantManagementReference:e};var p=this.addVariantChange(e,u);n.push(p)}r=n;return b({changes:s,vmReference:e,vReference:o,model:this}).then(L.bind(this,this.oFlexController,n,e,t))}.bind(this))}.bind(this,a,n,t),this,a).then(function(){this.oData[a].modified=false;this.checkUpdate(true);return r}.bind(this))};U.prototype.getLocalId=function(e,t){return c.getSelector(e,t).id};U.prototype.getVariantManagementReferenceForControl=function(e){var t=e.getId();var n=R.getAppComponentForControl(e);return n&&n.getLocalId(t)||t};U.prototype.switchToDefaultForVariantManagement=function(e){if(this.oData[e].currentVariant!==this.oData[e].defaultVariant){l.show(200);this.updateCurrentVariant({variantManagementReference:e,newVariantReference:this.oData[e].defaultVariant}).then(function(){l.hide()})}};U.prototype.switchToDefaultForVariant=function(e){Object.keys(this.oData).forEach(function(t){if(!e||this.oData[t].currentVariant===e){this.switchToDefaultForVariantManagement(t)}}.bind(this))};U.prototype.registerToModel=function(e){var t=this.getVariantManagementReferenceForControl(e);this._ensureStandardVariantExists(t);this.oData[t]._isEditable=e.getEditable();this.oData[t].showExecuteOnSelection=false;e.attachEvent("select",{vmReference:t,model:this},F);e.attachSave(this._handleSaveEvent,this);this.setModelPropertiesForControl(t,false,e);var n=e.getUpdateVariantInURL();this.oData[t].updateVariantInURL=n;u.registerControl({vmReference:t,updateURL:!!n,model:this});u.handleModelContextChange({model:this,vmControl:e});if(this.oData[t].initPromise){this.oData[t].initPromise.resolveFunction();delete this.oData[t].initPromise}this.oData[t].init=true;var a={appComponent:this.oAppComponent,reference:this.sFlexReference,vmReference:t,flexController:this.oFlexController};this._oVariantSwitchPromise=this._oVariantSwitchPromise.then(d.waitForInitialVariantChanges.bind(undefined,a))};U.prototype.waitForVMControlInit=function(e){if(!this.oData[e]){this.oData[e]={}}else if(this.oData[e].init){return Promise.resolve()}this.oData[e].initPromise={};this.oData[e].initPromise.promise=new Promise(function(t){this.oData[e].initPromise.resolveFunction=t}.bind(this));return this.oData[e].initPromise.promise};U.prototype._getDirtyChangesFromVariantChanges=function(e){var t=e.map(function(e){return e.getId()});return this.oChangePersistence.getDirtyChanges().filter(function(e){return a(t,e.getId())&&!e.assignedToVariant})};U.prototype.checkDirtyStateForControlModels=function(e){e.forEach(function(e){var t=this.oData[e];var n=this.getCurrentVariantReference(e);var a=d.getControlChangesForVariant({reference:this.sFlexReference,vmReference:e,vReference:n});var r=this._getDirtyChangesFromVariantChanges(a);t.modified=r.length>0}.bind(this));this.checkUpdate(true)};U.prototype.getCurrentControlVariantIds=function(){return Object.keys(this.oData||{}).reduce(function(e,t){return e.concat([this.oData[t].currentVariant])}.bind(this),[])};U.prototype.getVariantManagementControlIds=function(){var e;return Object.keys(this.oData||{}).reduce(function(t,n){if(this.oAppComponent.byId(n)){e=this.oAppComponent.createId(n)}else{e=n}t.push(e);return t}.bind(this),[])};U.prototype.destroy=function(){d.clearFakedStandardVariants(this.sFlexReference,this.oAppComponent.getId());d.removeUpdateStateListener(this.sFlexReference);x.prototype.destroy.apply(this)};U.prototype.getUShellService=function(e){return R.getUshellContainer()&&D[e]};return U});
/*
 * ! OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/FlexInfoSession",["sap/ui/fl/apply/_internal/flexState/ManifestUtils"],function(e){"use strict";var n={};var t="sap.ui.fl.info.";function r(e){return t+(e||"true")}n.get=function(t){var r=e.getFlexReferenceForControl(t);return n.getByReference(r)};n.getByReference=function(e){return JSON.parse(window.sessionStorage.getItem(r(e)))};n.set=function(t,r){var o=e.getFlexReferenceForControl(r);n.setByReference(t,o)};n.setByReference=function(e,n){window.sessionStorage.setItem(r(n),JSON.stringify(e))};n.remove=function(n){var t=e.getFlexReferenceForControl(n);window.sessionStorage.removeItem(r(t))};return n});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Storage",["sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/write/_internal/StorageFeaturesMerger","sap/ui/fl/apply/_internal/flexObjects/States","sap/base/util/ObjectPath"],function(e,t,n,r){"use strict";var i="sap/ui/fl/write/_internal/connectors/";function a(){return e.getConnectors(i,false)}function o(e,t){var n=t.filter(function(t){return t.layers.indexOf("ALL")!==-1||t.layers.indexOf(e)!==-1});if(n.length===1){return n[0]}if(n.length===0){throw new Error("No Connector configuration could be found to write into layer: "+e)}if(n.length>1){throw new Error("sap.ui.core.Configuration 'flexibilityServices' has a misconfiguration: Multiple Connector configurations were found to write into layer: "+e)}}function u(t){var n=t.map(function(t){return t.writeConnectorModule.loadFeatures({url:t.url}).then(function(e){return{features:e,layers:t.layers}}).catch(e.logAndResolveDefault.bind(null,{features:{},layers:t.layers},t,"loadFeatures"))});return Promise.all(n)}function s(e){if(!e){return Promise.reject("No layer was provided")}return a().then(o.bind(this,e))}function l(e){if(e.draft){return new Promise(function(t,n){sap.ui.require(["sap/ui/fl/write/api/FeaturesAPI"],function(r){r.isVersioningEnabled(e.layer).then(function(r){if(r){t()}else{n("Draft is not supported for the given layer: "+e.layer)}})})})}return Promise.resolve()}function c(e,t){var r=t.filter(function(t){return t.getState()===n.LifecycleState.NEW&&t.getFileType()===e.getFileType()});var i=r.findIndex(function(t){return t.getId()===e.getId()});return i}function d(e){var t;if(e.allChanges&&e.allChanges.length&&e.condensedChanges){t={namespace:e.allChanges[0].convertToFileContent().namespace,layer:e.layer};var r=0;var i=false;e.allChanges.forEach(function(a,o){var u=a.getFileType();if(u==="ctrl_variant"){return}var s=c(a,e.condensedChanges);if(a.condenserState){var l=false;if(a.condenserState==="delete"){if(a.getState()===n.LifecycleState.PERSISTED){if(!t.delete){t.delete={}}if(!t.delete[u]){t.delete[u]=[]}t.delete[u].push(a.getId())}r++}else if(e.condensedChanges.length){l=e.allChanges[o].getId()!==e.condensedChanges[o-r].getId()}if((a.condenserState==="select"&&a.getState()!==n.LifecycleState.NEW||a.condenserState==="update")&&l&&!i){var d=e.condensedChanges.slice(o-r).map(function(e){return e.getId()});if(!t.reorder){t.reorder={}}if(!t.reorder[u]){t.reorder[u]=[]}t.reorder[u]=d;i=true}if(a.condenserState==="select"&&a.getState()===n.LifecycleState.NEW){if(!t.create){t.create={}}if(!t.create[u]){t.create[u]=[]}t.create[u][s]={};t.create[u][s][a.getId()]=a.convertToFileContent()}else if(a.condenserState==="update"){if(!t.update){t.update={}}if(!t.update[u]){t.update[u]=[]}var f=t.update[u].length;t.update[u][f]={};t.update[u][f][a.getId()]={content:a.getContent()}}delete a.condenserState}else if(a.getState()===n.LifecycleState.NEW){if(!t.create){t.create={}}if(!t.create[u]){t.create[u]=[]}t.create[u][s]={};t.create[u][s][a.getId()]=a.convertToFileContent()}})}return t}function f(e,t){return l(t).then(s.bind(undefined,t.layer)).then(function(n){t.url=n.url;var i=r.get(e,n.writeConnectorModule);return i.call(n.writeConnectorModule,t)})}var g={};g.write=function(e){return f("write",e)};g.condense=function(e){var t=d(e);if(!t){return Promise.reject("No changes were provided")}if(t.create||t.reorder||t.update||t.delete){e.flexObjects=t;return f("condense",e)}return Promise.resolve()};g.remove=function(e){return f("remove",e)};g.update=function(e){return f("update",e)};g.reset=function(e){return f("reset",e)};g.getFlexInfo=function(e){return f("getFlexInfo",e)};g.getContexts=function(e){return f("getContexts",e)};g.loadContextDescriptions=function(e){return f("loadContextDescriptions",e)};g.isContextSharingEnabled=function(e){return f("isContextSharingEnabled",e)};g.loadFeatures=function(){return a().then(u).then(t.mergeResults)};g.publish=function(e){return f("publish",e)};g.contextBasedAdaptation={create:function(e){return a().then(f.bind(undefined,"contextBasedAdaptation.create",e))}};g.versions={load:function(e){return a().then(f.bind(undefined,"versions.load",e))},activate:function(e){return a().then(f.bind(undefined,"versions.activate",e))},discardDraft:function(e){return a().then(f.bind(undefined,"versions.discardDraft",e))},publish:function(e){return a().then(f.bind(undefined,"versions.publish",e))}};g.translation={getSourceLanguages:function(e){return a().then(f.bind(undefined,"translation.getSourceLanguages",e))},getTexts:function(e){return a().then(f.bind(undefined,"translation.getTexts",e))},postTranslationTexts:function(e){return a().then(f.bind(undefined,"translation.postTranslationTexts",e))}};return g});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/StorageFeaturesMerger",["sap/base/util/merge"],function(e){"use strict";var n={isKeyUser:false,isKeyUserTranslationEnabled:false,isVariantSharingEnabled:false,isPublicFlVariantEnabled:false,isVariantPersonalizationEnabled:true,isContextSharingEnabled:true,isContextSharingEnabledForComp:true,isAtoAvailable:false,isAtoEnabled:false,versioning:{},isProductiveSystem:true,isPublicLayerAvailable:false,isLocalResetEnabled:false,isZeroDowntimeUpgradeRunning:false,system:"",client:""};function i(e){var n={};var i=!!e.features.isVersioningEnabled;e.layers.forEach(function(e){n[e]=i});return n}return{mergeResults:function(a){var r=n;a.forEach(function(n){Object.keys(n.features).forEach(function(e){if(e!=="isVersioningEnabled"){r[e]=n.features[e]}});r.versioning=e(r.versioning,i(n));if(n.isContextSharingEnabled!==undefined&&n.isContextSharingEnabledForComp===undefined){r.isContextSharingEnabled=n.isContextSharingEnabled;r.isContextSharingEnabledForComp=n.isContextSharingEnabled}});return r}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Versions",["sap/ui/fl/registry/Settings","sap/ui/fl/ChangePersistenceFactory","sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/ui/fl/write/api/Version","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode"],function(e,r,t,n,i,s,a){"use strict";var o={};var f=9;var l=f+1;function d(e,r){var t=v(r);var o=[];var l=i.Number.Original;var d=false;return n.getUShellService("URLParsing").then(function(u){var c=n.getParameter(i.UrlParameter,u);if(!c){if(r.length>0){c=r[0].version}else{c=i.Number.Original}}r.forEach(function(e){if(e.version===i.Number.Draft){e.type=i.Type.Draft;e.isPublished=false;o=e.filenames}else{if(l===i.Number.Original){e.type=i.Type.Active;l=e.version}else{e.type=i.Type.Inactive}if(e.version===c&&e.isPublished===false){d=true}}});var p=new s({publishVersionEnabled:d,versioningEnabled:e,versions:r,activeVersion:l,backendDraft:t,dirtyChanges:false,draftAvailable:t,activateEnabled:t,persistedVersion:c,displayedVersion:c,draftFilenames:o});p.setDefaultBindingMode(a.OneWay);p.setSizeLimit(f);p.setDirtyChanges=function(e){p.setProperty("/dirtyChanges",e);p.updateDraftVersion();p.updateBindings(true)};p.updateDraftVersion=function(){var e=p.getProperty("/versions");var r=p.getProperty("/versioningEnabled");var t=p.getProperty("/dirtyChanges");var n=p.getProperty("/backendDraft");var s=r&&(t||n);p.setProperty("/draftAvailable",s);if(t){p.setProperty("/displayedVersion",i.Number.Draft)}if(!v(e)&&s){e.splice(0,0,{version:i.Number.Draft,type:i.Type.Draft,filenames:[],isPublished:false})}if(v(e)&&!s){e.shift();p.setProperty("/displayedVersion",p.getProperty("/persistedVersion"))}var a=p.getProperty("/displayedVersion")!==p.getProperty("/activeVersion");p.setProperty("/activateEnabled",a)};return p})}function u(e,r){var t=[];var n=r.changePersistences;n.forEach(function(e){t=e.getDirtyChanges().concat();t.forEach(function(r){e.deleteChange(r,true)})});return t.length>0}function c(e){var t={dirtyChangesExist:false,changePersistences:[]};if(e.reference){var n=r.getChangePersistenceForComponent(e.reference);if(n.getDirtyChanges().length>0){t.dirtyChangesExist=true;t.changePersistences.push(n)}}if(e.nonNormalizedReference){var i=r.getChangePersistenceForComponent(e.nonNormalizedReference);if(i.getDirtyChanges().length>0){t.dirtyChangesExist=true;t.changePersistences.push(i)}}return t}function v(e){return e.some(function(e){return e.version===i.Number.Draft})}var p={};p.initialize=function(r){var n=r.reference;var i=r.layer;r.limit=l;return e.getInstance().then(function(e){var s=e.isVersioningEnabled(i);var a=s?t.versions.load(r):Promise.resolve([]);return a.then(function(e){return d(s,e)}).then(function(e){o[n]=o[n]||{};o[n][i]=o[n][i]||{};o[n][i]=e;return o[n][i]})})};p.getVersionsModel=function(e){var r=e.reference;var t=e.layer;if(!p.hasVersionsModel(e)){throw Error("Versions Model for reference '"+r+"' and layer '"+t+"' were not initialized.")}var n=c(e);if(n.dirtyChangesExist){o[r][t].updateDraftVersion(e)}return o[r][t]};p.hasVersionsModel=function(e){var r=e.reference;var t=e.layer;return o[r]&&o[r][t]};p.clearInstances=function(){o={}};p.onAllChangesSaved=function(e){e.reference=n.normalizeReference(e.reference);var r=p.getVersionsModel(e);var t=r.getProperty("/versioningEnabled");var i=r.getProperty("/dirtyChanges");r.setProperty("/dirtyChanges",true);r.setProperty("/backendDraft",t&&i);r.updateDraftVersion()};p.activate=function(e){var r=p.getVersionsModel(e);var n=r.getProperty("/versions");var s=v(n);var a=r.getProperty("/activeVersion");if(e.displayedVersion===a){return Promise.reject("Version is already active")}e.version=e.displayedVersion;var o=c(e);var f=o.changePersistences;var l=f.some(function(e){return e.getDirtyChanges().length>0});if(l){return Promise.reject("unsaved changes exists")}return t.versions.activate(e).then(function(e){n.forEach(function(e){e.type=i.Type.Inactive});e.type=i.Type.Active;e.isPublished=false;if(s){n.shift()}n.splice(0,0,e);r.setProperty("/publishVersionEnabled",true);r.setProperty("/backendDraft",false);r.setProperty("/dirtyChanges",false);r.setProperty("/draftAvailable",false);r.setProperty("/publishVersionEnabled",true);r.setProperty("/activateEnabled",false);r.setProperty("/activeVersion",e.version);r.setProperty("/displayedVersion",e.version);r.setProperty("/persistedVersion",e.version);r.updateBindings(true)})};p.discardDraft=function(e){var r=p.getVersionsModel(e);var n=r.getProperty("/versions");var i=c(e);var s=r.getProperty("/backendDraft");var a=s?t.versions.discardDraft(e):Promise.resolve();return a.then(function(){n.shift();r.setProperty("/backendDraft",false);r.setProperty("/dirtyChanges",false);r.setProperty("/draftAvailable",false);r.setProperty("/activateEnabled",false);r.setProperty("/displayedVersion",r.getProperty("/persistedVersion"));r.updateBindings(true);var t=u(e,i);return{backendChangesDiscarded:s,dirtyChangesDiscarded:t}})};p.publish=function(e){var r=p.getVersionsModel({reference:n.normalizeReference(e.reference),layer:e.layer});return t.versions.publish(e).then(function(t){if(t!=="Error"&&t!=="Cancel"){r.setProperty("/publishVersionEnabled",false);var n=r.getProperty("/versions");var i=false;n.forEach(function(r){if(r.isPublished){return}if(r.version===e.version){i=true}if(i&&!r.isPublished){r.isPublished=true}})}return t})};return p});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Condenser",["sap/base/util/each","sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/write/_internal/condenser/classifications/LastOneWins","sap/ui/fl/write/_internal/condenser/classifications/Reverse","sap/ui/fl/write/_internal/condenser/classifications/Update","sap/ui/fl/write/_internal/condenser/UIReconstruction","sap/ui/fl/write/_internal/condenser/Utils","sap/ui/fl/Utils","sap/ui/performance/Measurement","sap/base/util/restricted/_isEqual"],function(e,n,t,r,a,i,o,s,c,f,u,d,l,p,g,h,C,v){"use strict";var E={};var y="unclassified";var S={lastOneWins:u,reverse:d,update:l};var _=["affectedControl","sourceContainer","targetContainer","updateControl"];function I(e,n){var t=e[o.Move];return n.classification===o.Create&&t&&t[t.length-1].targetContainer===n.targetContainer}function m(e,n){return n.classification===o.Move&&e[o.Destroy]}function O(e,n){return n.classification===o.Create&&e[o.Destroy]}function b(e,n,t,r){if(!m(e,t)&&!O(e,t)){var a=t.classification;if(!e[a]){t.change=r;r.condenserState="select";e[a]=[t]}else{r.condenserState="delete"}e[a][0].updateChange=r}if(I(e,t)||O(e,t)){if(e[o.Move]){e[o.Move].forEach(function(e){e.change.condenserState="delete"});delete e[o.Move]}if(e[o.Destroy]){e[o.Destroy].forEach(function(e){e.change.condenserState="delete"});delete e[o.Destroy]}}return p.addChange(n,t)}function x(e,n,t){if(!e[n.classification]){e[n.classification]={}}var r=e[n.classification];S[n.classification].addToChangesMap(r,n,t);return Promise.resolve()}function N(e,n,t,r,a){if(!e[r.type]){e[r.type]={}}var i=e[r.type];if(r.type===g.NOT_INDEX_RELEVANT){return x(i,r,a)}t.push(a);return b(i,n,r,a)}function T(e,n,t){if(!e[n]){e[n]=[]}e[n].push(t);t.condenserState="select"}function A(e,n){var t=a.getControlIdBySelector(n.getSelector(),e);var r=i.byId(t);if(r){var o={modifier:a,appComponent:e,view:h.getViewForControl(r)};var c=s.getControlIfTemplateAffected(n,r,o);return Promise.resolve(s.getChangeHandler(n,c,o)).then(function(e){if(e&&typeof e.getCondenserInfo==="function"){return e.getCondenserInfo(n,o)}return undefined}).then(function(e){if(e&&c.bTemplateAffected){M(e,n)}return e}).catch(function(){return undefined})}return Promise.resolve()}function M(e,n){var t=n.getOriginalSelector();var r=n.getSelector();_.forEach(function(n){if(e[n]&&e[n]===r){e[n]=t}})}function D(e,n,t,r){var i=n!==undefined?n.affectedControl:a.getControlIdBySelector(t.getSelector(),r);if(!e[i]){e[i]={}}if(n&&n.updateControl){var o=n.updateControl;e[i]=Object.assign(e[i],e[o]);delete e[o]}return e[i]}function R(e,n,t,r,a){return a.reduce(function(a,i){return a.then(w.bind(this,e,n,t,r,i))}.bind(this),Promise.resolve())}function w(e,n,t,r,a){return A(e,a).then(function(i){U(i,e);var o=D(n,i,a,e);if(i!==undefined){L(i);return N(o,t,r,i,a).then(function(){if(i.update){P(o,i,a)}})}T(o,y,a);n[y]=true;return undefined})}function L(e){if(S[e.classification]){e.type=g.NOT_INDEX_RELEVANT}else{e.type=g.INDEX_RELEVANT}}function U(e,n){_.forEach(function(t){if(e&&e[t]){e[t]=a.getControlIdBySelector(e[t],n)}})}function P(e,n,r){var a=t.get([g.NOT_INDEX_RELEVANT,o.Update,n.uniqueKey],e);if(a){a.change.condenserState="delete";if(r.condenserState==="delete"){return}n.update(r,a.updateContent);if(r.getState()===f.LifecycleState.PERSISTED){r.condenserState="update"}}}function j(t,r){e(t,function(e,a){if(S[e]&&S[e].getChangesFromMap){S[e].getChangesFromMap(t,e).forEach(function(e){r.push(e)})}else if(n(a)){return j(a,r)}else if(Array.isArray(a)){a.forEach(function(e){if(e instanceof c){r.push(e)}else{r.push(e.change)}})}});return r}function V(e){return j(e,[])}function X(t,r){e(t,function(e,t){if(n(t)){X(t,r)}else if(Array.isArray(t)){t.forEach(function(e){if(!(e instanceof c)){r.push(e)}})}});return r}function B(e,n){n.sort(function(n,t){return e.indexOf(n)-e.indexOf(t)})}function F(e,n){n.sort(function(n,t){return e.indexOf(n.change)-e.indexOf(t.change)})}function W(e,n){var t=e.map(function(e){return e.getId()});n.forEach(function(n){if(t.indexOf(n.getId())===-1){e.push(n)}})}function q(e,n){e.forEach(function(e){var t=e.updateChange;if(t&&!v(t.getContent(),e.change.getContent())&&t.getState()!==f.LifecycleState.NEW){var r=e.change;if(t.getId()!==r.getId()){var a=r.getContent();t.setContent(a);r.condenserState="delete";n=n.map(function(e){if(e.getId()===r.getId()){return t}return e})}else{t.setState(f.LifecycleState.DIRTY)}t.condenserState="update"}});return n}E.condense=function(e,n){C.start("Condenser_overall","Condenser overall - CondenserClass",["sap.ui.fl","Condenser"]);var t={};var a={};var i=[];var o=[];var s=[];n.slice(0).reverse().forEach(function(e){if(e instanceof c&&e.isSuccessfullyApplied()){s.push(e)}else{o.push(e)}});C.start("Condenser_defineMaps","defining of maps - CondenserClass",["sap.ui.fl","Condenser"]);return R(e,t,a,i,s).then(function(){C.end("Condenser_defineMaps");var e=t[y];if(!e){p.compareAndUpdate(t,a)}var s=V(t);if(e){i.forEach(function(e){e.condenserState="select"});W(s,i)}s=s.concat(o);B(n,s);if(!e){C.start("Condenser_handleIndexRelatedChanges","handle index related changes - CondenserClass",["sap.ui.fl","Condenser"]);var c=true;var f=X(t,[]);F(n,f);var u;try{C.start("Condenser_sort","sort index related changes - CondenserClass",["sap.ui.fl","Condenser"]);u=p.sortIndexRelatedChanges(a,f)}catch(e){r.error("Error during Condensing: "+e.message,"No Condensing performed for index-relevant changes.");c=false}C.end("Condenser_sort");if(c){s=q(f,s);B(n,s);u.forEach(function(e){p.swapChanges(e,s)})}else{i.forEach(function(e){e.condenserState="select"});W(s,i);B(n,s)}C.end("Condenser_handleIndexRelatedChanges")}C.end("Condenser_overall");return s})};return E});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/UIReconstruction",["sap/base/util/restricted/_isEqual","sap/base/util/each","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/write/_internal/condenser/classifications/Create","sap/ui/fl/write/_internal/condenser/classifications/Destroy","sap/ui/fl/write/_internal/condenser/classifications/Move","sap/ui/fl/write/_internal/condenser/Utils"],function(n,e,t,i,r,a,c){"use strict";var o={};var f={create:i,destroy:r,move:a};function u(n,t){e(n,function(n,i){e(i,function(e,r){t(i,n,r,e)})})}function s(n,e,t){n.splice(t,0,n.splice(e,1)[0])}function l(n,e){var t={};u(n,function(n,i,r,a){var o=r[c.TARGET_UI];o.forEach(function(n){e.forEach(function(e){if(n===e.affectedControl){if(!t[i]){t[i]={}}var r=t[i];if(!r[a]){r[a]=[]}var c=r[a];c.push(e)}})})});return t}function h(n){return!n.some(function(n){return n.classification!==t.Create})}function v(n){return!n.some(function(n){return c.isUnknown(n)})}function d(n){return n.getTargetIndex(n.change)}function E(n){n.sort(function(n,e){var t=d(n);var i=d(e);return t-i})}function g(n){return!n.some(function(n){return!c.isUnknown(n)})}function I(e,t){var i;if(e.length<t.length){i=t.slice(e.length);if(!g(i)){return false}t=t.slice(0,e.length)}else if(e.length>t.length){i=e.slice(t.length,e.length);if(!g(i)){return false}e=e.slice(0,t.length)}return n(e,t)}function p(n,e,t,i,r){var a={};r.forEach(function(n){var i=n.targetContainer;if(!a[i]){a[i]={}}var r=a[i];if(!r[e]){r[e]=c.initializeArrayWithPlaceholders(0,t.length-1)}f[n.classification].simulate(r[e],n,t)});var o=a[n][e];if(I(i,o)){return true}return false}function T(n,i){function r(n,e){var t=e.change.getState();e.setTargetIndex(e.change,n);e.change.setState(t)}function a(i,a,o){o[c.TARGET_UI].forEach(function(i,a){if(!c.isUnknown(i)){var o=n[i];var f=o[c.INDEX_RELEVANT];e(f,function(n,e){if(n!==t.Destroy){e.forEach(r.bind(this,a))}})}})}u(i,a)}function _(n,t){u(t,function(t,i,r,a){var o=r[c.INITIAL_UI];var f=r[c.TARGET_UI];if(I(o,f)){f.forEach(function(t){var i=n[t];if(i!==undefined){e(i[c.INDEX_RELEVANT],function(n,e){e.forEach(function(n){n.change.condenserState="delete"})});delete i[c.INDEX_RELEVANT]}});delete t[a]}})}function A(n,e){u(e,function(e,t,i){var r=i[c.INITIAL_UI];var a=i[c.TARGET_UI];r.forEach(function(e,t){var i=n[e];if(!i||!i[c.INDEX_RELEVANT]){var r=c.PLACEHOLDER+t;var o=a.indexOf(e);if(o>=0){a[o]=r}}})})}o.swapChanges=function(n,e){var t=n.map(function(n){return e.indexOf(n)}).sort();n.forEach(function(n){e[t.shift()]=n})};o.sortIndexRelatedChanges=function(n,e){var t=[];var i=l(n,e);u(i,function(e,i,r,a){var o=n[i][a][c.TARGET_UI];var f=n[i][a][c.INITIAL_UI];var u=true;if(v(o)||h(r)){E(r)}else if(!p(i,a,f,o,r)){u=false;var l=r.length;while(l!==0&&!u){var d=0;var g=1;while(g<r.length&&!u){s(r,d,g);u=p(i,a,f,o,r);d++;g++}l--}}if(!u){throw Error("no correct sorting found for the container: "+i)}t.push(r.map(function(n){return n.change}))});return t};o.addChange=function(n,e){return f[e.classification].addToReconstructionMap(n,e)};o.compareAndUpdate=function(n,e){_(n,e);A(n,e);T(n,e)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Utils",["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core"],function(e,n){"use strict";var i={};i.TARGET_UI="targetUI";i.INITIAL_UI="initialUI";i.PLACEHOLDER="X";i.INDEX_RELEVANT="indexRelevant";i.NOT_INDEX_RELEVANT="notIndexRelevant";function t(e,n){return(Math.max(e,n)||0)+1}i.getInitialUIContainerElementIds=function(e,n,t,r){if(!e[n]){e[n]={}}var a=e[n];if(!a[t]){a[t]={}}var l=a[t];if(!l[i.TARGET_UI]){l[i.TARGET_UI]=r}if(!l[i.INITIAL_UI]){l[i.INITIAL_UI]=r.slice(0)}return l[i.INITIAL_UI]};i.getContainerElementIds=function(i,t){var r=n.byId(i);return Promise.resolve().then(e.getAggregation.bind(e,r,t)).then(function(e){return e.map(function(e){return e.getId()})})};i.initializeArrayWithPlaceholders=function(e,n){var r=t(n,e);return Array(r).fill(i.PLACEHOLDER).map(function(e,n){return e+n})};i.extendArrayWithPlaceholders=function(e,n,r){var a=t(n,r);if(e.length<a){var l;for(var f=e.length;f<=a;f++){l=i.PLACEHOLDER+e.length;e.splice(e.length,0,l)}}};i.extendElementsArray=function(e,n,t,r){i.extendArrayWithPlaceholders(e,n,t);var a=e.indexOf(r);var l=e.indexOf(i.PLACEHOLDER+n);if(a!==n&&n!==undefined){if(a>=0){i.shiftElement(e,a,n)}else if(l>-1){e[l]=r}else if(i.isUnknown(e[n])){e[n]=r}}};i.shiftElement=function(e,n,i){e.splice(i,0,e.splice(n,1)[0])};i.isUnknown=function(e){if(e!==undefined&&e.indexOf(i.PLACEHOLDER)===0){var n=e.slice(1,e.length);var t=parseInt(n);if(isNaN(t)){return false}return true}return false};return i});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Create",["sap/ui/core/Core","sap/ui/fl/write/_internal/condenser/Utils"],function(e,t){"use strict";return{addToReconstructionMap:function(n,r){var a=e.byId(r.affectedControl);var i=r.targetAggregation||a&&a.sParentAggregationName;return t.getContainerElementIds(r.targetContainer,i).then(function(e){var a=t.getInitialUIContainerElementIds(n,r.targetContainer,r.targetAggregation,e);var i=a.indexOf(r.affectedControl);if(i>-1){a.splice(i,1)}})},simulate:function(e,t){e.splice(t.getTargetIndex(t.change),0,t.affectedControl)}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Destroy",["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{addToReconstructionMap:function(n,t){return e.getContainerElementIds(t.targetContainer,t.targetAggregation).then(function(i){var r=e.getInitialUIContainerElementIds(n,t.targetContainer,t.targetAggregation,i);if(r.length-1<t.sourceIndex){while(r.length-1<t.sourceIndex){var a=r.length;r.splice(r.length,0,e.PLACEHOLDER+a)}r[t.sourceIndex]=t.affectedControl}else{r.splice(t.sourceIndex,0,t.affectedControl)}})},simulate:function(n,t,i){var r=n.indexOf(t.affectedControl);if(r===-1){var a=e.PLACEHOLDER+i.indexOf(t.affectedControl);r=n.indexOf(a)}if(r>-1){n.splice(r,1)}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/LastOneWins",[],function(){"use strict";return{addToChangesMap:function(e,n,i){if(!e[n.uniqueKey]){e[n.uniqueKey]=[i];i.condenserState="select"}else{i.condenserState="delete"}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Move",["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{addToReconstructionMap:function(t,n){return Promise.all([e.getContainerElementIds(n.sourceContainer,n.sourceAggregation),e.getContainerElementIds(n.targetContainer,n.targetAggregation)]).then(function(r){var i=r[0];var a=r[1];var o;var g;if(n.targetContainer===n.sourceContainer&&n.targetAggregation===n.sourceAggregation){o=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,a);g=o.indexOf(n.affectedControl);e.shiftElement(o,g,n.sourceIndex)}else{o=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,a);g=o.indexOf(n.affectedControl);o.splice(g,1);o=e.getInitialUIContainerElementIds(t,n.sourceContainer,n.sourceAggregation,i);o.splice(n.sourceIndex,0,n.affectedControl)}})},simulate:function(t,n,r){var i=n.affectedControl;var a=r.indexOf(i);e.extendElementsArray(t,a,undefined,i);var o=t.indexOf(i);var g=n.getTargetIndex(n.change);if(a===-1){t.splice(g,0,i)}else{t.splice(g,0,t.splice(o,1)[0])}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Reverse",["sap/base/util/each"],function(e){"use strict";return{addToChangesMap:function(e,n,t){if(!e[n.uniqueKey]){e[n.uniqueKey]=[]}e[n.uniqueKey].push(t)},getChangesFromMap:function(n,t){var a=[];e(n[t],function(e,n){n.reverse();var t;n.forEach(function(e,a){if(t&&t.getChangeType()!==e.getChangeType()){t=null;n[a].condenserState="delete";n[a-1].condenserState="delete"}else{t=e;if(a>0){n[a-1].condenserState="delete"}n[a].condenserState="select"}});if(t){a.push(t)}});return a}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Update",[],function(){"use strict";return{addToChangesMap:function(e,n,t){if(!e[n.uniqueKey]){n.change=t;e[n.uniqueKey]=n;t.condenserState="select"}else{t.condenserState="delete"}}}});
/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/Version",[],function(){"use strict";return{Number:{Original:"-1",Draft:"0"},UrlParameter:"sap-ui-fl-version",Type:{Active:"active",Draft:"draft",Inactive:"inactive"}}});
sap.ui.require.preload({
	"sap/ui/fl/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.fl","type":"library","embeds":["support/apps/contentbrowser","variants/context"],"applicationVersion":{"version":"1.109.0"},"title":"SAPUI5 library with sap.ui.fl controls.","description":"SAPUI5 library with sap.ui.fl controls.","ach":"CA-UI5-FL","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_hcb"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.109","libs":{"sap.ui.core":{"minVersion":"1.109.0"},"sap.m":{"minVersion":"1.109.0"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.fl.variants.VariantManagement","sap.ui.fl.util.IFrame"],"elements":[],"types":[],"interfaces":[]}}}}'
},"sap/ui/fl/library-preload");
sap.ui.loader.config({bundlesUI5:{
"sap/ui/fl/library-preload-apply.js":['sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetMinUI5Version.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/SetFlexExtensionPointEnabled.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModelEnhanceWith.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddNewModel.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddLibrary.js','sap/ui/fl/apply/_internal/changes/descriptor/ui5/AddComponentUsages.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/DeleteCard.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/ChangeCard.js','sap/ui/fl/apply/_internal/changes/descriptor/ovp/AddNewCard.js','sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetRegistrationIds.js','sap/ui/fl/apply/_internal/changes/descriptor/fiori/SetAbstract.js','sap/ui/fl/apply/_internal/changes/descriptor/app/SetTitle.js','sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeInbound.js','sap/ui/fl/apply/_internal/changes/descriptor/app/ChangeDataSource.js','sap/ui/fl/apply/_internal/changes/descriptor/app/AddAnnotationsToOData.js','sap/ui/fl/apply/_internal/flexState/UI2Personalization/UI2PersonalizationState.js','sap/ui/fl/apply/_internal/flexState/compVariants/Utils.js','sap/ui/fl/apply/_internal/flexState/changes/ExtensionPointState.js','sap/ui/fl/apply/_internal/changes/descriptor/RegistrationBuild.js','sap/ui/fl/apply/_internal/changes/descriptor/Registration.js','sap/ui/fl/apply/_internal/changes/descriptor/ApplyUtil.js','sap/ui/fl/apply/_internal/flexObjects/RevertData.js','sap/ui/fl/apply/_internal/flexObjects/CompVariantRevertData.js','sap/ui/fl/apply/_internal/extensionPoint/Processor.js','sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils.js','sap/ui/fl/apply/_internal/connectors/ObjectStorageConnector.js','sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes.js','sap/ui/fl/apply/api/UI2PersonalizationApplyAPI.js','sap/ui/fl/apply/api/SmartVariantManagementApplyAPI.js','sap/ui/fl/util/IFrame.flexibility.js','sap/ui/fl/transport/TransportSelection.js','sap/ui/fl/transport/TransportDialog.js','sap/ui/fl/util/changePropertyValueByPath.js','sap/ui/fl/util/DescriptorChangeCheck.js','sap/ui/fl/write/_internal/connectors/LrepConnector.js','sap/ui/fl/write/api/ChangesWriteAPI.js','sap/ui/fl/write/_internal/transport/TransportSelection.js','sap/ui/fl/write/_internal/transport/TransportDialog.js','sap/ui/fl/write/connectors/BaseConnector.js','sap/ui/fl/write/_internal/connectors/Utils.js','sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory.js','sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory.js','sap/ui/fl/write/_internal/transport/Transports.js','sap/ui/fl/descriptorRelated/internal/Utils.js','sap/ui/fl/write/_internal/appVariant/AppVariantInlineChange.js'],
"sap/ui/fl/library-preload-write.js":['sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/validators/IsRequired.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/getEditorConfig.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.js','sap/ui/fl/write/_internal/flexState/compVariants/CompVariantState.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/CAPAccess.js','sap/ui/fl/write/_internal/flexState/FlexObjectState.js','sap/ui/fl/write/_internal/fieldExtensibility/Utils.js','sap/ui/fl/write/_internal/fieldExtensibility/UriParser.js','sap/ui/fl/write/_internal/fieldExtensibility/SingleTenantABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation.js','sap/ui/fl/write/_internal/fieldExtensibility/MultiTenantABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariantFactory.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant.js','sap/ui/fl/write/_internal/fieldExtensibility/ABAPAccess.js','sap/ui/fl/write/_internal/extensionPoint/Registry.js','sap/ui/fl/write/_internal/extensionPoint/Processor.js','sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate.js','sap/ui/fl/write/_internal/connectors/PersonalizationConnector.js','sap/ui/fl/write/_internal/connectors/ObjectStorageConnector.js','sap/ui/fl/write/_internal/connectors/ObjectPathConnector.js','sap/ui/fl/write/_internal/connectors/NeoLrepConnector.js','sap/ui/fl/write/_internal/connectors/LocalStorageConnector.js','sap/ui/fl/write/_internal/connectors/KeyUserConnector.js','sap/ui/fl/write/_internal/connectors/JsObjectConnector.js','sap/ui/fl/write/_internal/connectors/BackendConnector.js','sap/ui/fl/write/_internal/appVariant/AppVariantFactory.js','sap/ui/fl/write/_internal/appVariant/AppVariant.js','sap/ui/fl/write/api/connectors/ObjectStorageConnector.js','sap/ui/fl/write/api/connectors/FileListBaseConnector.js','sap/ui/fl/write/_internal/connectors/SessionStorageConnector.js','sap/ui/fl/write/_internal/SaveAs.js','sap/ui/fl/write/api/VersionsAPI.js','sap/ui/fl/write/api/UI2PersonalizationWriteAPI.js','sap/ui/fl/write/api/TranslationAPI.js','sap/ui/fl/write/api/SmartVariantManagementWriteAPI.js','sap/ui/fl/write/api/SmartBusinessWriteAPI.js','sap/ui/fl/write/api/ReloadInfoAPI.js','sap/ui/fl/write/api/PersistenceWriteAPI.js','sap/ui/fl/write/api/LocalResetAPI.js','sap/ui/fl/write/api/FieldExtensibility.js','sap/ui/fl/write/api/FeaturesAPI.js','sap/ui/fl/write/api/ExtensionPointRegistryAPI.js','sap/ui/fl/write/api/ControlPersonalizationWriteAPI.js','sap/ui/fl/write/api/ContextSharingAPI.js','sap/ui/fl/write/api/ContextBasedAdaptationsAPI.js','sap/ui/fl/write/api/AppVariantWriteAPI.js','sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory.js','sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory.js','sap/ui/fl/util/resolveBinding.js','sap/ui/fl/FakeLrepLocalStorage.js','sap/ui/fl/FakeLrepConnectorSessionStorage.js','sap/ui/fl/FakeLrepConnectorLocalStorage.js','sap/ui/fl/FakeLrepConnector.js','sap/ui/fl/variants/context/Component.js','sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.fragment.xml','sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.fragment.xml','sap/ui/fl/variants/context/view/ContextVisibility.view.xml','sap/ui/fl/variants/context/controller/ContextVisibility.controller.js']
}});
